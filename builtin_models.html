<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Built-in Fitting Models in the models module &#8212; Non-Linear Least-Squares Minimization and Curve-Fitting for Python</title>
    
    <link rel="stylesheet" href="_static/lmfitdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.9.6rc1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Calculation of confidence intervals" href="confidence.html" />
    <link rel="prev" title="Modeling Data and Curve Fitting" href="model.html" />
  <script type="text/x-mathjax-config">
     MathJax.Hub.Config({
        "TeX": {Macros: {AA : "{\\unicode{x212B}}"}},
        "HTML-CSS": {scale: 90}
  });</script>

  </head>
  <body role="document">
<div>
<table border=0>
  <tr><td></td><td width=85% padding=5 align=left>
       <a href="index.html" style="color: #157"> <font size=+3>LMFIT</font></a>
     </td>
     <td width=7% align=left>
         <a href="contents.html" style="color: #882222">
         <font size+=1>Contents</font></a> </td>
     <td width=7% align=left>
          <a href="installation.html" style="color: #882222">
          <font size+=1>Download</font></a></td>
     <td></td>
  </tr>
  <tr><td></td><td width=75% padding=5 align=left>
        <a href="index.html" style="color: #157"> <font size=+2>
	Non-Linear Least-Squares Minimization and Curve-Fitting for Python</font></a>
     </td>
     <td width=7% align=left>
         <a href="faq.html" style="color: #882222">
         <font size+=1>FAQ</font></a> </td>
     <td width=7% align=left>
        <a href="https://github.com/lmfit/lmfit-py/" style="color: #882222">
         <font size+=1>Develop</font></a></td>
     <td></td>
  </tr>
</table>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="confidence.html" title="Calculation of confidence intervals"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="model.html" title="Modeling Data and Curve Fitting"
             accesskey="P">previous</a> |</li>
   <li>[<a href="intro.html">intro</a>|</li>
   <li><a href="parameters.html">parameters</a>|</li>
   <li><a href="fitting.html"> minimize</a>|</li>
   <li><a href="model.html"> model</a>|</li>
   <li><a href="#"> builtin models</a>|</li>
   <li><a href="confidence.html">confidence intervals</a>|</li>
   <li><a href="bounds.html">bounds</a>|</li>
   <li><a href="constraints.html">constraints</a>]</li>
 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Built-in Fitting Models in the <code class="docutils literal"><span class="pre">models</span></code> module</a><ul>
<li><a class="reference internal" href="#peak-like-models">Peak-like models</a><ul>
<li><a class="reference internal" href="#gaussianmodel"><code class="docutils literal"><span class="pre">GaussianModel</span></code></a></li>
<li><a class="reference internal" href="#lorentzianmodel"><code class="docutils literal"><span class="pre">LorentzianModel</span></code></a></li>
<li><a class="reference internal" href="#voigtmodel"><code class="docutils literal"><span class="pre">VoigtModel</span></code></a></li>
<li><a class="reference internal" href="#pseudovoigtmodel"><code class="docutils literal"><span class="pre">PseudoVoigtModel</span></code></a></li>
<li><a class="reference internal" href="#moffatmodel"><code class="docutils literal"><span class="pre">MoffatModel</span></code></a></li>
<li><a class="reference internal" href="#pearson7model"><code class="docutils literal"><span class="pre">Pearson7Model</span></code></a></li>
<li><a class="reference internal" href="#studentstmodel"><code class="docutils literal"><span class="pre">StudentsTModel</span></code></a></li>
<li><a class="reference internal" href="#breitwignermodel"><code class="docutils literal"><span class="pre">BreitWignerModel</span></code></a></li>
<li><a class="reference internal" href="#lognormalmodel"><code class="docutils literal"><span class="pre">LognormalModel</span></code></a></li>
<li><a class="reference internal" href="#dampedocsillatormodel"><code class="docutils literal"><span class="pre">DampedOcsillatorModel</span></code></a></li>
<li><a class="reference internal" href="#dampedharmonicocsillatormodel"><code class="docutils literal"><span class="pre">DampedHarmonicOcsillatorModel</span></code></a></li>
<li><a class="reference internal" href="#exponentialgaussianmodel"><code class="docutils literal"><span class="pre">ExponentialGaussianModel</span></code></a></li>
<li><a class="reference internal" href="#skewedgaussianmodel"><code class="docutils literal"><span class="pre">SkewedGaussianModel</span></code></a></li>
<li><a class="reference internal" href="#donaichmodel"><code class="docutils literal"><span class="pre">DonaichModel</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#linear-and-polynomial-models">Linear and Polynomial Models</a><ul>
<li><a class="reference internal" href="#constantmodel"><code class="docutils literal"><span class="pre">ConstantModel</span></code></a></li>
<li><a class="reference internal" href="#linearmodel"><code class="docutils literal"><span class="pre">LinearModel</span></code></a></li>
<li><a class="reference internal" href="#quadraticmodel"><code class="docutils literal"><span class="pre">QuadraticModel</span></code></a></li>
<li><a class="reference internal" href="#polynomialmodel"><code class="docutils literal"><span class="pre">PolynomialModel</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#step-like-models">Step-like models</a><ul>
<li><a class="reference internal" href="#stepmodel"><code class="docutils literal"><span class="pre">StepModel</span></code></a></li>
<li><a class="reference internal" href="#rectanglemodel"><code class="docutils literal"><span class="pre">RectangleModel</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#exponential-and-power-law-models">Exponential and Power law models</a><ul>
<li><a class="reference internal" href="#exponentialmodel"><code class="docutils literal"><span class="pre">ExponentialModel</span></code></a></li>
<li><a class="reference internal" href="#powerlawmodel"><code class="docutils literal"><span class="pre">PowerLawModel</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#user-defined-models">User-defined Models</a><ul>
<li><a class="reference internal" href="#expressionmodel"><code class="docutils literal"><span class="pre">ExpressionModel</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#example-1-fit-peaked-data-to-gaussian-lorentzian-and-voigt-profiles">Example 1: Fit Peaked data to Gaussian, Lorentzian, and  Voigt profiles</a></li>
<li><a class="reference internal" href="#example-2-fit-data-to-a-composite-model-with-pre-defined-models">Example 2: Fit data to a Composite Model with pre-defined models</a></li>
<li><a class="reference internal" href="#example-3-fitting-multiple-peaks-and-using-prefixes">Example 3: Fitting Multiple Peaks &#8211; and using Prefixes</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="model.html"
                        title="previous chapter">Modeling Data and Curve Fitting</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="confidence.html"
                        title="next chapter">Calculation of confidence intervals</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/builtin_models.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-lmfit.models">
<span id="built-in-fitting-models-in-the-models-module"></span><span id="builtin-models-chapter"></span><h1>Built-in Fitting Models in the <code class="xref py py-mod docutils literal"><span class="pre">models</span></code> module<a class="headerlink" href="#module-lmfit.models" title="Permalink to this headline">¶</a></h1>
<p>Lmfit provides several builtin fitting models in the <code class="xref py py-mod docutils literal"><span class="pre">models</span></code> module.
These pre-defined models each subclass from the <code class="xref py py-class docutils literal"><span class="pre">model.Model</span></code> class of the
previous chapter and wrap relatively well-known functional forms, such as
Gaussians, Lorentzian, and Exponentials that are used in a wide range of
scientific domains.  In fact, all the models are all based on simple, plain
python functions defined in the <code class="xref py py-mod docutils literal"><span class="pre">lineshapes</span></code> module.  In addition to
wrapping a function into a <code class="xref py py-class docutils literal"><span class="pre">model.Model</span></code>, these models also provide a
<code class="xref py py-meth docutils literal"><span class="pre">guess()</span></code> method that is intended to give a reasonable
set of starting values from a data array that closely approximates the
data to be fit.</p>
<p>As shown in the previous chapter, a key feature of the <code class="xref py py-class docutils literal"><span class="pre">mode.Model</span></code> class
is that models can easily be combined to give a composite
<code class="xref py py-class docutils literal"><span class="pre">model.Model</span></code>. Thus while some of the models listed here may seem pretty
trivial (notably, <a class="reference internal" href="#lmfit.models.ConstantModel" title="lmfit.models.ConstantModel"><code class="xref py py-class docutils literal"><span class="pre">ConstantModel</span></code></a> and <a class="reference internal" href="#lmfit.models.LinearModel" title="lmfit.models.LinearModel"><code class="xref py py-class docutils literal"><span class="pre">LinearModel</span></code></a>), the
main point of having these is to be able to used in composite models.  For
example,  a Lorentzian plus a linear background might be represented as:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">lmfit.models</span> <span class="k">import</span> <span class="n">LinearModel</span><span class="p">,</span> <span class="n">LorentzianModel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peak</span> <span class="o">=</span> <span class="n">LorentzianModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">background</span>  <span class="o">=</span> <span class="n">LinearModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">peak</span> <span class="o">+</span> <span class="n">background</span>
</pre></div>
</div>
<p>All the models listed below are one dimensional, with an independent
variable named <code class="docutils literal"><span class="pre">x</span></code>.  Many of these models represent a function with a
distinct peak, and so share common features.  To maintain uniformity,
common parameter names are used whenever possible.  Thus, most models have
a parameter called <code class="docutils literal"><span class="pre">amplitude</span></code> that represents the overall height (or
area of) a peak or function, a <code class="docutils literal"><span class="pre">center</span></code> parameter that represents a peak
centroid position, and a <code class="docutils literal"><span class="pre">sigma</span></code> parameter that gives a characteristic
width.  Many peak shapes also have a parameter <code class="docutils literal"><span class="pre">fwhm</span></code> (constrained by
<code class="docutils literal"><span class="pre">sigma</span></code>) giving the full width at half maximum and a parameter <code class="docutils literal"><span class="pre">height</span></code>
(constrained by <code class="docutils literal"><span class="pre">sigma</span></code> and <code class="docutils literal"><span class="pre">amplitude</span></code>) to give the maximum peak
height.</p>
<p>After a list of builtin models, a few examples of their use is given.</p>
<div class="section" id="peak-like-models">
<h2>Peak-like models<a class="headerlink" href="#peak-like-models" title="Permalink to this headline">¶</a></h2>
<p>There are many peak-like models available.  These include
<a class="reference internal" href="#lmfit.models.GaussianModel" title="lmfit.models.GaussianModel"><code class="xref py py-class docutils literal"><span class="pre">GaussianModel</span></code></a>, <a class="reference internal" href="#lmfit.models.LorentzianModel" title="lmfit.models.LorentzianModel"><code class="xref py py-class docutils literal"><span class="pre">LorentzianModel</span></code></a>, <a class="reference internal" href="#lmfit.models.VoigtModel" title="lmfit.models.VoigtModel"><code class="xref py py-class docutils literal"><span class="pre">VoigtModel</span></code></a> and
some less commonly used variations.  The <code class="xref py py-meth docutils literal"><span class="pre">guess()</span></code>
methods for all of these make a fairly crude guess for the value of
<code class="docutils literal"><span class="pre">amplitude</span></code>, but also set a lower bound of 0 on the value of <code class="docutils literal"><span class="pre">sigma</span></code>.</p>
<div class="section" id="gaussianmodel">
<h3><a class="reference internal" href="#lmfit.models.GaussianModel" title="lmfit.models.GaussianModel"><code class="xref py py-class docutils literal"><span class="pre">GaussianModel</span></code></a><a class="headerlink" href="#gaussianmodel" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="lmfit.models.GaussianModel">
<em class="property">class </em><code class="descname">GaussianModel</code><span class="sig-paren">(</span><em>independent_vars=['x'], prefix='', missing=None, name=None, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.models.GaussianModel" title="Permalink to this definition">¶</a></dt>
<dd><p>A model based on a Gaussian or normal distribution lineshape
(see <a class="reference external" href="http://en.wikipedia.org/wiki/Normal_distribution">http://en.wikipedia.org/wiki/Normal_distribution</a>), with three Parameters:
<code class="docutils literal"><span class="pre">amplitude</span></code>, <code class="docutils literal"><span class="pre">center</span></code>, and <code class="docutils literal"><span class="pre">sigma</span></code>.
In addition, parameters <code class="docutils literal"><span class="pre">fwhm</span></code> and <code class="docutils literal"><span class="pre">height</span></code> are included as constraints
to report full width at half maximum and maximum peak height, respectively.</p>
<div class="math">
\[f(x; A, \mu, \sigma) = \frac{A}{\sigma\sqrt{2\pi}} e^{[{-{(x-\mu)^2}/{{2\sigma}^2}}]}\]</div>
<p>where the parameter <code class="docutils literal"><span class="pre">amplitude</span></code> corresponds to <span class="math">\(A\)</span>, <code class="docutils literal"><span class="pre">center</span></code> to
<span class="math">\(\mu\)</span>, and <code class="docutils literal"><span class="pre">sigma</span></code> to <span class="math">\(\sigma\)</span>.  The full width at
half maximum is <span class="math">\(2\sigma\sqrt{2\ln{2}}\)</span>, approximately
<span class="math">\(2.3548\sigma\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>independent_vars</strong> (<em></em><em>[</em><em>'x'</em><em>]</em><em></em>) &#8211; arguments to func that are independent variables</li>
<li><strong>prefix</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; string to prepend to paramter names, needed to add two Models that
have parameter names in common.</li>
<li><strong>missing</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; <p>how to handle <cite>nan</cite> and missing values in data. One of:</p>
<ul>
<li>&#8216;none&#8217; or <code class="docutils literal"><span class="pre">None</span></code>: Do not check for null or missing values (default)</li>
<li>&#8216;drop&#8217;: Drop null or missing observations in data. if pandas is
installed, <cite>pandas.isnull</cite> is used, otherwise <cite>numpy.isnan</cite> is used.</li>
<li>&#8216;raise&#8217;: Raise a (more helpful) exception when data contains nullz
or missing values.</li>
</ul>
</li>
<li><strong>kwargs</strong> (<em>optional</em>) &#8211; keyword arguments to pass to <code class="xref py py-class docutils literal"><span class="pre">Model</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="lorentzianmodel">
<h3><a class="reference internal" href="#lmfit.models.LorentzianModel" title="lmfit.models.LorentzianModel"><code class="xref py py-class docutils literal"><span class="pre">LorentzianModel</span></code></a><a class="headerlink" href="#lorentzianmodel" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="lmfit.models.LorentzianModel">
<em class="property">class </em><code class="descname">LorentzianModel</code><span class="sig-paren">(</span><em>independent_vars=['x'], prefix='', missing=None, name=None, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.models.LorentzianModel" title="Permalink to this definition">¶</a></dt>
<dd><p>A model based on a Lorentzian or Cauchy-Lorentz distribution function
(see <a class="reference external" href="http://en.wikipedia.org/wiki/Cauchy_distribution">http://en.wikipedia.org/wiki/Cauchy_distribution</a>), with three Parameters:
<code class="docutils literal"><span class="pre">amplitude</span></code>, <code class="docutils literal"><span class="pre">center</span></code>, and <code class="docutils literal"><span class="pre">sigma</span></code>.
In addition, parameters <code class="docutils literal"><span class="pre">fwhm</span></code> and <code class="docutils literal"><span class="pre">height</span></code> are included as constraints
to report full width at half maximum and maximum peak height, respectively.</p>
<div class="math">
\[f(x; A, \mu, \sigma) = \frac{A}{\pi} \big[\frac{\sigma}{(x - \mu)^2 + \sigma^2}\big]\]</div>
<p>where the parameter <code class="docutils literal"><span class="pre">amplitude</span></code> corresponds to <span class="math">\(A\)</span>, <code class="docutils literal"><span class="pre">center</span></code> to
<span class="math">\(\mu\)</span>, and <code class="docutils literal"><span class="pre">sigma</span></code> to <span class="math">\(\sigma\)</span>.  The full width at
half maximum is <span class="math">\(2\sigma\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>independent_vars</strong> (<em></em><em>[</em><em>'x'</em><em>]</em><em></em>) &#8211; arguments to func that are independent variables</li>
<li><strong>prefix</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; string to prepend to paramter names, needed to add two Models that
have parameter names in common.</li>
<li><strong>missing</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; <p>how to handle <cite>nan</cite> and missing values in data. One of:</p>
<ul>
<li>&#8216;none&#8217; or <code class="docutils literal"><span class="pre">None</span></code>: Do not check for null or missing values (default)</li>
<li>&#8216;drop&#8217;: Drop null or missing observations in data. if pandas is
installed, <cite>pandas.isnull</cite> is used, otherwise <cite>numpy.isnan</cite> is used.</li>
<li>&#8216;raise&#8217;: Raise a (more helpful) exception when data contains nullz
or missing values.</li>
</ul>
</li>
<li><strong>kwargs</strong> (<em>optional</em>) &#8211; keyword arguments to pass to <code class="xref py py-class docutils literal"><span class="pre">Model</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="voigtmodel">
<h3><a class="reference internal" href="#lmfit.models.VoigtModel" title="lmfit.models.VoigtModel"><code class="xref py py-class docutils literal"><span class="pre">VoigtModel</span></code></a><a class="headerlink" href="#voigtmodel" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="lmfit.models.VoigtModel">
<em class="property">class </em><code class="descname">VoigtModel</code><span class="sig-paren">(</span><em>independent_vars=['x'], prefix='', missing=None, name=None, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.models.VoigtModel" title="Permalink to this definition">¶</a></dt>
<dd><p>A model based on a Voigt distribution function (see
<a class="reference external" href="http://en.wikipedia.org/wiki/Voigt_profile">http://en.wikipedia.org/wiki/Voigt_profile</a>&gt;), with four Parameters:
<code class="docutils literal"><span class="pre">amplitude</span></code>, <code class="docutils literal"><span class="pre">center</span></code>, <code class="docutils literal"><span class="pre">sigma</span></code>, and <code class="docutils literal"><span class="pre">gamma</span></code>.  By default,
<code class="docutils literal"><span class="pre">gamma</span></code> is constrained to have value equal to <code class="docutils literal"><span class="pre">sigma</span></code>, though it
can be varied independently.  In addition, parameters <code class="docutils literal"><span class="pre">fwhm</span></code> and
<code class="docutils literal"><span class="pre">height</span></code> are included as constraints to report full width at half
maximum and maximum peak height, respectively.  The definition for the
Voigt function used here is</p>
<div class="math">
\[f(x; A, \mu, \sigma, \gamma) = \frac{A \textrm{Re}[w(z)]}{\sigma\sqrt{2 \pi}}\]</div>
<p>where</p>
<div class="math">
\begin{eqnarray*}
    z &amp;=&amp; \frac{x-\mu +i\gamma}{\sigma\sqrt{2}} \\
    w(z) &amp;=&amp; e^{-z^2}{\operatorname{erfc}}(-iz)
\end{eqnarray*}</div><p>and <code class="xref py py-func docutils literal"><span class="pre">erfc()</span></code> is the complimentary error function.  As above,
<code class="docutils literal"><span class="pre">amplitude</span></code> corresponds to <span class="math">\(A\)</span>, <code class="docutils literal"><span class="pre">center</span></code> to
<span class="math">\(\mu\)</span>, and <code class="docutils literal"><span class="pre">sigma</span></code> to <span class="math">\(\sigma\)</span>. The parameter <code class="docutils literal"><span class="pre">gamma</span></code>
corresponds  to <span class="math">\(\gamma\)</span>.
If <code class="docutils literal"><span class="pre">gamma</span></code> is kept at the default value (constrained to <code class="docutils literal"><span class="pre">sigma</span></code>),
the full width at half maximum is approximately <span class="math">\(3.6013\sigma\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>independent_vars</strong> (<em></em><em>[</em><em>'x'</em><em>]</em><em></em>) &#8211; arguments to func that are independent variables</li>
<li><strong>prefix</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; string to prepend to paramter names, needed to add two Models that
have parameter names in common.</li>
<li><strong>missing</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; <p>how to handle <cite>nan</cite> and missing values in data. One of:</p>
<ul>
<li>&#8216;none&#8217; or <code class="docutils literal"><span class="pre">None</span></code>: Do not check for null or missing values (default)</li>
<li>&#8216;drop&#8217;: Drop null or missing observations in data. if pandas is
installed, <cite>pandas.isnull</cite> is used, otherwise <cite>numpy.isnan</cite> is used.</li>
<li>&#8216;raise&#8217;: Raise a (more helpful) exception when data contains nullz
or missing values.</li>
</ul>
</li>
<li><strong>kwargs</strong> (<em>optional</em>) &#8211; keyword arguments to pass to <code class="xref py py-class docutils literal"><span class="pre">Model</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="pseudovoigtmodel">
<h3><a class="reference internal" href="#lmfit.models.PseudoVoigtModel" title="lmfit.models.PseudoVoigtModel"><code class="xref py py-class docutils literal"><span class="pre">PseudoVoigtModel</span></code></a><a class="headerlink" href="#pseudovoigtmodel" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="lmfit.models.PseudoVoigtModel">
<em class="property">class </em><code class="descname">PseudoVoigtModel</code><span class="sig-paren">(</span><em>independent_vars=['x'], prefix='', missing=None, name=None, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.models.PseudoVoigtModel" title="Permalink to this definition">¶</a></dt>
<dd><p>A model based on a pseudo-Voigt distribution function
(see <a class="reference external" href="http://en.wikipedia.org/wiki/Voigt_profile#Pseudo-Voigt_Approximation">http://en.wikipedia.org/wiki/Voigt_profile#Pseudo-Voigt_Approximation</a>),
which is a weighted sum of a Gaussian and Lorentzian distribution functions
with that share values for <code class="docutils literal"><span class="pre">amplitude</span></code> (<span class="math">\(A\)</span>), <code class="docutils literal"><span class="pre">center</span></code> (<span class="math">\(\mu\)</span>)
and full width at half maximum (and so have  constrained values of
<code class="docutils literal"><span class="pre">sigma</span></code> (<span class="math">\(\sigma\)</span>).  A parameter <code class="docutils literal"><span class="pre">fraction</span></code> (<span class="math">\(\alpha\)</span>)
controls the relative weight of the Gaussian and Lorentzian components,
giving the full definition of</p>
<div class="math">
\[f(x; A, \mu, \sigma, \alpha) = \frac{(1-\alpha)A}{\sigma_g\sqrt{2\pi}}
e^{[{-{(x-\mu)^2}/{{2\sigma_g}^2}}]}
+ \frac{\alpha A}{\pi} \big[\frac{\sigma}{(x - \mu)^2 + \sigma^2}\big]\]</div>
<p>where <span class="math">\(\sigma_g = {\sigma}/{\sqrt{2\ln{2}}}\)</span> so that the full width
at half maximum of each component and of the sum is <span class="math">\(2\sigma\)</span>. The
<code class="xref py py-meth docutils literal"><span class="pre">guess()</span></code> function always sets the starting value for <code class="docutils literal"><span class="pre">fraction</span></code> at 0.5.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>independent_vars</strong> (<em></em><em>[</em><em>'x'</em><em>]</em><em></em>) &#8211; arguments to func that are independent variables</li>
<li><strong>prefix</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; string to prepend to paramter names, needed to add two Models that
have parameter names in common.</li>
<li><strong>missing</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; <p>how to handle <cite>nan</cite> and missing values in data. One of:</p>
<ul>
<li>&#8216;none&#8217; or <code class="docutils literal"><span class="pre">None</span></code>: Do not check for null or missing values (default)</li>
<li>&#8216;drop&#8217;: Drop null or missing observations in data. if pandas is
installed, <cite>pandas.isnull</cite> is used, otherwise <cite>numpy.isnan</cite> is used.</li>
<li>&#8216;raise&#8217;: Raise a (more helpful) exception when data contains nullz
or missing values.</li>
</ul>
</li>
<li><strong>kwargs</strong> (<em>optional</em>) &#8211; keyword arguments to pass to <code class="xref py py-class docutils literal"><span class="pre">Model</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="moffatmodel">
<h3><a class="reference internal" href="#lmfit.models.MoffatModel" title="lmfit.models.MoffatModel"><code class="xref py py-class docutils literal"><span class="pre">MoffatModel</span></code></a><a class="headerlink" href="#moffatmodel" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="lmfit.models.MoffatModel">
<em class="property">class </em><code class="descname">MoffatModel</code><span class="sig-paren">(</span><em>independent_vars=['x'], prefix='', missing=None, name=None, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.models.MoffatModel" title="Permalink to this definition">¶</a></dt>
<dd><p>A model based on the Moffat distribution function
(see <a class="reference external" href="https://en.wikipedia.org/wiki/Moffat_distribution">https://en.wikipedia.org/wiki/Moffat_distribution</a>), with four Parameters:
<code class="docutils literal"><span class="pre">amplitude</span></code> (<span class="math">\(A\)</span>), <code class="docutils literal"><span class="pre">center</span></code> (<span class="math">\(\mu\)</span>), a width parameter
<code class="docutils literal"><span class="pre">sigma</span></code> (<span class="math">\(\sigma\)</span>) and an exponent <code class="docutils literal"><span class="pre">beta</span></code> (<span class="math">\(\beta\)</span>).</p>
<div class="math">
\[f(x; A, \mu, \sigma, \beta) = A \big[(\frac{x-\mu}{\sigma})^2+1\big]^{-\beta}\]</div>
<p>the full width have maximum is <span class="math">\(2\sigma\sqrt{2^{1/\beta}-1}\)</span>.
<code class="xref py py-meth docutils literal"><span class="pre">guess()</span></code> function always sets the starting value for <code class="docutils literal"><span class="pre">beta</span></code> to 1.</p>
<p>Note that for (<span class="math">\(\beta=1\)</span>) the Moffat has a Lorentzian shape.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>independent_vars</strong> (<em></em><em>[</em><em>'x'</em><em>]</em><em></em>) &#8211; arguments to func that are independent variables</li>
<li><strong>prefix</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; string to prepend to paramter names, needed to add two Models that
have parameter names in common.</li>
<li><strong>missing</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; <p>how to handle <cite>nan</cite> and missing values in data. One of:</p>
<ul>
<li>&#8216;none&#8217; or <code class="docutils literal"><span class="pre">None</span></code>: Do not check for null or missing values (default)</li>
<li>&#8216;drop&#8217;: Drop null or missing observations in data. if pandas is
installed, <cite>pandas.isnull</cite> is used, otherwise <cite>numpy.isnan</cite> is used.</li>
<li>&#8216;raise&#8217;: Raise a (more helpful) exception when data contains nullz
or missing values.</li>
</ul>
</li>
<li><strong>kwargs</strong> (<em>optional</em>) &#8211; keyword arguments to pass to <code class="xref py py-class docutils literal"><span class="pre">Model</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="pearson7model">
<h3><a class="reference internal" href="#lmfit.models.Pearson7Model" title="lmfit.models.Pearson7Model"><code class="xref py py-class docutils literal"><span class="pre">Pearson7Model</span></code></a><a class="headerlink" href="#pearson7model" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="lmfit.models.Pearson7Model">
<em class="property">class </em><code class="descname">Pearson7Model</code><span class="sig-paren">(</span><em>independent_vars=['x'], prefix='', missing=None, name=None, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.models.Pearson7Model" title="Permalink to this definition">¶</a></dt>
<dd><p>A model based on a Pearson VII distribution (see
<a class="reference external" href="http://en.wikipedia.org/wiki/Pearson_distribution#The_Pearson_type_VII_distribution">http://en.wikipedia.org/wiki/Pearson_distribution#The_Pearson_type_VII_distribution</a>),
with four parameers: <code class="docutils literal"><span class="pre">amplitude</span></code> (<span class="math">\(A\)</span>), <code class="docutils literal"><span class="pre">center</span></code>
(<span class="math">\(\mu\)</span>), <code class="docutils literal"><span class="pre">sigma</span></code> (<span class="math">\(\sigma\)</span>), and <code class="docutils literal"><span class="pre">exponent</span></code> (<span class="math">\(m\)</span>) in</p>
<div class="math">
\[f(x; A, \mu, \sigma, m) = \frac{A}{\sigma{\beta(m-\frac{1}{2}, \frac{1}{2})}} \bigl[1 + \frac{(x-\mu)^2}{\sigma^2}  \bigr]^{-m}\]</div>
<p>where <span class="math">\(\beta\)</span> is the beta function (see <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.special.beta.html">scipy.special.beta</a> in
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/special.html#module-scipy.special" title="(in SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.special</span></code></a>).  The <code class="xref py py-meth docutils literal"><span class="pre">guess()</span></code> function always
gives a starting value for <code class="docutils literal"><span class="pre">exponent</span></code> of 1.5.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>independent_vars</strong> (<em></em><em>[</em><em>'x'</em><em>]</em><em></em>) &#8211; arguments to func that are independent variables</li>
<li><strong>prefix</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; string to prepend to paramter names, needed to add two Models that
have parameter names in common.</li>
<li><strong>missing</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; <p>how to handle <cite>nan</cite> and missing values in data. One of:</p>
<ul>
<li>&#8216;none&#8217; or <code class="docutils literal"><span class="pre">None</span></code>: Do not check for null or missing values (default)</li>
<li>&#8216;drop&#8217;: Drop null or missing observations in data. if pandas is
installed, <cite>pandas.isnull</cite> is used, otherwise <cite>numpy.isnan</cite> is used.</li>
<li>&#8216;raise&#8217;: Raise a (more helpful) exception when data contains nullz
or missing values.</li>
</ul>
</li>
<li><strong>kwargs</strong> (<em>optional</em>) &#8211; keyword arguments to pass to <code class="xref py py-class docutils literal"><span class="pre">Model</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="studentstmodel">
<h3><a class="reference internal" href="#lmfit.models.StudentsTModel" title="lmfit.models.StudentsTModel"><code class="xref py py-class docutils literal"><span class="pre">StudentsTModel</span></code></a><a class="headerlink" href="#studentstmodel" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="lmfit.models.StudentsTModel">
<em class="property">class </em><code class="descname">StudentsTModel</code><span class="sig-paren">(</span><em>independent_vars=['x'], prefix='', missing=None, name=None, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.models.StudentsTModel" title="Permalink to this definition">¶</a></dt>
<dd><p>A model based on a Student&#8217;s t distribution function (see
<a class="reference external" href="http://en.wikipedia.org/wiki/Student%27s_t-distribution">http://en.wikipedia.org/wiki/Student%27s_t-distribution</a>), with three Parameters:
<code class="docutils literal"><span class="pre">amplitude</span></code> (<span class="math">\(A\)</span>), <code class="docutils literal"><span class="pre">center</span></code> (<span class="math">\(\mu\)</span>) and <code class="docutils literal"><span class="pre">sigma</span></code> (<span class="math">\(\sigma\)</span>) in</p>
<div class="math">
\[f(x; A, \mu, \sigma) = \frac{A \Gamma(\frac{\sigma+1}{2})} {\sqrt{\sigma\pi}\,\Gamma(\frac{\sigma}{2})} \Bigl[1+\frac{(x-\mu)^2}{\sigma}\Bigr]^{-\frac{\sigma+1}{2}}\]</div>
<p>where <span class="math">\(\Gamma(x)\)</span> is the gamma function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>independent_vars</strong> (<em></em><em>[</em><em>'x'</em><em>]</em><em></em>) &#8211; arguments to func that are independent variables</li>
<li><strong>prefix</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; string to prepend to paramter names, needed to add two Models that
have parameter names in common.</li>
<li><strong>missing</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; <p>how to handle <cite>nan</cite> and missing values in data. One of:</p>
<ul>
<li>&#8216;none&#8217; or <code class="docutils literal"><span class="pre">None</span></code>: Do not check for null or missing values (default)</li>
<li>&#8216;drop&#8217;: Drop null or missing observations in data. if pandas is
installed, <cite>pandas.isnull</cite> is used, otherwise <cite>numpy.isnan</cite> is used.</li>
<li>&#8216;raise&#8217;: Raise a (more helpful) exception when data contains nullz
or missing values.</li>
</ul>
</li>
<li><strong>kwargs</strong> (<em>optional</em>) &#8211; keyword arguments to pass to <code class="xref py py-class docutils literal"><span class="pre">Model</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="breitwignermodel">
<h3><a class="reference internal" href="#lmfit.models.BreitWignerModel" title="lmfit.models.BreitWignerModel"><code class="xref py py-class docutils literal"><span class="pre">BreitWignerModel</span></code></a><a class="headerlink" href="#breitwignermodel" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="lmfit.models.BreitWignerModel">
<em class="property">class </em><code class="descname">BreitWignerModel</code><span class="sig-paren">(</span><em>independent_vars=['x'], prefix='', missing=None, name=None, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.models.BreitWignerModel" title="Permalink to this definition">¶</a></dt>
<dd><p>A model based on a Breit-Wigner-Fano function (see
<a class="reference external" href="http://en.wikipedia.org/wiki/Fano_resonance">http://en.wikipedia.org/wiki/Fano_resonance</a>&gt;), with four Parameters:
<code class="docutils literal"><span class="pre">amplitude</span></code> (<span class="math">\(A\)</span>), <code class="docutils literal"><span class="pre">center</span></code> (<span class="math">\(\mu\)</span>),
<code class="docutils literal"><span class="pre">sigma</span></code> (<span class="math">\(\sigma\)</span>), and <code class="docutils literal"><span class="pre">q</span></code> (<span class="math">\(q\)</span>) in</p>
<div class="math">
\[f(x; A, \mu, \sigma, q) = \frac{A (q\sigma/2 + x - \mu)^2}{(\sigma/2)^2 + (x - \mu)^2}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>independent_vars</strong> (<em></em><em>[</em><em>'x'</em><em>]</em><em></em>) &#8211; arguments to func that are independent variables</li>
<li><strong>prefix</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; string to prepend to paramter names, needed to add two Models that
have parameter names in common.</li>
<li><strong>missing</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; <p>how to handle <cite>nan</cite> and missing values in data. One of:</p>
<ul>
<li>&#8216;none&#8217; or <code class="docutils literal"><span class="pre">None</span></code>: Do not check for null or missing values (default)</li>
<li>&#8216;drop&#8217;: Drop null or missing observations in data. if pandas is
installed, <cite>pandas.isnull</cite> is used, otherwise <cite>numpy.isnan</cite> is used.</li>
<li>&#8216;raise&#8217;: Raise a (more helpful) exception when data contains nullz
or missing values.</li>
</ul>
</li>
<li><strong>kwargs</strong> (<em>optional</em>) &#8211; keyword arguments to pass to <code class="xref py py-class docutils literal"><span class="pre">Model</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="lognormalmodel">
<h3><a class="reference internal" href="#lmfit.models.LognormalModel" title="lmfit.models.LognormalModel"><code class="xref py py-class docutils literal"><span class="pre">LognormalModel</span></code></a><a class="headerlink" href="#lognormalmodel" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="lmfit.models.LognormalModel">
<em class="property">class </em><code class="descname">LognormalModel</code><span class="sig-paren">(</span><em>independent_vars=['x'], prefix='', missing=None, name=None, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.models.LognormalModel" title="Permalink to this definition">¶</a></dt>
<dd><p>A model based on the Log-normal distribution function
(see <a class="reference external" href="http://en.wikipedia.org/wiki/Lognormal">http://en.wikipedia.org/wiki/Lognormal</a>), with three Parameters
<code class="docutils literal"><span class="pre">amplitude</span></code> (<span class="math">\(A\)</span>), <code class="docutils literal"><span class="pre">center</span></code> (<span class="math">\(\mu\)</span>) and <code class="docutils literal"><span class="pre">sigma</span></code>
(<span class="math">\(\sigma\)</span>) in</p>
<div class="math">
\[f(x; A, \mu, \sigma) = \frac{A e^{-(\ln(x) - \mu)/ 2\sigma^2}}{x}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>independent_vars</strong> (<em></em><em>[</em><em>'x'</em><em>]</em><em></em>) &#8211; arguments to func that are independent variables</li>
<li><strong>prefix</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; string to prepend to paramter names, needed to add two Models that
have parameter names in common.</li>
<li><strong>missing</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; <p>how to handle <cite>nan</cite> and missing values in data. One of:</p>
<ul>
<li>&#8216;none&#8217; or <code class="docutils literal"><span class="pre">None</span></code>: Do not check for null or missing values (default)</li>
<li>&#8216;drop&#8217;: Drop null or missing observations in data. if pandas is
installed, <cite>pandas.isnull</cite> is used, otherwise <cite>numpy.isnan</cite> is used.</li>
<li>&#8216;raise&#8217;: Raise a (more helpful) exception when data contains nullz
or missing values.</li>
</ul>
</li>
<li><strong>kwargs</strong> (<em>optional</em>) &#8211; keyword arguments to pass to <code class="xref py py-class docutils literal"><span class="pre">Model</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="dampedocsillatormodel">
<h3><code class="xref py py-class docutils literal"><span class="pre">DampedOcsillatorModel</span></code><a class="headerlink" href="#dampedocsillatormodel" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="lmfit.models.DampedOscillatorModel">
<em class="property">class </em><code class="descname">DampedOscillatorModel</code><span class="sig-paren">(</span><em>independent_vars=['x'], prefix='', missing=None, name=None, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.models.DampedOscillatorModel" title="Permalink to this definition">¶</a></dt>
<dd><p>A model based on the Damped Harmonic Oscillator Amplitude
(see <a class="reference external" href="http://en.wikipedia.org/wiki/Harmonic_oscillator#Amplitude_part">http://en.wikipedia.org/wiki/Harmonic_oscillator#Amplitude_part</a>), with
three Parameters:  <code class="docutils literal"><span class="pre">amplitude</span></code> (<span class="math">\(A\)</span>), <code class="docutils literal"><span class="pre">center</span></code> (<span class="math">\(\mu\)</span>) and
<code class="docutils literal"><span class="pre">sigma</span></code> (<span class="math">\(\sigma\)</span>) in</p>
<div class="math">
\[f(x; A, \mu, \sigma) = \frac{A}{\sqrt{ [1 - (x/\mu)^2]^2 + (2\sigma x/\mu)^2}}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>independent_vars</strong> (<em></em><em>[</em><em>'x'</em><em>]</em><em></em>) &#8211; arguments to func that are independent variables</li>
<li><strong>prefix</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; string to prepend to paramter names, needed to add two Models that
have parameter names in common.</li>
<li><strong>missing</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; <p>how to handle <cite>nan</cite> and missing values in data. One of:</p>
<ul>
<li>&#8216;none&#8217; or <code class="docutils literal"><span class="pre">None</span></code>: Do not check for null or missing values (default)</li>
<li>&#8216;drop&#8217;: Drop null or missing observations in data. if pandas is
installed, <cite>pandas.isnull</cite> is used, otherwise <cite>numpy.isnan</cite> is used.</li>
<li>&#8216;raise&#8217;: Raise a (more helpful) exception when data contains nullz
or missing values.</li>
</ul>
</li>
<li><strong>kwargs</strong> (<em>optional</em>) &#8211; keyword arguments to pass to <code class="xref py py-class docutils literal"><span class="pre">Model</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="dampedharmonicocsillatormodel">
<h3><code class="xref py py-class docutils literal"><span class="pre">DampedHarmonicOcsillatorModel</span></code><a class="headerlink" href="#dampedharmonicocsillatormodel" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="lmfit.models.DampedHarmonicOscillatorModel">
<em class="property">class </em><code class="descname">DampedHarmonicOscillatorModel</code><span class="sig-paren">(</span><em>independent_vars=['x'], prefix='', missing=None, name=None, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.models.DampedHarmonicOscillatorModel" title="Permalink to this definition">¶</a></dt>
<dd><p>A model based on a variation of the Damped Harmonic Oscillator (see
<a class="reference external" href="http://en.wikipedia.org/wiki/Harmonic_oscillator">http://en.wikipedia.org/wiki/Harmonic_oscillator</a>), following the
definition given in DAVE/PAN (see <a class="reference external" href="https://www.ncnr.nist.gov/dave/">https://www.ncnr.nist.gov/dave/</a>) with
four Parameters: <code class="docutils literal"><span class="pre">amplitude</span></code> (<span class="math">\(A\)</span>), <code class="docutils literal"><span class="pre">center</span></code> (<span class="math">\(\mu\)</span>),
<code class="docutils literal"><span class="pre">sigma</span></code> (<span class="math">\(\sigma\)</span>), and <code class="docutils literal"><span class="pre">gamma</span></code> (<span class="math">\(\gamma\)</span>) in</p>
<div class="math">
\[f(x; A, \mu, \sigma, \gamma) = \frac{A\sigma}{\pi [1 - \exp(-x/\gamma)]}
        \Big[ \frac{1}{(x-\mu)^2 + \sigma^2} - \frac{1}{(x+\mu)^2 + \sigma^2} \Big]\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>independent_vars</strong> (<em></em><em>[</em><em>'x'</em><em>]</em><em></em>) &#8211; arguments to func that are independent variables</li>
<li><strong>prefix</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; string to prepend to paramter names, needed to add two Models that
have parameter names in common.</li>
<li><strong>missing</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; <p>how to handle <cite>nan</cite> and missing values in data. One of:</p>
<ul>
<li>&#8216;none&#8217; or <code class="docutils literal"><span class="pre">None</span></code>: Do not check for null or missing values (default)</li>
<li>&#8216;drop&#8217;: Drop null or missing observations in data. if pandas is
installed, <cite>pandas.isnull</cite> is used, otherwise <cite>numpy.isnan</cite> is used.</li>
<li>&#8216;raise&#8217;: Raise a (more helpful) exception when data contains nullz
or missing values.</li>
</ul>
</li>
<li><strong>kwargs</strong> (<em>optional</em>) &#8211; keyword arguments to pass to <code class="xref py py-class docutils literal"><span class="pre">Model</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="exponentialgaussianmodel">
<h3><a class="reference internal" href="#lmfit.models.ExponentialGaussianModel" title="lmfit.models.ExponentialGaussianModel"><code class="xref py py-class docutils literal"><span class="pre">ExponentialGaussianModel</span></code></a><a class="headerlink" href="#exponentialgaussianmodel" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="lmfit.models.ExponentialGaussianModel">
<em class="property">class </em><code class="descname">ExponentialGaussianModel</code><span class="sig-paren">(</span><em>independent_vars=['x'], prefix='', missing=None, name=None, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.models.ExponentialGaussianModel" title="Permalink to this definition">¶</a></dt>
<dd><p>A model of an Exponentially modified Gaussian distribution
(see <a class="reference external" href="http://en.wikipedia.org/wiki/Exponentially_modified_Gaussian_distribution">http://en.wikipedia.org/wiki/Exponentially_modified_Gaussian_distribution</a>) with
four Parameters <code class="docutils literal"><span class="pre">amplitude</span></code> (<span class="math">\(A\)</span>), <code class="docutils literal"><span class="pre">center</span></code> (<span class="math">\(\mu\)</span>),
<code class="docutils literal"><span class="pre">sigma</span></code> (<span class="math">\(\sigma\)</span>), and  <code class="docutils literal"><span class="pre">gamma</span></code> (<span class="math">\(\gamma\)</span>) in</p>
<div class="math">
\[f(x; A, \mu, \sigma, \gamma) = \frac{A\gamma}{2}
\exp\bigl[\gamma({\mu - x  + \gamma\sigma^2/2})\bigr]
{\operatorname{erfc}}\Bigl(\frac{\mu + \gamma\sigma^2 - x}{\sqrt{2}\sigma}\Bigr)\]</div>
<p>where <code class="xref py py-func docutils literal"><span class="pre">erfc()</span></code> is the complimentary error function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>independent_vars</strong> (<em></em><em>[</em><em>'x'</em><em>]</em><em></em>) &#8211; arguments to func that are independent variables</li>
<li><strong>prefix</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; string to prepend to paramter names, needed to add two Models that
have parameter names in common.</li>
<li><strong>missing</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; <p>how to handle <cite>nan</cite> and missing values in data. One of:</p>
<ul>
<li>&#8216;none&#8217; or <code class="docutils literal"><span class="pre">None</span></code>: Do not check for null or missing values (default)</li>
<li>&#8216;drop&#8217;: Drop null or missing observations in data. if pandas is
installed, <cite>pandas.isnull</cite> is used, otherwise <cite>numpy.isnan</cite> is used.</li>
<li>&#8216;raise&#8217;: Raise a (more helpful) exception when data contains nullz
or missing values.</li>
</ul>
</li>
<li><strong>kwargs</strong> (<em>optional</em>) &#8211; keyword arguments to pass to <code class="xref py py-class docutils literal"><span class="pre">Model</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="skewedgaussianmodel">
<h3><a class="reference internal" href="#lmfit.models.SkewedGaussianModel" title="lmfit.models.SkewedGaussianModel"><code class="xref py py-class docutils literal"><span class="pre">SkewedGaussianModel</span></code></a><a class="headerlink" href="#skewedgaussianmodel" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="lmfit.models.SkewedGaussianModel">
<em class="property">class </em><code class="descname">SkewedGaussianModel</code><span class="sig-paren">(</span><em>independent_vars=['x'], prefix='', missing=None, name=None, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.models.SkewedGaussianModel" title="Permalink to this definition">¶</a></dt>
<dd><p>A variation of the Exponential Gaussian, this uses a skewed normal distribution
(see <a class="reference external" href="http://en.wikipedia.org/wiki/Skew_normal_distribution">http://en.wikipedia.org/wiki/Skew_normal_distribution</a>), with Parameters
<code class="docutils literal"><span class="pre">amplitude</span></code> (<span class="math">\(A\)</span>), <code class="docutils literal"><span class="pre">center</span></code> (<span class="math">\(\mu\)</span>),  <code class="docutils literal"><span class="pre">sigma</span></code> (<span class="math">\(\sigma\)</span>),
and <code class="docutils literal"><span class="pre">gamma</span></code> (<span class="math">\(\gamma\)</span>) in</p>
<div class="math">
\[f(x; A, \mu, \sigma, \gamma) = \frac{A}{\sigma\sqrt{2\pi}}
e^{[{-{(x-\mu)^2}/{{2\sigma}^2}}]} \Bigl\{ 1 +
{\operatorname{erf}}\bigl[
\frac{\gamma(x-\mu)}{\sigma\sqrt{2}}
\bigr] \Bigr\}\]</div>
<p>where <code class="xref py py-func docutils literal"><span class="pre">erf()</span></code> is the error function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>independent_vars</strong> (<em></em><em>[</em><em>'x'</em><em>]</em><em></em>) &#8211; arguments to func that are independent variables</li>
<li><strong>prefix</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; string to prepend to paramter names, needed to add two Models that
have parameter names in common.</li>
<li><strong>missing</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; <p>how to handle <cite>nan</cite> and missing values in data. One of:</p>
<ul>
<li>&#8216;none&#8217; or <code class="docutils literal"><span class="pre">None</span></code>: Do not check for null or missing values (default)</li>
<li>&#8216;drop&#8217;: Drop null or missing observations in data. if pandas is
installed, <cite>pandas.isnull</cite> is used, otherwise <cite>numpy.isnan</cite> is used.</li>
<li>&#8216;raise&#8217;: Raise a (more helpful) exception when data contains nullz
or missing values.</li>
</ul>
</li>
<li><strong>kwargs</strong> (<em>optional</em>) &#8211; keyword arguments to pass to <code class="xref py py-class docutils literal"><span class="pre">Model</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="donaichmodel">
<h3><a class="reference internal" href="#lmfit.models.DonaichModel" title="lmfit.models.DonaichModel"><code class="xref py py-class docutils literal"><span class="pre">DonaichModel</span></code></a><a class="headerlink" href="#donaichmodel" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="lmfit.models.DonaichModel">
<em class="property">class </em><code class="descname">DonaichModel</code><span class="sig-paren">(</span><em>independent_vars=['x'], prefix='', missing=None, name=None, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.models.DonaichModel" title="Permalink to this definition">¶</a></dt>
<dd><p>A model of an Doniach Sunjic asymmetric lineshape
(see <a class="reference external" href="http://www.casaxps.com/help_manual/line_shapes.htm">http://www.casaxps.com/help_manual/line_shapes.htm</a>), used in
photo-emission, with four Parameters <code class="docutils literal"><span class="pre">amplitude</span></code> (<span class="math">\(A\)</span>),
<code class="docutils literal"><span class="pre">center</span></code> (<span class="math">\(\mu\)</span>), <code class="docutils literal"><span class="pre">sigma</span></code> (<span class="math">\(\sigma\)</span>), and <code class="docutils literal"><span class="pre">gamma</span></code>
(<span class="math">\(\gamma\)</span>) in</p>
<div class="math">
\[f(x; A, \mu, \sigma, \gamma) = A\frac{\cos\bigl[\pi\gamma/2 + (1-\gamma)
\arctan{(x - \mu)}/\sigma\bigr]} {\bigr[1 + (x-\mu)/\sigma\bigl]^{(1-\gamma)/2}}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>independent_vars</strong> (<em></em><em>[</em><em>'x'</em><em>]</em><em></em>) &#8211; arguments to func that are independent variables</li>
<li><strong>prefix</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; string to prepend to paramter names, needed to add two Models that
have parameter names in common.</li>
<li><strong>missing</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; <p>how to handle <cite>nan</cite> and missing values in data. One of:</p>
<ul>
<li>&#8216;none&#8217; or <code class="docutils literal"><span class="pre">None</span></code>: Do not check for null or missing values (default)</li>
<li>&#8216;drop&#8217;: Drop null or missing observations in data. if pandas is
installed, <cite>pandas.isnull</cite> is used, otherwise <cite>numpy.isnan</cite> is used.</li>
<li>&#8216;raise&#8217;: Raise a (more helpful) exception when data contains nullz
or missing values.</li>
</ul>
</li>
<li><strong>kwargs</strong> (<em>optional</em>) &#8211; keyword arguments to pass to <code class="xref py py-class docutils literal"><span class="pre">Model</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="linear-and-polynomial-models">
<h2>Linear and Polynomial Models<a class="headerlink" href="#linear-and-polynomial-models" title="Permalink to this headline">¶</a></h2>
<p>These models correspond to polynomials of some degree.  Of course, lmfit is
a very inefficient way to do linear regression (see <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.polyfit.html">numpy.polyfit</a>
or <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.linregress.html">scipy.stats.linregress</a>), but these models may be useful as one
of many components of composite model.</p>
<div class="section" id="constantmodel">
<h3><a class="reference internal" href="#lmfit.models.ConstantModel" title="lmfit.models.ConstantModel"><code class="xref py py-class docutils literal"><span class="pre">ConstantModel</span></code></a><a class="headerlink" href="#constantmodel" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="lmfit.models.ConstantModel">
<em class="property">class </em><code class="descname">ConstantModel</code><span class="sig-paren">(</span><em>independent_vars=['x'], prefix='', missing=None, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.models.ConstantModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Constant model, with a single Parameter: <code class="docutils literal"><span class="pre">c</span></code></p>
<p>Note that this is &#8216;constant&#8217; in the sense of having no dependence on
the independent variable <code class="docutils literal"><span class="pre">x</span></code>, not in the sense of being non-varying.
To be clear, <code class="docutils literal"><span class="pre">c</span></code> will be a Parameter that will be varied in the
fit (by default, of course).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>independent_vars</strong> (<em></em><em>[</em><em>'x'</em><em>]</em><em></em>) &#8211; arguments to func that are independent variables</li>
<li><strong>prefix</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; string to prepend to paramter names, needed to add two Models that
have parameter names in common.</li>
<li><strong>missing</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; <p>how to handle <cite>nan</cite> and missing values in data. One of:</p>
<ul>
<li>&#8216;none&#8217; or <code class="docutils literal"><span class="pre">None</span></code>: Do not check for null or missing values (default)</li>
<li>&#8216;drop&#8217;: Drop null or missing observations in data. if pandas is
installed, <cite>pandas.isnull</cite> is used, otherwise <cite>numpy.isnan</cite> is used.</li>
<li>&#8216;raise&#8217;: Raise a (more helpful) exception when data contains nullz
or missing values.</li>
</ul>
</li>
<li><strong>kwargs</strong> (<em>optional</em>) &#8211; keyword arguments to pass to <code class="xref py py-class docutils literal"><span class="pre">Model</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="linearmodel">
<h3><a class="reference internal" href="#lmfit.models.LinearModel" title="lmfit.models.LinearModel"><code class="xref py py-class docutils literal"><span class="pre">LinearModel</span></code></a><a class="headerlink" href="#linearmodel" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="lmfit.models.LinearModel">
<em class="property">class </em><code class="descname">LinearModel</code><span class="sig-paren">(</span><em>independent_vars=['x'], prefix='', missing=None, name=None, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.models.LinearModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Linear model, with two Parameters
<code class="docutils literal"><span class="pre">intercept</span></code> and <code class="docutils literal"><span class="pre">slope</span></code>, defined as</p>
<div class="math">
\[f(x; m, b) = m x + b\]</div>
<p>with  <code class="docutils literal"><span class="pre">slope</span></code> for <span class="math">\(m\)</span> and  <code class="docutils literal"><span class="pre">intercept</span></code> for <span class="math">\(b\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>independent_vars</strong> (<em></em><em>[</em><em>'x'</em><em>]</em><em></em>) &#8211; arguments to func that are independent variables</li>
<li><strong>prefix</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; string to prepend to paramter names, needed to add two Models that
have parameter names in common.</li>
<li><strong>missing</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; <p>how to handle <cite>nan</cite> and missing values in data. One of:</p>
<ul>
<li>&#8216;none&#8217; or <code class="docutils literal"><span class="pre">None</span></code>: Do not check for null or missing values (default)</li>
<li>&#8216;drop&#8217;: Drop null or missing observations in data. if pandas is
installed, <cite>pandas.isnull</cite> is used, otherwise <cite>numpy.isnan</cite> is used.</li>
<li>&#8216;raise&#8217;: Raise a (more helpful) exception when data contains nullz
or missing values.</li>
</ul>
</li>
<li><strong>kwargs</strong> (<em>optional</em>) &#8211; keyword arguments to pass to <code class="xref py py-class docutils literal"><span class="pre">Model</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="quadraticmodel">
<h3><a class="reference internal" href="#lmfit.models.QuadraticModel" title="lmfit.models.QuadraticModel"><code class="xref py py-class docutils literal"><span class="pre">QuadraticModel</span></code></a><a class="headerlink" href="#quadraticmodel" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="lmfit.models.QuadraticModel">
<em class="property">class </em><code class="descname">QuadraticModel</code><span class="sig-paren">(</span><em>independent_vars=['x'], prefix='', missing=None, name=None, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.models.QuadraticModel" title="Permalink to this definition">¶</a></dt>
<dd><p>A quadratic model, with three Parameters
<code class="docutils literal"><span class="pre">a</span></code>, <code class="docutils literal"><span class="pre">b</span></code>, and <code class="docutils literal"><span class="pre">c</span></code>, defined as</p>
<div class="math">
\[f(x; a, b, c) = a x^2 + b x + c\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>independent_vars</strong> (<em></em><em>[</em><em>'x'</em><em>]</em><em></em>) &#8211; arguments to func that are independent variables</li>
<li><strong>prefix</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; string to prepend to paramter names, needed to add two Models that
have parameter names in common.</li>
<li><strong>missing</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; <p>how to handle <cite>nan</cite> and missing values in data. One of:</p>
<ul>
<li>&#8216;none&#8217; or <code class="docutils literal"><span class="pre">None</span></code>: Do not check for null or missing values (default)</li>
<li>&#8216;drop&#8217;: Drop null or missing observations in data. if pandas is
installed, <cite>pandas.isnull</cite> is used, otherwise <cite>numpy.isnan</cite> is used.</li>
<li>&#8216;raise&#8217;: Raise a (more helpful) exception when data contains nullz
or missing values.</li>
</ul>
</li>
<li><strong>kwargs</strong> (<em>optional</em>) &#8211; keyword arguments to pass to <code class="xref py py-class docutils literal"><span class="pre">Model</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="polynomialmodel">
<h3><a class="reference internal" href="#lmfit.models.PolynomialModel" title="lmfit.models.PolynomialModel"><code class="xref py py-class docutils literal"><span class="pre">PolynomialModel</span></code></a><a class="headerlink" href="#polynomialmodel" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="lmfit.models.PolynomialModel">
<em class="property">class </em><code class="descname">PolynomialModel</code><span class="sig-paren">(</span><em>degree, independent_vars=['x'], prefix='', missing=None, name=None, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.models.PolynomialModel" title="Permalink to this definition">¶</a></dt>
<dd><p>A polynomial model with up to 7 Parameters, specfied by <code class="docutils literal"><span class="pre">degree</span></code>.</p>
<div class="math">
\[\]</div>
<p>f(x; c_0, c_1, ldots, c_7) = sum_{i=0, 7} c_i  x^i</p>
<p>with parameters <code class="docutils literal"><span class="pre">c0</span></code>, <code class="docutils literal"><span class="pre">c1</span></code>, ..., <code class="docutils literal"><span class="pre">c7</span></code>.  The supplied <code class="docutils literal"><span class="pre">degree</span></code>
will specify how many of these are actual variable parameters.  This
uses <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.polyval.html">numpy.polyval</a> for its calculation of the polynomial.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>independent_vars</strong> (<em></em><em>[</em><em>'x'</em><em>]</em><em></em>) &#8211; arguments to func that are independent variables</li>
<li><strong>prefix</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; string to prepend to paramter names, needed to add two Models that
have parameter names in common.</li>
<li><strong>missing</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; <p>how to handle <cite>nan</cite> and missing values in data. One of:</p>
<ul>
<li>&#8216;none&#8217; or <code class="docutils literal"><span class="pre">None</span></code>: Do not check for null or missing values (default)</li>
<li>&#8216;drop&#8217;: Drop null or missing observations in data. if pandas is
installed, <cite>pandas.isnull</cite> is used, otherwise <cite>numpy.isnan</cite> is used.</li>
<li>&#8216;raise&#8217;: Raise a (more helpful) exception when data contains nullz
or missing values.</li>
</ul>
</li>
<li><strong>kwargs</strong> (<em>optional</em>) &#8211; keyword arguments to pass to <code class="xref py py-class docutils literal"><span class="pre">Model</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="step-like-models">
<h2>Step-like models<a class="headerlink" href="#step-like-models" title="Permalink to this headline">¶</a></h2>
<p>Two models represent step-like functions, and share many characteristics.</p>
<div class="section" id="stepmodel">
<h3><a class="reference internal" href="#lmfit.models.StepModel" title="lmfit.models.StepModel"><code class="xref py py-class docutils literal"><span class="pre">StepModel</span></code></a><a class="headerlink" href="#stepmodel" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="lmfit.models.StepModel">
<em class="property">class </em><code class="descname">StepModel</code><span class="sig-paren">(</span><em>independent_vars=['x'], prefix='', missing=None, name=None, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.models.StepModel" title="Permalink to this definition">¶</a></dt>
<dd><p>A model based on a Step function, with three Parameters:
<code class="docutils literal"><span class="pre">amplitude</span></code> (<span class="math">\(A\)</span>), <code class="docutils literal"><span class="pre">center</span></code> (<span class="math">\(\mu\)</span>) and <code class="docutils literal"><span class="pre">sigma</span></code> (<span class="math">\(\sigma\)</span>)
and four choices for functional form:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">linear</span></code> (the default)</li>
<li><code class="docutils literal"><span class="pre">atan</span></code> or <code class="docutils literal"><span class="pre">arctan</span></code> for an arc-tangent function</li>
<li><code class="docutils literal"><span class="pre">erf</span></code> for an error function</li>
<li><code class="docutils literal"><span class="pre">logistic</span></code> for a logistic function (see <a class="reference external" href="http://en.wikipedia.org/wiki/Logistic_function">http://en.wikipedia.org/wiki/Logistic_function</a>).</li>
</ul>
<p>The step function starts with a value 0, and ends with a value of
<span class="math">\(A\)</span> rising to <span class="math">\(A/2\)</span> at <span class="math">\(\mu\)</span>, with <span class="math">\(\sigma\)</span>
setting the characteristic width. The forms are</p>
<div class="math">
\begin{eqnarray*}
&amp; f(x; A, \mu, \sigma, {\mathrm{form={}'linear{}'}})  &amp; = A \min{[1, \max{(0,  \alpha)}]} \\
&amp; f(x; A, \mu, \sigma, {\mathrm{form={}'arctan{}'}})  &amp; = A [1/2 + \arctan{(\alpha)}/{\pi}] \\
&amp; f(x; A, \mu, \sigma, {\mathrm{form={}'erf{}'}})     &amp; = A [1 + {\operatorname{erf}}(\alpha)]/2 \\
&amp; f(x; A, \mu, \sigma, {\mathrm{form={}'logistic{}'}})&amp; = A [1 - \frac{1}{1 +  e^{\alpha}} ]
\end{eqnarray*}</div><p>where <span class="math">\(\alpha  = (x - \mu)/{\sigma}\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>independent_vars</strong> (<em></em><em>[</em><em>'x'</em><em>]</em><em></em>) &#8211; arguments to func that are independent variables</li>
<li><strong>prefix</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; string to prepend to paramter names, needed to add two Models that
have parameter names in common.</li>
<li><strong>missing</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; <p>how to handle <cite>nan</cite> and missing values in data. One of:</p>
<ul>
<li>&#8216;none&#8217; or <code class="docutils literal"><span class="pre">None</span></code>: Do not check for null or missing values (default)</li>
<li>&#8216;drop&#8217;: Drop null or missing observations in data. if pandas is
installed, <cite>pandas.isnull</cite> is used, otherwise <cite>numpy.isnan</cite> is used.</li>
<li>&#8216;raise&#8217;: Raise a (more helpful) exception when data contains nullz
or missing values.</li>
</ul>
</li>
<li><strong>kwargs</strong> (<em>optional</em>) &#8211; keyword arguments to pass to <code class="xref py py-class docutils literal"><span class="pre">Model</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="rectanglemodel">
<h3><a class="reference internal" href="#lmfit.models.RectangleModel" title="lmfit.models.RectangleModel"><code class="xref py py-class docutils literal"><span class="pre">RectangleModel</span></code></a><a class="headerlink" href="#rectanglemodel" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="lmfit.models.RectangleModel">
<em class="property">class </em><code class="descname">RectangleModel</code><span class="sig-paren">(</span><em>independent_vars=['x'], prefix='', missing=None, name=None, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.models.RectangleModel" title="Permalink to this definition">¶</a></dt>
<dd><p>A model based on a Step-up and Step-down function, with five
Parameters: <code class="docutils literal"><span class="pre">amplitude</span></code> (<span class="math">\(A\)</span>), <code class="docutils literal"><span class="pre">center1</span></code> (<span class="math">\(\mu_1\)</span>),
<code class="docutils literal"><span class="pre">center2</span></code> (<span class="math">\(\mu_2\)</span>), <cite>sigma1`</cite> (<span class="math">\(\sigma_1\)</span>) and
<code class="docutils literal"><span class="pre">sigma2</span></code> (<span class="math">\(\sigma_2\)</span>) and four choices for functional form
(which is used for both the Step up and the Step down:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">linear</span></code> (the default)</li>
<li><code class="docutils literal"><span class="pre">atan</span></code> or <code class="docutils literal"><span class="pre">arctan</span></code> for an arc-tangent function</li>
<li><code class="docutils literal"><span class="pre">erf</span></code> for an error function</li>
<li><code class="docutils literal"><span class="pre">logistic</span></code> for a logistic function (see <a class="reference external" href="http://en.wikipedia.org/wiki/Logistic_function">http://en.wikipedia.org/wiki/Logistic_function</a>).</li>
</ul>
<p>The function starts with a value 0, transitions to a value of
<span class="math">\(A\)</span>, taking the value <span class="math">\(A/2\)</span> at <span class="math">\(\mu_1\)</span>, with <span class="math">\(\sigma_1\)</span>
setting the characteristic width. The function then transitions again to
the value <span class="math">\(A/2\)</span> at <span class="math">\(\mu_2\)</span>, with <span class="math">\(\sigma_2\)</span> setting the
characteristic width. The forms are</p>
<div class="math">
\begin{eqnarray*}
&amp;f(x; A, \mu, \sigma, {\mathrm{form={}'linear{}'}})   &amp;= A \{ \min{[1, \max{(0, \alpha_1)}]} + \min{[-1, \max{(0,  \alpha_2)}]} \} \\
&amp;f(x; A, \mu, \sigma, {\mathrm{form={}'arctan{}'}})   &amp;= A [\arctan{(\alpha_1)} + \arctan{(\alpha_2)}]/{\pi} \\
&amp;f(x; A, \mu, \sigma, {\mathrm{form={}'erf{}'}})      &amp;= A [{\operatorname{erf}}(\alpha_1) + {\operatorname{erf}}(\alpha_2)]/2 \\
&amp;f(x; A, \mu, \sigma, {\mathrm{form={}'logistic{}'}}) &amp;= A [1 - \frac{1}{1 + e^{\alpha_1}} - \frac{1}{1 +  e^{\alpha_2}} ]
\end{eqnarray*}</div><p>where <span class="math">\(\alpha_1  = (x - \mu_1)/{\sigma_1}\)</span> and
<span class="math">\(\alpha_2  = -(x - \mu_2)/{\sigma_2}\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>independent_vars</strong> (<em></em><em>[</em><em>'x'</em><em>]</em><em></em>) &#8211; arguments to func that are independent variables</li>
<li><strong>prefix</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; string to prepend to paramter names, needed to add two Models that
have parameter names in common.</li>
<li><strong>missing</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; <p>how to handle <cite>nan</cite> and missing values in data. One of:</p>
<ul>
<li>&#8216;none&#8217; or <code class="docutils literal"><span class="pre">None</span></code>: Do not check for null or missing values (default)</li>
<li>&#8216;drop&#8217;: Drop null or missing observations in data. if pandas is
installed, <cite>pandas.isnull</cite> is used, otherwise <cite>numpy.isnan</cite> is used.</li>
<li>&#8216;raise&#8217;: Raise a (more helpful) exception when data contains nullz
or missing values.</li>
</ul>
</li>
<li><strong>kwargs</strong> (<em>optional</em>) &#8211; keyword arguments to pass to <code class="xref py py-class docutils literal"><span class="pre">Model</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="exponential-and-power-law-models">
<h2>Exponential and Power law models<a class="headerlink" href="#exponential-and-power-law-models" title="Permalink to this headline">¶</a></h2>
<div class="section" id="exponentialmodel">
<h3><a class="reference internal" href="#lmfit.models.ExponentialModel" title="lmfit.models.ExponentialModel"><code class="xref py py-class docutils literal"><span class="pre">ExponentialModel</span></code></a><a class="headerlink" href="#exponentialmodel" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="lmfit.models.ExponentialModel">
<em class="property">class </em><code class="descname">ExponentialModel</code><span class="sig-paren">(</span><em>independent_vars=['x'], prefix='', missing=None, name=None, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.models.ExponentialModel" title="Permalink to this definition">¶</a></dt>
<dd><p>A model based on an exponential decay function
(see <a class="reference external" href="http://en.wikipedia.org/wiki/Exponential_decay">http://en.wikipedia.org/wiki/Exponential_decay</a>) with two Parameters:
<code class="docutils literal"><span class="pre">amplitude</span></code> (<span class="math">\(A\)</span>), and <code class="docutils literal"><span class="pre">decay</span></code> (<span class="math">\(\tau\)</span>), in:</p>
<div class="math">
\[f(x; A, \tau) = A e^{-x/\tau}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>independent_vars</strong> (<em></em><em>[</em><em>'x'</em><em>]</em><em></em>) &#8211; arguments to func that are independent variables</li>
<li><strong>prefix</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; string to prepend to paramter names, needed to add two Models that
have parameter names in common.</li>
<li><strong>missing</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; <p>how to handle <cite>nan</cite> and missing values in data. One of:</p>
<ul>
<li>&#8216;none&#8217; or <code class="docutils literal"><span class="pre">None</span></code>: Do not check for null or missing values (default)</li>
<li>&#8216;drop&#8217;: Drop null or missing observations in data. if pandas is
installed, <cite>pandas.isnull</cite> is used, otherwise <cite>numpy.isnan</cite> is used.</li>
<li>&#8216;raise&#8217;: Raise a (more helpful) exception when data contains nullz
or missing values.</li>
</ul>
</li>
<li><strong>kwargs</strong> (<em>optional</em>) &#8211; keyword arguments to pass to <code class="xref py py-class docutils literal"><span class="pre">Model</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="powerlawmodel">
<h3><a class="reference internal" href="#lmfit.models.PowerLawModel" title="lmfit.models.PowerLawModel"><code class="xref py py-class docutils literal"><span class="pre">PowerLawModel</span></code></a><a class="headerlink" href="#powerlawmodel" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="lmfit.models.PowerLawModel">
<em class="property">class </em><code class="descname">PowerLawModel</code><span class="sig-paren">(</span><em>independent_vars=['x'], prefix='', missing=None, name=None, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.models.PowerLawModel" title="Permalink to this definition">¶</a></dt>
<dd><p>A model based on a Power Law (see <a class="reference external" href="http://en.wikipedia.org/wiki/Power_law">http://en.wikipedia.org/wiki/Power_law</a>&gt;),
with two Parameters: <code class="docutils literal"><span class="pre">amplitude</span></code> (<span class="math">\(A\)</span>), and <code class="docutils literal"><span class="pre">exponent</span></code> (<span class="math">\(k\)</span>), in:</p>
<div class="math">
\[f(x; A, k) = A x^k\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>independent_vars</strong> (<em></em><em>[</em><em>'x'</em><em>]</em><em></em>) &#8211; arguments to func that are independent variables</li>
<li><strong>prefix</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; string to prepend to paramter names, needed to add two Models that
have parameter names in common.</li>
<li><strong>missing</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; <p>how to handle <cite>nan</cite> and missing values in data. One of:</p>
<ul>
<li>&#8216;none&#8217; or <code class="docutils literal"><span class="pre">None</span></code>: Do not check for null or missing values (default)</li>
<li>&#8216;drop&#8217;: Drop null or missing observations in data. if pandas is
installed, <cite>pandas.isnull</cite> is used, otherwise <cite>numpy.isnan</cite> is used.</li>
<li>&#8216;raise&#8217;: Raise a (more helpful) exception when data contains nullz
or missing values.</li>
</ul>
</li>
<li><strong>kwargs</strong> (<em>optional</em>) &#8211; keyword arguments to pass to <code class="xref py py-class docutils literal"><span class="pre">Model</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="user-defined-models">
<h2>User-defined Models<a class="headerlink" href="#user-defined-models" title="Permalink to this headline">¶</a></h2>
<p>As shown in the previous chapter (<a class="reference internal" href="model.html#model-chapter"><span class="std std-ref">Modeling Data and Curve Fitting</span></a>), it is fairly
straightforward to build fitting models from parametrized python functions.
The number of model classes listed so far in the present chapter should
make it clear that this process is not too difficult.  Still, it is
sometimes desirable to build models from a user-supplied function.  This
may be especially true if model-building is built-in to some larger library
or application for fitting in which the user may not be able to easily
build and use a new model from python code.</p>
<p>The <a class="reference internal" href="#lmfit.models.ExpressionModel" title="lmfit.models.ExpressionModel"><code class="xref py py-class docutils literal"><span class="pre">ExpressionModel</span></code></a> allows a model to be built from a
user-supplied expression.  This uses the <a class="reference external" href="http://newville.github.io/asteval/">asteval</a> module also used for
mathematical constraints as discussed in <a class="reference internal" href="constraints.html#constraints-chapter"><span class="std std-ref">Using Mathematical Constraints</span></a>.</p>
<div class="section" id="expressionmodel">
<h3><a class="reference internal" href="#lmfit.models.ExpressionModel" title="lmfit.models.ExpressionModel"><code class="xref py py-class docutils literal"><span class="pre">ExpressionModel</span></code></a><a class="headerlink" href="#expressionmodel" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="lmfit.models.ExpressionModel">
<em class="property">class </em><code class="descname">ExpressionModel</code><span class="sig-paren">(</span><em>expr</em>, <em>independent_vars=None</em>, <em>init_script=None</em>, <em>missing=None</em>, <em>**kws</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.models.ExpressionModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Model from User-supplied expression.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>expr</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; mathematical expression for model.</li>
<li><strong>independent_vars</strong> (list of strings or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; variable names to use as independent variables</li>
<li><strong>init_script</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; initial script to run in asteval interpreter</li>
<li><strong>missing</strong> (string or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; <p>how to handle <cite>nan</cite> and missing values in data. One of:</p>
<ul>
<li>&#8216;none&#8217; or <code class="docutils literal"><span class="pre">None</span></code>: Do not check for null or missing values (default)</li>
<li>&#8216;drop&#8217;: Drop null or missing observations in data. if pandas is
installed, <cite>pandas.isnull</cite> is used, otherwise <cite>numpy.isnan</cite> is used.</li>
<li>&#8216;raise&#8217;: Raise a (more helpful) exception when data contains nullz
or missing values.</li>
</ul>
</li>
<li><strong>kwargs</strong> (<em>optional</em>) &#8211; keyword arguments to pass to <code class="xref py py-class docutils literal"><span class="pre">Model</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<ol class="arabic simple">
<li>each instance of ExpressionModel will create and using its own
version of an asteval interpreter.</li>
<li>prefix is <strong>not supported</strong> for ExpressionModel</li>
</ol>
</dd></dl>

<p>Since the point of this model is that an arbitrary expression will be
supplied, the determination of what are the parameter names for the model
happens when the model is created.  To do this, the expression is parsed,
and all symbol names are found.  Names that are already known (there are
over 500 function and value names in the asteval namespace, including most
python builtins, more than 200 functions inherited from numpy, and more
than 20 common lineshapes defined in the <code class="xref py py-mod docutils literal"><span class="pre">lineshapes</span></code> module) are not
converted to parameters.  Unrecognized name are expected to be names either
of parameters or independent variables.  If <cite>independent_vars</cite> is the
default value of <code class="docutils literal"><span class="pre">None</span></code>, and if the expression contains a variable named
<cite>x</cite>, that will be used as the independent variable.  Otherwise,
<cite>independent_vars</cite> must be given.</p>
<p>For example, if one creates an <a class="reference internal" href="#lmfit.models.ExpressionModel" title="lmfit.models.ExpressionModel"><code class="xref py py-class docutils literal"><span class="pre">ExpressionModel</span></code></a> as:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span> <span class="o">=</span> <span class="n">ExpressionModel</span><span class="p">(</span><span class="s1">&#39;off + amp * exp(-x/x0) * sin(x*phase)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The name <cite>exp</cite> will be recognized as the exponent function, so the model
will be interpreted to have parameters named <cite>off</cite>, <cite>amp</cite>, <cite>x0</cite> and
<cite>phase</cite>. In addition, <cite>x</cite> will be assumed to be the sole independent variable.
In general, there is no obvious way to set default parameter values or
parameter hints for bounds, so this will have to be handled explicitly.</p>
<p>To evaluate this model, you might do the following:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">501</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">make_params</span><span class="p">(</span><span class="n">off</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>While many custom models can be built with a single line expression
(especially since the names of the lineshapes like <cite>gaussian</cite>, <cite>lorentzian</cite>
and so on, as well as many numpy functions, are available), more complex
models will inevitably require multiple line functions.  You can include
such Python code with the <cite>init_script</cite> argument.  The text of this script
is evaluated when the model is initialized (and before the actual
expression is parsed), so that you can define functions to be used
in your expression.</p>
<p>As a probably unphysical example, to make a model that is the derivative of
a Gaussian function times the logarithm of a Lorentzian function you may
could to define this in a script:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">script</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="go">def mycurve(x, amp, cen, sig):</span>
<span class="go">    loren = lorentzian(x, amplitude=amp, center=cen, sigma=sig)</span>
<span class="go">    gauss = gaussian(x, amplitude=amp, center=cen, sigma=sig)</span>
<span class="go">    return log(loren)*gradient(gauss)/gradient(x)</span>
<span class="go">&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>and then use this with <a class="reference internal" href="#lmfit.models.ExpressionModel" title="lmfit.models.ExpressionModel"><code class="xref py py-class docutils literal"><span class="pre">ExpressionModel</span></code></a> as:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span> <span class="o">=</span> <span class="n">ExpressionModel</span><span class="p">(</span><span class="s1">&#39;mycurve(x, height, mid, wid)&#39;</span><span class="p">,</span>
<span class="go">                          init_script=script,</span>
<span class="go">                          independent_vars=[&#39;x&#39;])</span>
</pre></div>
</div>
<p>As above, this will interpret the parameter names to be <cite>height</cite>, <cite>mid</cite>,
and <cite>wid</cite>, and build a model that can be used to fit data.</p>
</div>
</div>
<div class="section" id="example-1-fit-peaked-data-to-gaussian-lorentzian-and-voigt-profiles">
<h2>Example 1: Fit Peaked data to Gaussian, Lorentzian, and  Voigt profiles<a class="headerlink" href="#example-1-fit-peaked-data-to-gaussian-lorentzian-and-voigt-profiles" title="Permalink to this headline">¶</a></h2>
<p>Here, we will fit data to three similar line shapes, in order to decide which
might be the better model.  We will start with a Gaussian profile, as in
the previous chapter, but use the built-in <a class="reference internal" href="#lmfit.models.GaussianModel" title="lmfit.models.GaussianModel"><code class="xref py py-class docutils literal"><span class="pre">GaussianModel</span></code></a> instead
of writing one ourselves.  This is a slightly different version rom the
one in previous example in that the parameter names are different, and have
built-in default values.  We&#8217;ll simply use:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">loadtxt</span>
<span class="kn">from</span> <span class="nn">lmfit.models</span> <span class="k">import</span> <span class="n">GaussianModel</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;test_peak.dat&#39;</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">mod</span> <span class="o">=</span> <span class="n">GaussianModel</span><span class="p">()</span>

<span class="n">pars</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">guess</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
<span class="n">out</span>  <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">pars</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">fit_report</span><span class="p">(</span><span class="n">min_correl</span><span class="o">=</span><span class="mf">0.25</span><span class="p">))</span>
</pre></div>
</div>
<p>which prints out the results:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">Model</span><span class="p">]]</span>
    <span class="n">Model</span><span class="p">(</span><span class="n">gaussian</span><span class="p">)</span>
<span class="p">[[</span><span class="n">Fit</span> <span class="n">Statistics</span><span class="p">]]</span>
    <span class="c1"># function evals   = 23</span>
    <span class="c1"># data points      = 401</span>
    <span class="c1"># variables        = 3</span>
    <span class="n">chi</span><span class="o">-</span><span class="n">square</span>         <span class="o">=</span> <span class="mf">29.994</span>
    <span class="n">reduced</span> <span class="n">chi</span><span class="o">-</span><span class="n">square</span> <span class="o">=</span> <span class="mf">0.075</span>
    <span class="n">Akaike</span> <span class="n">info</span> <span class="n">crit</span>   <span class="o">=</span> <span class="o">-</span><span class="mf">1033.774</span>
    <span class="n">Bayesian</span> <span class="n">info</span> <span class="n">crit</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1021.792</span>
<span class="p">[[</span><span class="n">Variables</span><span class="p">]]</span>
    <span class="n">sigma</span><span class="p">:</span>       <span class="mf">1.23218319</span> <span class="o">+/-</span> <span class="mf">0.007374</span> <span class="p">(</span><span class="mf">0.60</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mf">1.35</span><span class="p">)</span>
    <span class="n">center</span><span class="p">:</span>      <span class="mf">9.24277049</span> <span class="o">+/-</span> <span class="mf">0.007374</span> <span class="p">(</span><span class="mf">0.08</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mf">9.25</span><span class="p">)</span>
    <span class="n">amplitude</span><span class="p">:</span>   <span class="mf">30.3135571</span> <span class="o">+/-</span> <span class="mf">0.157126</span> <span class="p">(</span><span class="mf">0.52</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mf">29.08159</span><span class="p">)</span>
    <span class="n">fwhm</span><span class="p">:</span>        <span class="mf">2.90156963</span> <span class="o">+/-</span> <span class="mf">0.017366</span> <span class="p">(</span><span class="mf">0.60</span><span class="o">%</span><span class="p">)</span>  <span class="o">==</span> <span class="s1">&#39;2.3548200*sigma&#39;</span>
    <span class="n">height</span><span class="p">:</span>      <span class="mf">9.81457973</span> <span class="o">+/-</span> <span class="mf">0.050872</span> <span class="p">(</span><span class="mf">0.52</span><span class="o">%</span><span class="p">)</span>  <span class="o">==</span> <span class="s1">&#39;0.3989423*amplitude/max(1.e-15, sigma)&#39;</span>
<span class="p">[[</span><span class="n">Correlations</span><span class="p">]]</span> <span class="p">(</span><span class="n">unreported</span> <span class="n">correlations</span> <span class="n">are</span> <span class="o">&lt;</span>  <span class="mf">0.250</span><span class="p">)</span>
    <span class="n">C</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">amplitude</span><span class="p">)</span>          <span class="o">=</span>  <span class="mf">0.577</span>
</pre></div>
</div>
<p>We see a few interesting differences from the results of the previous
chapter. First, the parameter names are longer. Second, there are <code class="docutils literal"><span class="pre">fwhm</span></code>
and <code class="docutils literal"><span class="pre">height</span></code> parameters, to give the full width at half maximum and
maximum peak height.  And third, the automated initial guesses are pretty
good. A plot of the fit:</p>
<blockquote id="figa1">
<div><a class="reference external image-reference" href="_images/models_peak1.png"><img alt="_images/models_peak1.png" src="_images/models_peak1.png" style="width: 48%;" /></a>
<a class="reference external image-reference" href="_images/models_peak2.png"><img alt="_images/models_peak2.png" src="_images/models_peak2.png" style="width: 48%;" /></a>
<p>Fit to peak with Gaussian (left) and Lorentzian (right) models.</p>
</div></blockquote>
<p>shows a decent match to the data &#8211; the fit worked with no explicit setting
of initial parameter values.  Looking more closing, the fit is not perfect,
especially in the tails of the peak, suggesting that a different peak
shape, with longer tails, should be used.  Perhaps a Lorentzian would be
better?  To do this, we simply replace <code class="docutils literal"><span class="pre">GaussianModel</span></code> with
<code class="docutils literal"><span class="pre">LorentzianModel</span></code> to get a <a class="reference internal" href="#lmfit.models.LorentzianModel" title="lmfit.models.LorentzianModel"><code class="xref py py-class docutils literal"><span class="pre">LorentzianModel</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lmfit.models</span> <span class="k">import</span> <span class="n">LorentzianModel</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">LorentzianModel</span><span class="p">()</span>
</pre></div>
</div>
<p>with the rest of the script as above.  Perhaps predictably, the first thing
we try gives results that are worse:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">Model</span><span class="p">]]</span>
    <span class="n">Model</span><span class="p">(</span><span class="n">lorentzian</span><span class="p">)</span>
<span class="p">[[</span><span class="n">Fit</span> <span class="n">Statistics</span><span class="p">]]</span>
    <span class="c1"># function evals   = 27</span>
    <span class="c1"># data points      = 401</span>
    <span class="c1"># variables        = 3</span>
    <span class="n">chi</span><span class="o">-</span><span class="n">square</span>         <span class="o">=</span> <span class="mf">53.754</span>
    <span class="n">reduced</span> <span class="n">chi</span><span class="o">-</span><span class="n">square</span> <span class="o">=</span> <span class="mf">0.135</span>
    <span class="n">Akaike</span> <span class="n">info</span> <span class="n">crit</span>   <span class="o">=</span> <span class="o">-</span><span class="mf">799.830</span>
    <span class="n">Bayesian</span> <span class="n">info</span> <span class="n">crit</span> <span class="o">=</span> <span class="o">-</span><span class="mf">787.848</span>
<span class="p">[[</span><span class="n">Variables</span><span class="p">]]</span>
    <span class="n">sigma</span><span class="p">:</span>       <span class="mf">1.15484517</span> <span class="o">+/-</span> <span class="mf">0.013156</span> <span class="p">(</span><span class="mf">1.14</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mf">1.35</span><span class="p">)</span>
    <span class="n">center</span><span class="p">:</span>      <span class="mf">9.24438944</span> <span class="o">+/-</span> <span class="mf">0.009275</span> <span class="p">(</span><span class="mf">0.10</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mf">9.25</span><span class="p">)</span>
    <span class="n">amplitude</span><span class="p">:</span>   <span class="mf">38.9728645</span> <span class="o">+/-</span> <span class="mf">0.313857</span> <span class="p">(</span><span class="mf">0.81</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mf">36.35199</span><span class="p">)</span>
    <span class="n">fwhm</span><span class="p">:</span>        <span class="mf">2.30969034</span> <span class="o">+/-</span> <span class="mf">0.026312</span> <span class="p">(</span><span class="mf">1.14</span><span class="o">%</span><span class="p">)</span>  <span class="o">==</span> <span class="s1">&#39;2.0000000*sigma&#39;</span>
    <span class="n">height</span><span class="p">:</span>      <span class="mf">10.7420881</span> <span class="o">+/-</span> <span class="mf">0.086336</span> <span class="p">(</span><span class="mf">0.80</span><span class="o">%</span><span class="p">)</span>  <span class="o">==</span> <span class="s1">&#39;0.3183099*amplitude/max(1.e-15, sigma)&#39;</span>
<span class="p">[[</span><span class="n">Correlations</span><span class="p">]]</span> <span class="p">(</span><span class="n">unreported</span> <span class="n">correlations</span> <span class="n">are</span> <span class="o">&lt;</span>  <span class="mf">0.250</span><span class="p">)</span>
    <span class="n">C</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">amplitude</span><span class="p">)</span>          <span class="o">=</span>  <span class="mf">0.709</span>
</pre></div>
</div>
<p>with the plot shown on the right in the figure above.  The tails are now
too big, and the value for <span class="math">\(\chi^2\)</span> almost doubled.  A Voigt model
does a better job.  Using <a class="reference internal" href="#lmfit.models.VoigtModel" title="lmfit.models.VoigtModel"><code class="xref py py-class docutils literal"><span class="pre">VoigtModel</span></code></a>, this is as simple as using:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lmfit.models</span> <span class="k">import</span> <span class="n">VoigtModel</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">VoigtModel</span><span class="p">()</span>
</pre></div>
</div>
<p>with all the rest of the script as above.  This gives:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">Model</span><span class="p">]]</span>
    <span class="n">Model</span><span class="p">(</span><span class="n">voigt</span><span class="p">)</span>
<span class="p">[[</span><span class="n">Fit</span> <span class="n">Statistics</span><span class="p">]]</span>
    <span class="c1"># function evals   = 19</span>
    <span class="c1"># data points      = 401</span>
    <span class="c1"># variables        = 3</span>
    <span class="n">chi</span><span class="o">-</span><span class="n">square</span>         <span class="o">=</span> <span class="mf">14.545</span>
    <span class="n">reduced</span> <span class="n">chi</span><span class="o">-</span><span class="n">square</span> <span class="o">=</span> <span class="mf">0.037</span>
    <span class="n">Akaike</span> <span class="n">info</span> <span class="n">crit</span>   <span class="o">=</span> <span class="o">-</span><span class="mf">1324.006</span>
    <span class="n">Bayesian</span> <span class="n">info</span> <span class="n">crit</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1312.024</span>
<span class="p">[[</span><span class="n">Variables</span><span class="p">]]</span>
    <span class="n">amplitude</span><span class="p">:</span>   <span class="mf">35.7554017</span> <span class="o">+/-</span> <span class="mf">0.138614</span> <span class="p">(</span><span class="mf">0.39</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mf">43.62238</span><span class="p">)</span>
    <span class="n">sigma</span><span class="p">:</span>       <span class="mf">0.73015574</span> <span class="o">+/-</span> <span class="mf">0.003684</span> <span class="p">(</span><span class="mf">0.50</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mf">0.8775</span><span class="p">)</span>
    <span class="n">center</span><span class="p">:</span>      <span class="mf">9.24411142</span> <span class="o">+/-</span> <span class="mf">0.005054</span> <span class="p">(</span><span class="mf">0.05</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mf">9.25</span><span class="p">)</span>
    <span class="n">gamma</span><span class="p">:</span>       <span class="mf">0.73015574</span> <span class="o">+/-</span> <span class="mf">0.003684</span> <span class="p">(</span><span class="mf">0.50</span><span class="o">%</span><span class="p">)</span>  <span class="o">==</span> <span class="s1">&#39;sigma&#39;</span>
    <span class="n">fwhm</span><span class="p">:</span>        <span class="mf">2.62951718</span> <span class="o">+/-</span> <span class="mf">0.013269</span> <span class="p">(</span><span class="mf">0.50</span><span class="o">%</span><span class="p">)</span>  <span class="o">==</span> <span class="s1">&#39;3.6013100*sigma&#39;</span>
    <span class="n">height</span><span class="p">:</span>      <span class="mf">19.5360268</span> <span class="o">+/-</span> <span class="mf">0.075691</span> <span class="p">(</span><span class="mf">0.39</span><span class="o">%</span><span class="p">)</span>  <span class="o">==</span> <span class="s1">&#39;0.3989423*amplitude/max(1.e-15, sigma)&#39;</span>
<span class="p">[[</span><span class="n">Correlations</span><span class="p">]]</span> <span class="p">(</span><span class="n">unreported</span> <span class="n">correlations</span> <span class="n">are</span> <span class="o">&lt;</span>  <span class="mf">0.250</span><span class="p">)</span>
    <span class="n">C</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">amplitude</span><span class="p">)</span>          <span class="o">=</span>  <span class="mf">0.651</span>
</pre></div>
</div>
<p>which has a much better value for <span class="math">\(\chi^2\)</span> and an obviously better
match to the data as seen in the figure below (left).</p>
<blockquote id="figa2">
<div><a class="reference external image-reference" href="_images/models_peak3.png"><img alt="_images/models_peak3.png" src="_images/models_peak3.png" style="width: 48%;" /></a>
<a class="reference external image-reference" href="_images/models_peak4.png"><img alt="_images/models_peak4.png" src="_images/models_peak4.png" style="width: 48%;" /></a>
<p>Fit to peak with Voigt model (left) and Voigt model with <code class="docutils literal"><span class="pre">gamma</span></code>
varying independently of <code class="docutils literal"><span class="pre">sigma</span></code> (right).</p>
</div></blockquote>
<p>Can we do better? The Voigt function has a <span class="math">\(\gamma\)</span> parameter
(<code class="docutils literal"><span class="pre">gamma</span></code>) that can be distinct from <code class="docutils literal"><span class="pre">sigma</span></code>.  The default behavior used
above constrains <code class="docutils literal"><span class="pre">gamma</span></code> to have exactly the same value as <code class="docutils literal"><span class="pre">sigma</span></code>.  If
we allow these to vary separately, does the fit improve?  To do this, we
have to change the <code class="docutils literal"><span class="pre">gamma</span></code> parameter from a constrained expression and
give it a starting value using something like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mod</span> <span class="o">=</span> <span class="n">VoigtModel</span><span class="p">()</span>
<span class="n">pars</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">guess</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;gamma&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">vary</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">expr</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>which gives:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">Model</span><span class="p">]]</span>
    <span class="n">Model</span><span class="p">(</span><span class="n">voigt</span><span class="p">)</span>
<span class="p">[[</span><span class="n">Fit</span> <span class="n">Statistics</span><span class="p">]]</span>
    <span class="c1"># function evals   = 23</span>
    <span class="c1"># data points      = 401</span>
    <span class="c1"># variables        = 4</span>
    <span class="n">chi</span><span class="o">-</span><span class="n">square</span>         <span class="o">=</span> <span class="mf">10.930</span>
    <span class="n">reduced</span> <span class="n">chi</span><span class="o">-</span><span class="n">square</span> <span class="o">=</span> <span class="mf">0.028</span>
    <span class="n">Akaike</span> <span class="n">info</span> <span class="n">crit</span>   <span class="o">=</span> <span class="o">-</span><span class="mf">1436.576</span>
    <span class="n">Bayesian</span> <span class="n">info</span> <span class="n">crit</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1420.600</span>
<span class="p">[[</span><span class="n">Variables</span><span class="p">]]</span>
    <span class="n">amplitude</span><span class="p">:</span>   <span class="mf">34.1914716</span> <span class="o">+/-</span> <span class="mf">0.179468</span> <span class="p">(</span><span class="mf">0.52</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mf">43.62238</span><span class="p">)</span>
    <span class="n">sigma</span><span class="p">:</span>       <span class="mf">0.89518950</span> <span class="o">+/-</span> <span class="mf">0.014154</span> <span class="p">(</span><span class="mf">1.58</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mf">0.8775</span><span class="p">)</span>
    <span class="n">center</span><span class="p">:</span>      <span class="mf">9.24374845</span> <span class="o">+/-</span> <span class="mf">0.004419</span> <span class="p">(</span><span class="mf">0.05</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mf">9.25</span><span class="p">)</span>
    <span class="n">gamma</span><span class="p">:</span>       <span class="mf">0.52540156</span> <span class="o">+/-</span> <span class="mf">0.018579</span> <span class="p">(</span><span class="mf">3.54</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mf">0.7</span><span class="p">)</span>
    <span class="n">fwhm</span><span class="p">:</span>        <span class="mf">3.22385492</span> <span class="o">+/-</span> <span class="mf">0.050974</span> <span class="p">(</span><span class="mf">1.58</span><span class="o">%</span><span class="p">)</span>  <span class="o">==</span> <span class="s1">&#39;3.6013100*sigma&#39;</span>
    <span class="n">height</span><span class="p">:</span>      <span class="mf">15.2374711</span> <span class="o">+/-</span> <span class="mf">0.299235</span> <span class="p">(</span><span class="mf">1.96</span><span class="o">%</span><span class="p">)</span>  <span class="o">==</span> <span class="s1">&#39;0.3989423*amplitude/max(1.e-15, sigma)&#39;</span>
<span class="p">[[</span><span class="n">Correlations</span><span class="p">]]</span> <span class="p">(</span><span class="n">unreported</span> <span class="n">correlations</span> <span class="n">are</span> <span class="o">&lt;</span>  <span class="mf">0.250</span><span class="p">)</span>
    <span class="n">C</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>              <span class="o">=</span> <span class="o">-</span><span class="mf">0.928</span>
    <span class="n">C</span><span class="p">(</span><span class="n">gamma</span><span class="p">,</span> <span class="n">amplitude</span><span class="p">)</span>          <span class="o">=</span>  <span class="mf">0.821</span>
    <span class="n">C</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">amplitude</span><span class="p">)</span>          <span class="o">=</span> <span class="o">-</span><span class="mf">0.651</span>
</pre></div>
</div>
<p>and the fit shown on the right above.</p>
<p>Comparing the two fits with the Voigt function, we see that <span class="math">\(\chi^2\)</span>
is definitely improved with a separately varying <code class="docutils literal"><span class="pre">gamma</span></code> parameter.  In
addition, the two values for <code class="docutils literal"><span class="pre">gamma</span></code> and <code class="docutils literal"><span class="pre">sigma</span></code> differ significantly
&#8211; well outside the estimated uncertainties.  More compelling, reduced
<span class="math">\(\chi^2\)</span> is improved even though a fourth variable has been added to
the fit.  In the simplest statistical sense, this suggests that <code class="docutils literal"><span class="pre">gamma</span></code>
is a significant variable in the model.  In addition, we can use both the
Akaike or Bayesian Information Criteria (see
<a class="reference internal" href="fitting.html#information-criteria-label"><span class="std std-ref">Akaike and Bayesian Information Criteria</span></a>) to assess how likely the model with
variable <code class="docutils literal"><span class="pre">gamma</span></code> is to explain the data than the model with <code class="docutils literal"><span class="pre">gamma</span></code>
fixed to the value of <code class="docutils literal"><span class="pre">sigma</span></code>.  According to theory,
<span class="math">\(\exp(-(\rm{AIC1}-\rm{AIC0})/2)\)</span> gives the probably that a model with
AIC` is more likely than a model with AIC0.  For the two models here, with
AIC values of -1432 and -1321 (Note: if we had more carefully set the value
for <code class="docutils literal"><span class="pre">weights</span></code> based on the noise in the data, these values might be
positive, but there difference would be roughly the same), this says that
the model with <code class="docutils literal"><span class="pre">gamma</span></code> fixed to <code class="docutils literal"><span class="pre">sigma</span></code> has a probably less than 1.e-25
of being the better model.</p>
</div>
<div class="section" id="example-2-fit-data-to-a-composite-model-with-pre-defined-models">
<h2>Example 2: Fit data to a Composite Model with pre-defined models<a class="headerlink" href="#example-2-fit-data-to-a-composite-model-with-pre-defined-models" title="Permalink to this headline">¶</a></h2>
<p>Here, we repeat the point made at the end of the last chapter that
instances of <code class="xref py py-class docutils literal"><span class="pre">model.Model</span></code> class can be added together to make a
<em>composite model</em>.  By using the large number of built-in models available,
it is therefore very simple to build models that contain multiple peaks and
various backgrounds.  An example of a simple fit to a noisy step function
plus a constant:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1">#&lt;examples/doc_stepmodel.py&gt;</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">lmfit.models</span> <span class="k">import</span> <span class="n">StepModel</span><span class="p">,</span> <span class="n">LinearModel</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">201</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">y</span><span class="p">[:</span><span class="mi">48</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">y</span><span class="p">[</span><span class="mi">48</span><span class="p">:</span><span class="mi">77</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">77</span><span class="o">-</span><span class="mi">48</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">77.0</span><span class="o">-</span><span class="mi">48</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="mf">110.2</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="mf">9e-3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span> <span class="o">+</span> <span class="mf">12.0</span> <span class="o">+</span> <span class="mf">2.22</span><span class="o">*</span><span class="n">x</span>

<span class="n">step_mod</span> <span class="o">=</span> <span class="n">StepModel</span><span class="p">(</span><span class="n">form</span><span class="o">=</span><span class="s1">&#39;erf&#39;</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;step_&#39;</span><span class="p">)</span>
<span class="n">line_mod</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;line_&#39;</span><span class="p">)</span>

<span class="n">pars</span> <span class="o">=</span>  <span class="n">line_mod</span><span class="o">.</span><span class="n">make_params</span><span class="p">(</span><span class="n">intercept</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">slope</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">pars</span> <span class="o">+=</span> <span class="n">step_mod</span><span class="o">.</span><span class="n">guess</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>

<span class="n">mod</span> <span class="o">=</span> <span class="n">step_mod</span> <span class="o">+</span> <span class="n">line_mod</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">pars</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">fit_report</span><span class="p">())</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">out</span><span class="o">.</span><span class="n">init_fit</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">out</span><span class="o">.</span><span class="n">best_fit</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1">#&lt;end examples/doc_stepmodel.py&gt;</span>
</pre></div>
</div>
<p>After constructing step-like data, we first create a <a class="reference internal" href="#lmfit.models.StepModel" title="lmfit.models.StepModel"><code class="xref py py-class docutils literal"><span class="pre">StepModel</span></code></a>
telling it to use the <code class="docutils literal"><span class="pre">erf</span></code> form (see details above), and a
<a class="reference internal" href="#lmfit.models.ConstantModel" title="lmfit.models.ConstantModel"><code class="xref py py-class docutils literal"><span class="pre">ConstantModel</span></code></a>.  We set initial values, in one case using the data
and <code class="xref py py-meth docutils literal"><span class="pre">guess()</span></code> method for the initial step function paramaters, and
<code class="xref py py-meth docutils literal"><span class="pre">make_params()</span></code> arguments for the linear component.
After making a composite model, we run <code class="xref py py-meth docutils literal"><span class="pre">fit()</span></code> and report the
results, which gives:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">Model</span><span class="p">]]</span>
    <span class="p">(</span><span class="n">Model</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;step_&#39;</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="s1">&#39;erf&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Model</span><span class="p">(</span><span class="n">linear</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;line_&#39;</span><span class="p">))</span>
<span class="p">[[</span><span class="n">Fit</span> <span class="n">Statistics</span><span class="p">]]</span>
    <span class="c1"># function evals   = 51</span>
    <span class="c1"># data points      = 201</span>
    <span class="c1"># variables        = 5</span>
    <span class="n">chi</span><span class="o">-</span><span class="n">square</span>         <span class="o">=</span> <span class="mf">584.829</span>
    <span class="n">reduced</span> <span class="n">chi</span><span class="o">-</span><span class="n">square</span> <span class="o">=</span> <span class="mf">2.984</span>
    <span class="n">Akaike</span> <span class="n">info</span> <span class="n">crit</span>   <span class="o">=</span> <span class="mf">224.671</span>
    <span class="n">Bayesian</span> <span class="n">info</span> <span class="n">crit</span> <span class="o">=</span> <span class="mf">241.187</span>
<span class="p">[[</span><span class="n">Variables</span><span class="p">]]</span>
    <span class="n">line_slope</span><span class="p">:</span>       <span class="mf">2.03039786</span> <span class="o">+/-</span> <span class="mf">0.092221</span> <span class="p">(</span><span class="mf">4.54</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">line_intercept</span><span class="p">:</span>   <span class="mf">11.7234542</span> <span class="o">+/-</span> <span class="mf">0.274094</span> <span class="p">(</span><span class="mf">2.34</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mf">10.7816</span><span class="p">)</span>
    <span class="n">step_amplitude</span><span class="p">:</span>   <span class="mf">112.071629</span> <span class="o">+/-</span> <span class="mf">0.647316</span> <span class="p">(</span><span class="mf">0.58</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mf">134.0885</span><span class="p">)</span>
    <span class="n">step_sigma</span><span class="p">:</span>       <span class="mf">0.67132341</span> <span class="o">+/-</span> <span class="mf">0.010873</span> <span class="p">(</span><span class="mf">1.62</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mf">1.428571</span><span class="p">)</span>
    <span class="n">step_center</span><span class="p">:</span>      <span class="mf">3.12697699</span> <span class="o">+/-</span> <span class="mf">0.005151</span> <span class="p">(</span><span class="mf">0.16</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="p">[[</span><span class="n">Correlations</span><span class="p">]]</span> <span class="p">(</span><span class="n">unreported</span> <span class="n">correlations</span> <span class="n">are</span> <span class="o">&lt;</span>  <span class="mf">0.100</span><span class="p">)</span>
    <span class="n">C</span><span class="p">(</span><span class="n">line_slope</span><span class="p">,</span> <span class="n">step_amplitude</span><span class="p">)</span>  <span class="o">=</span> <span class="o">-</span><span class="mf">0.878</span>
    <span class="n">C</span><span class="p">(</span><span class="n">step_amplitude</span><span class="p">,</span> <span class="n">step_sigma</span><span class="p">)</span>  <span class="o">=</span>  <span class="mf">0.563</span>
    <span class="n">C</span><span class="p">(</span><span class="n">line_slope</span><span class="p">,</span> <span class="n">step_sigma</span><span class="p">)</span>    <span class="o">=</span> <span class="o">-</span><span class="mf">0.455</span>
    <span class="n">C</span><span class="p">(</span><span class="n">line_intercept</span><span class="p">,</span> <span class="n">step_center</span><span class="p">)</span>  <span class="o">=</span>  <span class="mf">0.427</span>
    <span class="n">C</span><span class="p">(</span><span class="n">line_slope</span><span class="p">,</span> <span class="n">line_intercept</span><span class="p">)</span>  <span class="o">=</span> <span class="o">-</span><span class="mf">0.308</span>
    <span class="n">C</span><span class="p">(</span><span class="n">line_slope</span><span class="p">,</span> <span class="n">step_center</span><span class="p">)</span>   <span class="o">=</span> <span class="o">-</span><span class="mf">0.234</span>
    <span class="n">C</span><span class="p">(</span><span class="n">line_intercept</span><span class="p">,</span> <span class="n">step_sigma</span><span class="p">)</span>  <span class="o">=</span> <span class="o">-</span><span class="mf">0.139</span>
    <span class="n">C</span><span class="p">(</span><span class="n">line_intercept</span><span class="p">,</span> <span class="n">step_amplitude</span><span class="p">)</span>  <span class="o">=</span> <span class="o">-</span><span class="mf">0.121</span>
    <span class="n">C</span><span class="p">(</span><span class="n">step_amplitude</span><span class="p">,</span> <span class="n">step_center</span><span class="p">)</span>  <span class="o">=</span>  <span class="mf">0.109</span>
</pre></div>
</div>
<p>with a plot of</p>
<a class="reference external image-reference" href="_images/models_stepfit.png"><img alt="_images/models_stepfit.png" src="_images/models_stepfit.png" style="width: 50%;" /></a>
</div>
<div class="section" id="example-3-fitting-multiple-peaks-and-using-prefixes">
<h2>Example 3: Fitting Multiple Peaks &#8211; and using Prefixes<a class="headerlink" href="#example-3-fitting-multiple-peaks-and-using-prefixes" title="Permalink to this headline">¶</a></h2>
<p>As shown above, many of the models have similar parameter names.  For
composite models, this could lead to a problem of having parameters for
different parts of the model having the same name.  To overcome this, each
<code class="xref py py-class docutils literal"><span class="pre">model.Model</span></code> can have a <code class="docutils literal"><span class="pre">prefix</span></code> attribute (normally set to a blank
string) that will be put at the beginning of each parameter name.  To
illustrate, we fit one of the classic datasets from the <a class="reference external" href="http://itl.nist.gov/div898/strd/nls/nls_main.shtml">NIST StRD</a> suite
involving a decaying exponential and two gaussians.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1">#&lt;examples/doc_nistgauss.py&gt;</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">lmfit.models</span> <span class="k">import</span> <span class="n">GaussianModel</span><span class="p">,</span> <span class="n">ExponentialModel</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">dat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;NIST_Gauss2.dat&#39;</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">dat</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">dat</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">exp_mod</span> <span class="o">=</span> <span class="n">ExponentialModel</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;exp_&#39;</span><span class="p">)</span>
<span class="n">pars</span> <span class="o">=</span> <span class="n">exp_mod</span><span class="o">.</span><span class="n">guess</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>

<span class="n">gauss1</span>  <span class="o">=</span> <span class="n">GaussianModel</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;g1_&#39;</span><span class="p">)</span>
<span class="n">pars</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">gauss1</span><span class="o">.</span><span class="n">make_params</span><span class="p">())</span>

<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;g1_center&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">105</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">125</span><span class="p">)</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;g1_sigma&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;g1_amplitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">gauss2</span>  <span class="o">=</span> <span class="n">GaussianModel</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;g2_&#39;</span><span class="p">)</span>

<span class="n">pars</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">gauss2</span><span class="o">.</span><span class="n">make_params</span><span class="p">())</span>

<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;g2_center&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">155</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">125</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">175</span><span class="p">)</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;g2_sigma&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;g2_amplitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">mod</span> <span class="o">=</span> <span class="n">gauss1</span> <span class="o">+</span> <span class="n">gauss2</span> <span class="o">+</span> <span class="n">exp_mod</span>


<span class="n">init</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">init</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>

<span class="n">out</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">pars</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>

<span class="n">comps</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">eval_components</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">fit_report</span><span class="p">(</span><span class="n">min_correl</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">out</span><span class="o">.</span><span class="n">best_fit</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">comps</span><span class="p">[</span><span class="s1">&#39;g1_&#39;</span><span class="p">],</span> <span class="s1">&#39;b--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">comps</span><span class="p">[</span><span class="s1">&#39;g2_&#39;</span><span class="p">],</span> <span class="s1">&#39;b--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">comps</span><span class="p">[</span><span class="s1">&#39;exp_&#39;</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1">#&lt;end examples/doc_nistgauss.py&gt;</span>
</pre></div>
</div>
<p>where we give a separate prefix to each model (they all have an
<code class="docutils literal"><span class="pre">amplitude</span></code> parameter).  The <code class="docutils literal"><span class="pre">prefix</span></code> values are attached transparently
to the models.</p>
<p>Note that the calls to <code class="xref py py-meth docutils literal"><span class="pre">make_param()</span></code> used the bare name, without the
prefix.  We could have used the prefixes, but because we used the
individual model <code class="docutils literal"><span class="pre">gauss1</span></code> and <code class="docutils literal"><span class="pre">gauss2</span></code>, there was no need.</p>
<p>Note also in the example here that we explicitly set bounds on many of the
parameter values.</p>
<p>The fit results printed out are:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">Model</span><span class="p">]]</span>
    <span class="p">((</span><span class="n">Model</span><span class="p">(</span><span class="n">gaussian</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;g1_&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Model</span><span class="p">(</span><span class="n">gaussian</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;g2_&#39;</span><span class="p">))</span> <span class="o">+</span> <span class="n">Model</span><span class="p">(</span><span class="n">exponential</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;exp_&#39;</span><span class="p">))</span>
<span class="p">[[</span><span class="n">Fit</span> <span class="n">Statistics</span><span class="p">]]</span>
    <span class="c1"># function evals   = 66</span>
    <span class="c1"># data points      = 250</span>
    <span class="c1"># variables        = 8</span>
    <span class="n">chi</span><span class="o">-</span><span class="n">square</span>         <span class="o">=</span> <span class="mf">1247.528</span>
    <span class="n">reduced</span> <span class="n">chi</span><span class="o">-</span><span class="n">square</span> <span class="o">=</span> <span class="mf">5.155</span>
    <span class="n">Akaike</span> <span class="n">info</span> <span class="n">crit</span>   <span class="o">=</span> <span class="mf">417.865</span>
    <span class="n">Bayesian</span> <span class="n">info</span> <span class="n">crit</span> <span class="o">=</span> <span class="mf">446.036</span>
<span class="p">[[</span><span class="n">Variables</span><span class="p">]]</span>
    <span class="n">exp_amplitude</span><span class="p">:</span>   <span class="mf">99.0183282</span> <span class="o">+/-</span> <span class="mf">0.537487</span> <span class="p">(</span><span class="mf">0.54</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mf">162.2102</span><span class="p">)</span>
    <span class="n">exp_decay</span><span class="p">:</span>       <span class="mf">90.9508859</span> <span class="o">+/-</span> <span class="mf">1.103105</span> <span class="p">(</span><span class="mf">1.21</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mf">93.24905</span><span class="p">)</span>
    <span class="n">g1_sigma</span><span class="p">:</span>        <span class="mf">16.6725753</span> <span class="o">+/-</span> <span class="mf">0.160481</span> <span class="p">(</span><span class="mf">0.96</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="n">g1_center</span><span class="p">:</span>       <span class="mf">107.030954</span> <span class="o">+/-</span> <span class="mf">0.150067</span> <span class="p">(</span><span class="mf">0.14</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mi">105</span><span class="p">)</span>
    <span class="n">g1_amplitude</span><span class="p">:</span>    <span class="mf">4257.77319</span> <span class="o">+/-</span> <span class="mf">42.38336</span> <span class="p">(</span><span class="mf">1.00</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mi">2000</span><span class="p">)</span>
    <span class="n">g1_fwhm</span><span class="p">:</span>         <span class="mf">39.2609139</span> <span class="o">+/-</span> <span class="mf">0.377905</span> <span class="p">(</span><span class="mf">0.96</span><span class="o">%</span><span class="p">)</span>  <span class="o">==</span> <span class="s1">&#39;2.3548200*g1_sigma&#39;</span>
    <span class="n">g1_height</span><span class="p">:</span>       <span class="mf">101.880231</span> <span class="o">+/-</span> <span class="mf">0.592170</span> <span class="p">(</span><span class="mf">0.58</span><span class="o">%</span><span class="p">)</span>  <span class="o">==</span> <span class="s1">&#39;0.3989423*g1_amplitude/max(1.e-15, g1_sigma)&#39;</span>
    <span class="n">g2_sigma</span><span class="p">:</span>        <span class="mf">13.8069484</span> <span class="o">+/-</span> <span class="mf">0.186794</span> <span class="p">(</span><span class="mf">1.35</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="n">g2_center</span><span class="p">:</span>       <span class="mf">153.270100</span> <span class="o">+/-</span> <span class="mf">0.194667</span> <span class="p">(</span><span class="mf">0.13</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mi">155</span><span class="p">)</span>
    <span class="n">g2_amplitude</span><span class="p">:</span>    <span class="mf">2493.41770</span> <span class="o">+/-</span> <span class="mf">36.16947</span> <span class="p">(</span><span class="mf">1.45</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mi">2000</span><span class="p">)</span>
    <span class="n">g2_fwhm</span><span class="p">:</span>         <span class="mf">32.5128782</span> <span class="o">+/-</span> <span class="mf">0.439866</span> <span class="p">(</span><span class="mf">1.35</span><span class="o">%</span><span class="p">)</span>  <span class="o">==</span> <span class="s1">&#39;2.3548200*g2_sigma&#39;</span>
    <span class="n">g2_height</span><span class="p">:</span>       <span class="mf">72.0455934</span> <span class="o">+/-</span> <span class="mf">0.617220</span> <span class="p">(</span><span class="mf">0.86</span><span class="o">%</span><span class="p">)</span>  <span class="o">==</span> <span class="s1">&#39;0.3989423*g2_amplitude/max(1.e-15, g2_sigma)&#39;</span>
<span class="p">[[</span><span class="n">Correlations</span><span class="p">]]</span> <span class="p">(</span><span class="n">unreported</span> <span class="n">correlations</span> <span class="n">are</span> <span class="o">&lt;</span>  <span class="mf">0.500</span><span class="p">)</span>
    <span class="n">C</span><span class="p">(</span><span class="n">g1_sigma</span><span class="p">,</span> <span class="n">g1_amplitude</span><span class="p">)</span>    <span class="o">=</span>  <span class="mf">0.824</span>
    <span class="n">C</span><span class="p">(</span><span class="n">g2_sigma</span><span class="p">,</span> <span class="n">g2_amplitude</span><span class="p">)</span>    <span class="o">=</span>  <span class="mf">0.815</span>
    <span class="n">C</span><span class="p">(</span><span class="n">exp_amplitude</span><span class="p">,</span> <span class="n">exp_decay</span><span class="p">)</span>  <span class="o">=</span> <span class="o">-</span><span class="mf">0.695</span>
    <span class="n">C</span><span class="p">(</span><span class="n">g1_sigma</span><span class="p">,</span> <span class="n">g2_center</span><span class="p">)</span>       <span class="o">=</span>  <span class="mf">0.684</span>
    <span class="n">C</span><span class="p">(</span><span class="n">g1_center</span><span class="p">,</span> <span class="n">g2_amplitude</span><span class="p">)</span>   <span class="o">=</span> <span class="o">-</span><span class="mf">0.669</span>
    <span class="n">C</span><span class="p">(</span><span class="n">g1_center</span><span class="p">,</span> <span class="n">g2_sigma</span><span class="p">)</span>       <span class="o">=</span> <span class="o">-</span><span class="mf">0.652</span>
    <span class="n">C</span><span class="p">(</span><span class="n">g1_amplitude</span><span class="p">,</span> <span class="n">g2_center</span><span class="p">)</span>   <span class="o">=</span>  <span class="mf">0.648</span>
    <span class="n">C</span><span class="p">(</span><span class="n">g1_center</span><span class="p">,</span> <span class="n">g2_center</span><span class="p">)</span>      <span class="o">=</span>  <span class="mf">0.621</span>
    <span class="n">C</span><span class="p">(</span><span class="n">g1_sigma</span><span class="p">,</span> <span class="n">g1_center</span><span class="p">)</span>       <span class="o">=</span>  <span class="mf">0.507</span>
    <span class="n">C</span><span class="p">(</span><span class="n">exp_decay</span><span class="p">,</span> <span class="n">g1_amplitude</span><span class="p">)</span>   <span class="o">=</span> <span class="o">-</span><span class="mf">0.507</span>
</pre></div>
</div>
<p>We get a very good fit to this problem (described at the NIST site as of
average difficulty, but the tests there are generally deliberately challenging) by
applying reasonable initial guesses and putting modest but explicit bounds
on the parameter values.  This fit is shown on the left:</p>
<blockquote id="figa3">
<div><a class="reference external image-reference" href="_images/models_nistgauss.png"><img alt="_images/models_nistgauss.png" src="_images/models_nistgauss.png" style="width: 48%;" /></a>
<a class="reference external image-reference" href="_images/models_nistgauss2.png"><img alt="_images/models_nistgauss2.png" src="_images/models_nistgauss2.png" style="width: 48%;" /></a>
</div></blockquote>
<p>One final point on setting initial values.  From looking at the data
itself, we can see the two Gaussian peaks are reasonably well separated but
do overlap. Furthermore, we can tell that the initial guess for the
decaying exponential component was poorly estimated because we used the
full data range.  We can simplify the initial parameter values by using
this, and by defining an <code class="xref py py-func docutils literal"><span class="pre">index_of()</span></code> function to limit the data range.
That is, with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">index_of</span><span class="p">(</span><span class="n">arrval</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="s2">&quot;return index of array *at or below* value &quot;</span>
    <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="nb">min</span><span class="p">(</span><span class="n">arrval</span><span class="p">):</span>  <span class="k">return</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">arrval</span><span class="o">&lt;=</span><span class="n">value</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">ix1</span> <span class="o">=</span> <span class="n">index_of</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>  <span class="mi">75</span><span class="p">)</span>
<span class="n">ix2</span> <span class="o">=</span> <span class="n">index_of</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">135</span><span class="p">)</span>
<span class="n">ix3</span> <span class="o">=</span> <span class="n">index_of</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">175</span><span class="p">)</span>

<span class="n">exp_mod</span><span class="o">.</span><span class="n">guess</span><span class="p">(</span><span class="n">y</span><span class="p">[:</span><span class="n">ix1</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">[:</span><span class="n">ix1</span><span class="p">])</span>
<span class="n">gauss1</span><span class="o">.</span><span class="n">guess</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">ix1</span><span class="p">:</span><span class="n">ix2</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">ix1</span><span class="p">:</span><span class="n">ix2</span><span class="p">])</span>
<span class="n">gauss2</span><span class="o">.</span><span class="n">guess</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">ix2</span><span class="p">:</span><span class="n">ix3</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">ix2</span><span class="p">:</span><span class="n">ix3</span><span class="p">])</span>
</pre></div>
</div>
<p>we can get a better initial estimate.  The fit converges to the same answer,
giving to identical values (to the precision printed out in the report),
but in few steps, and without any bounds on parameters at all:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">Model</span><span class="p">]]</span>
    <span class="p">((</span><span class="n">Model</span><span class="p">(</span><span class="n">gaussian</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;g1_&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Model</span><span class="p">(</span><span class="n">gaussian</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;g2_&#39;</span><span class="p">))</span> <span class="o">+</span>  <span class="n">Model</span><span class="p">(</span><span class="n">exponential</span><span class="p">,</span>  <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;exp_&#39;</span><span class="p">))</span>
<span class="p">[[</span><span class="n">Fit</span> <span class="n">Statistics</span><span class="p">]]</span>
    <span class="c1"># function evals   = 48</span>
    <span class="c1"># data points      = 250</span>
    <span class="c1"># variables        = 8</span>
    <span class="n">chi</span><span class="o">-</span><span class="n">square</span>         <span class="o">=</span> <span class="mf">1247.528</span>
    <span class="n">reduced</span> <span class="n">chi</span><span class="o">-</span><span class="n">square</span> <span class="o">=</span> <span class="mf">5.155</span>
    <span class="n">Akaike</span> <span class="n">info</span> <span class="n">crit</span>   <span class="o">=</span> <span class="mf">417.865</span>
    <span class="n">Bayesian</span> <span class="n">info</span> <span class="n">crit</span> <span class="o">=</span> <span class="mf">446.036</span>
<span class="p">[[</span><span class="n">Variables</span><span class="p">]]</span>
    <span class="n">exp_amplitude</span><span class="p">:</span>   <span class="mf">99.0183281</span> <span class="o">+/-</span> <span class="mf">0.537487</span> <span class="p">(</span><span class="mf">0.54</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mf">94.53724</span><span class="p">)</span>
    <span class="n">exp_decay</span><span class="p">:</span>       <span class="mf">90.9508862</span> <span class="o">+/-</span> <span class="mf">1.103105</span> <span class="p">(</span><span class="mf">1.21</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mf">111.1985</span><span class="p">)</span>
    <span class="n">g1_sigma</span><span class="p">:</span>        <span class="mf">16.6725754</span> <span class="o">+/-</span> <span class="mf">0.160481</span> <span class="p">(</span><span class="mf">0.96</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mf">14.5</span><span class="p">)</span>
    <span class="n">g1_center</span><span class="p">:</span>       <span class="mf">107.030954</span> <span class="o">+/-</span> <span class="mf">0.150067</span> <span class="p">(</span><span class="mf">0.14</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mf">106.5</span><span class="p">)</span>
    <span class="n">g1_amplitude</span><span class="p">:</span>    <span class="mf">4257.77322</span> <span class="o">+/-</span> <span class="mf">42.38338</span> <span class="p">(</span><span class="mf">1.00</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mf">2126.432</span><span class="p">)</span>
    <span class="n">g1_fwhm</span><span class="p">:</span>         <span class="mf">39.2609141</span> <span class="o">+/-</span> <span class="mf">0.377905</span> <span class="p">(</span><span class="mf">0.96</span><span class="o">%</span><span class="p">)</span>  <span class="o">==</span> <span class="s1">&#39;2.3548200*g1_sigma&#39;</span>
    <span class="n">g1_height</span><span class="p">:</span>       <span class="mf">101.880231</span> <span class="o">+/-</span> <span class="mf">0.592171</span> <span class="p">(</span><span class="mf">0.58</span><span class="o">%</span><span class="p">)</span>  <span class="o">==</span> <span class="s1">&#39;0.3989423*g1_amplitude/max(1.e-15, g1_sigma)&#39;</span>
    <span class="n">g2_sigma</span><span class="p">:</span>        <span class="mf">13.8069481</span> <span class="o">+/-</span> <span class="mf">0.186794</span> <span class="p">(</span><span class="mf">1.35</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="n">g2_center</span><span class="p">:</span>       <span class="mf">153.270100</span> <span class="o">+/-</span> <span class="mf">0.194667</span> <span class="p">(</span><span class="mf">0.13</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mi">150</span><span class="p">)</span>
    <span class="n">g2_amplitude</span><span class="p">:</span>    <span class="mf">2493.41766</span> <span class="o">+/-</span> <span class="mf">36.16948</span> <span class="p">(</span><span class="mf">1.45</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mf">1878.892</span><span class="p">)</span>
    <span class="n">g2_fwhm</span><span class="p">:</span>         <span class="mf">32.5128777</span> <span class="o">+/-</span> <span class="mf">0.439866</span> <span class="p">(</span><span class="mf">1.35</span><span class="o">%</span><span class="p">)</span>  <span class="o">==</span> <span class="s1">&#39;2.3548200*g2_sigma&#39;</span>
    <span class="n">g2_height</span><span class="p">:</span>       <span class="mf">72.0455935</span> <span class="o">+/-</span> <span class="mf">0.617221</span> <span class="p">(</span><span class="mf">0.86</span><span class="o">%</span><span class="p">)</span>  <span class="o">==</span> <span class="s1">&#39;0.3989423*g2_amplitude/max(1.e-15, g2_sigma)&#39;</span>
<span class="p">[[</span><span class="n">Correlations</span><span class="p">]]</span> <span class="p">(</span><span class="n">unreported</span> <span class="n">correlations</span> <span class="n">are</span> <span class="o">&lt;</span>  <span class="mf">0.500</span><span class="p">)</span>
    <span class="n">C</span><span class="p">(</span><span class="n">g1_sigma</span><span class="p">,</span> <span class="n">g1_amplitude</span><span class="p">)</span>    <span class="o">=</span>  <span class="mf">0.824</span>
    <span class="n">C</span><span class="p">(</span><span class="n">g2_sigma</span><span class="p">,</span> <span class="n">g2_amplitude</span><span class="p">)</span>    <span class="o">=</span>  <span class="mf">0.815</span>
    <span class="n">C</span><span class="p">(</span><span class="n">exp_amplitude</span><span class="p">,</span> <span class="n">exp_decay</span><span class="p">)</span>  <span class="o">=</span> <span class="o">-</span><span class="mf">0.695</span>
    <span class="n">C</span><span class="p">(</span><span class="n">g1_sigma</span><span class="p">,</span> <span class="n">g2_center</span><span class="p">)</span>       <span class="o">=</span>  <span class="mf">0.684</span>
    <span class="n">C</span><span class="p">(</span><span class="n">g1_center</span><span class="p">,</span> <span class="n">g2_amplitude</span><span class="p">)</span>   <span class="o">=</span> <span class="o">-</span><span class="mf">0.669</span>
    <span class="n">C</span><span class="p">(</span><span class="n">g1_center</span><span class="p">,</span> <span class="n">g2_sigma</span><span class="p">)</span>       <span class="o">=</span> <span class="o">-</span><span class="mf">0.652</span>
    <span class="n">C</span><span class="p">(</span><span class="n">g1_amplitude</span><span class="p">,</span> <span class="n">g2_center</span><span class="p">)</span>   <span class="o">=</span>  <span class="mf">0.648</span>
    <span class="n">C</span><span class="p">(</span><span class="n">g1_center</span><span class="p">,</span> <span class="n">g2_center</span><span class="p">)</span>      <span class="o">=</span>  <span class="mf">0.621</span>
    <span class="n">C</span><span class="p">(</span><span class="n">g1_sigma</span><span class="p">,</span> <span class="n">g1_center</span><span class="p">)</span>       <span class="o">=</span>  <span class="mf">0.507</span>
    <span class="n">C</span><span class="p">(</span><span class="n">exp_decay</span><span class="p">,</span> <span class="n">g1_amplitude</span><span class="p">)</span>   <span class="o">=</span> <span class="o">-</span><span class="mf">0.507</span>
</pre></div>
</div>
<p>This script is in the file <code class="docutils literal"><span class="pre">doc_nistgauss2.py</span></code> in the examples folder,
and the fit result shown on the right above shows an improved initial
estimate of the data.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="confidence.html" title="Calculation of confidence intervals"
             >next</a> |</li>
        <li class="right" >
          <a href="model.html" title="Modeling Data and Curve Fitting"
             >previous</a> |</li>
   <li>[<a href="intro.html">intro</a>|</li>
   <li><a href="parameters.html">parameters</a>|</li>
   <li><a href="fitting.html"> minimize</a>|</li>
   <li><a href="model.html"> model</a>|</li>
   <li><a href="#"> builtin models</a>|</li>
   <li><a href="confidence.html">confidence intervals</a>|</li>
   <li><a href="bounds.html">bounds</a>|</li>
   <li><a href="constraints.html">constraints</a>]</li>
 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Matthew Newville, The University of Chicago, Till Stensitzki, Freie Universitat Berlin.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.1.
    </div>
  </body>
</html>