<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Modeling Data and Curve Fitting &#8212; Non-Linear Least-Squares Minimization and Curve-Fitting for Python</title>
    
    <link rel="stylesheet" href="_static/lmfitdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.9.6rc1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Built-in Fitting Models in the models module" href="builtin_models.html" />
    <link rel="prev" title="Performing Fits, Analyzing Outputs" href="fitting.html" />
  <script type="text/x-mathjax-config">
     MathJax.Hub.Config({
        "TeX": {Macros: {AA : "{\\unicode{x212B}}"}},
        "HTML-CSS": {scale: 90}
  });</script>

  </head>
  <body role="document">
<div>
<table border=0>
  <tr><td></td><td width=85% padding=5 align=left>
       <a href="index.html" style="color: #157"> <font size=+3>LMFIT</font></a>
     </td>
     <td width=7% align=left>
         <a href="contents.html" style="color: #882222">
         <font size+=1>Contents</font></a> </td>
     <td width=7% align=left>
          <a href="installation.html" style="color: #882222">
          <font size+=1>Download</font></a></td>
     <td></td>
  </tr>
  <tr><td></td><td width=75% padding=5 align=left>
        <a href="index.html" style="color: #157"> <font size=+2>
	Non-Linear Least-Squares Minimization and Curve-Fitting for Python</font></a>
     </td>
     <td width=7% align=left>
         <a href="faq.html" style="color: #882222">
         <font size+=1>FAQ</font></a> </td>
     <td width=7% align=left>
        <a href="https://github.com/lmfit/lmfit-py/" style="color: #882222">
         <font size+=1>Develop</font></a></td>
     <td></td>
  </tr>
</table>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="builtin_models.html" title="Built-in Fitting Models in the models module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="fitting.html" title="Performing Fits, Analyzing Outputs"
             accesskey="P">previous</a> |</li>
   <li>[<a href="intro.html">intro</a>|</li>
   <li><a href="parameters.html">parameters</a>|</li>
   <li><a href="fitting.html"> minimize</a>|</li>
   <li><a href="#"> model</a>|</li>
   <li><a href="builtin_models.html"> builtin models</a>|</li>
   <li><a href="confidence.html">confidence intervals</a>|</li>
   <li><a href="bounds.html">bounds</a>|</li>
   <li><a href="constraints.html">constraints</a>]</li>
 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Modeling Data and Curve Fitting</a><ul>
<li><a class="reference internal" href="#motivation-and-simple-example-fit-data-to-gaussian-profile">Motivation and simple example: Fit data to Gaussian profile</a></li>
<li><a class="reference internal" href="#the-model-class">The <code class="docutils literal"><span class="pre">Model</span></code> class</a><ul>
<li><a class="reference internal" href="#model-class-methods"><code class="docutils literal"><span class="pre">Model</span></code> class Methods</a></li>
<li><a class="reference internal" href="#model-class-attributes"><code class="docutils literal"><span class="pre">Model</span></code> class Attributes</a></li>
<li><a class="reference internal" href="#determining-parameter-names-and-independent-variables-for-a-function">Determining parameter names and independent variables for a function</a></li>
<li><a class="reference internal" href="#explicitly-specifying-independent-vars">Explicitly specifying <code class="docutils literal"><span class="pre">independent_vars</span></code></a></li>
<li><a class="reference internal" href="#functions-with-keyword-arguments">Functions with keyword arguments</a></li>
<li><a class="reference internal" href="#defining-a-prefix-for-the-parameters">Defining a <code class="docutils literal"><span class="pre">prefix</span></code> for the Parameters</a></li>
<li><a class="reference internal" href="#initializing-model-parameters">Initializing model parameters</a><ul>
<li><a class="reference internal" href="#initializing-values-in-the-function-definition">Initializing values in the function definition</a></li>
<li><a class="reference internal" href="#initializing-values-with-model-make-params">Initializing values with <code class="docutils literal"><span class="pre">Model.make_params()</span></code></a></li>
<li><a class="reference internal" href="#initializing-values-by-setting-parameter-hints">Initializing values by setting parameter hints</a></li>
<li><a class="reference internal" href="#initializing-values-when-using-a-model">Initializing values when using a model</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-parameter-hints">Using parameter hints</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-modelresult-class">The <code class="docutils literal"><span class="pre">ModelResult</span></code> class</a><ul>
<li><a class="reference internal" href="#modelresult-methods"><code class="docutils literal"><span class="pre">ModelResult</span></code> methods</a></li>
<li><a class="reference internal" href="#modelresult-attributes"><code class="docutils literal"><span class="pre">ModelResult</span></code> attributes</a></li>
<li><a class="reference internal" href="#calculating-uncertainties-in-the-model-function">Calculating uncertainties in the model function</a></li>
</ul>
</li>
<li><a class="reference internal" href="#composite-models-adding-or-multiplying-models">Composite Models : adding (or multiplying) Models</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="fitting.html"
                        title="previous chapter">Performing Fits, Analyzing Outputs</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="builtin_models.html"
                        title="next chapter">Built-in Fitting Models in the <code class="docutils literal"><span class="pre">models</span></code> module</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/model.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-lmfit.model">
<span id="modeling-data-and-curve-fitting"></span><span id="model-chapter"></span><h1>Modeling Data and Curve Fitting<a class="headerlink" href="#module-lmfit.model" title="Permalink to this headline">¶</a></h1>
<p>A common use of least-squares minimization is <em>curve fitting</em>, where one
has a parametrized model function meant to explain some phenomena and wants
to adjust the numerical values for the model so that it most closely
matches some data.  With <code class="xref py py-mod docutils literal"><span class="pre">scipy</span></code>, such problems are typically solved
with <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html">scipy.optimize.curve_fit</a>, which is a wrapper around
<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.leastsq.html">scipy.optimize.leastsq</a>.  Since lmfit&#8217;s
<a class="reference internal" href="fitting.html#lmfit.minimizer.minimize" title="lmfit.minimizer.minimize"><code class="xref py py-func docutils literal"><span class="pre">minimize()</span></code></a> is also a high-level wrapper around
<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.leastsq.html">scipy.optimize.leastsq</a> it can be used for curve-fitting problems.
While it offers many benefits over <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.leastsq.html">scipy.optimize.leastsq</a>, using
<a class="reference internal" href="fitting.html#lmfit.minimizer.minimize" title="lmfit.minimizer.minimize"><code class="xref py py-func docutils literal"><span class="pre">minimize()</span></code></a> for many curve-fitting problems still
requires more effort than using <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html">scipy.optimize.curve_fit</a>.</p>
<p>The <a class="reference internal" href="#lmfit.model.Model" title="lmfit.model.Model"><code class="xref py py-class docutils literal"><span class="pre">Model</span></code></a> class in lmfit provides a simple and flexible approach
to curve-fitting problems.  Like scipydoc:<cite>optimize.curve_fit</cite>, a
<a class="reference internal" href="#lmfit.model.Model" title="lmfit.model.Model"><code class="xref py py-class docutils literal"><span class="pre">Model</span></code></a> uses a <em>model function</em> &#8211; a function that is meant to
calculate a model for some phenomenon &#8211; and then` uses that to best match
an array of supplied data.  Beyond that similarity, its interface is rather
different from scipydoc:<cite>optimize.curve_fit</cite>, for example in that it uses
<a class="reference internal" href="parameters.html#lmfit.parameter.Parameters" title="lmfit.parameter.Parameters"><code class="xref py py-class docutils literal"><span class="pre">Parameters</span></code></a>, but also offers several other
important advantages.</p>
<p>In addition to allowing you turn any model function into a curve-fitting
method, lmfit also provides canonical definitions for many known line shapes
such as Gaussian or Lorentzian peaks and Exponential decays that are widely
used in many scientific domains.  These are available in the <code class="xref py py-mod docutils literal"><span class="pre">models</span></code>
module that will be discussed in more detail in the next chapter
(<a class="reference internal" href="builtin_models.html#builtin-models-chapter"><span class="std std-ref">Built-in Fitting Models in the models module</span></a>).  We mention it here as you may want to
consult that list before writing your own model.  For now, we focus on
turning python function into high-level fitting models with the
<a class="reference internal" href="#lmfit.model.Model" title="lmfit.model.Model"><code class="xref py py-class docutils literal"><span class="pre">Model</span></code></a> class, and using these to fit data.</p>
<div class="section" id="motivation-and-simple-example-fit-data-to-gaussian-profile">
<h2>Motivation and simple example: Fit data to Gaussian profile<a class="headerlink" href="#motivation-and-simple-example-fit-data-to-gaussian-profile" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s start with a simple and common example of fitting data to a Gaussian
peak.  As we will see, there is a buit-in <code class="xref py py-class docutils literal"><span class="pre">GaussianModel</span></code> class that
can help do this, but here we&#8217;ll build our own.  We start with a simple
definition of the model function:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">linspace</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">gaussian</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">amp</span><span class="p">,</span> <span class="n">cen</span><span class="p">,</span> <span class="n">wid</span><span class="p">):</span>
<span class="gp">... </span>   <span class="k">return</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">cen</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span><span class="n">wid</span><span class="p">)</span>
<span class="gp">...</span>
</pre></div>
</div>
<p>We want to use this function to fit to data <span class="math">\(y(x)\)</span> represented by the
arrays <code class="docutils literal"><span class="pre">y</span></code> and <code class="docutils literal"><span class="pre">x</span></code>.  With <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html">scipy.optimize.curve_fit</a>, this would be:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="k">import</span> <span class="n">curve_fit</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">=</span> <span class="n">gaussian</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">2.33</span><span class="p">,</span> <span class="mf">0.21</span><span class="p">,</span> <span class="mf">1.51</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">init_vals</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>     <span class="c1"># for [amp, cen, wid]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">best_vals</span><span class="p">,</span> <span class="n">covar</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">gaussian</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">init_vals</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">best_vals</span>
</pre></div>
</div>
<p>That is, we create data, make an initial guess of the model values, and run
<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html">scipy.optimize.curve_fit</a> with the model function, data arrays, and
initial guesses.  The results returned are the optimal values for the
parameters and the covariance matrix.  It&#8217;s simple and useful, but it
misses the benefits of lmfit.</p>
<p>With lmfit, we create a <a class="reference internal" href="#lmfit.model.Model" title="lmfit.model.Model"><code class="xref py py-class docutils literal"><span class="pre">Model</span></code></a> that wraps the <code class="docutils literal"><span class="pre">gaussian</span></code> model
function, which automatically generate the appropriate residual function,
and determines the corresponding parameter names from the function
signature itself:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">lmfit</span> <span class="k">import</span> <span class="n">Model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gmodel</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">gaussian</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gmodel</span><span class="o">.</span><span class="n">param_names</span>
<span class="go">set([&#39;amp&#39;, &#39;wid&#39;, &#39;cen&#39;])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gmodel</span><span class="o">.</span><span class="n">independent_vars</span><span class="p">)</span>
<span class="go">[&#39;x&#39;]</span>
</pre></div>
</div>
<p>As you can see, the Model <code class="docutils literal"><span class="pre">gmodel</span></code> determined the names of the parameters
and the independent variables.  By default, the first argument of the
function is taken as the independent variable, held in
<a class="reference internal" href="#lmfit.model.independent_vars" title="lmfit.model.independent_vars"><code class="xref py py-attr docutils literal"><span class="pre">independent_vars</span></code></a>, and the rest of the functions positional
arguments (and, in certain cases, keyword arguments &#8211; see below) are used
for Parameter names.  Thus, for the <code class="docutils literal"><span class="pre">gaussian</span></code> function above, the
independent variable is <code class="docutils literal"><span class="pre">x</span></code>, and the parameters are named <code class="docutils literal"><span class="pre">amp</span></code>,
<code class="docutils literal"><span class="pre">cen</span></code>, and <code class="docutils literal"><span class="pre">wid</span></code>, and &#8211; all taken directly from the signature of the
model function. As we will see below, you can modify these default
determination of what is the independent variable is and which function
arguments should be identified as parameter names.</p>
<p>The Parameters are <em>not</em> created when the model is created. The model knows
what the parameters should be named, but not anything about the scale and
range of your data.  You will normally have to make these parameters and
assign initial values and other attributes.  To help you do this, each
model has a <code class="xref py py-meth docutils literal"><span class="pre">make_params()</span></code> method that will generate parameters with
the expected names:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="n">gmod</span><span class="o">.</span><span class="n">make_params</span><span class="p">()</span>
</pre></div>
</div>
<p>This creates the <a class="reference internal" href="parameters.html#lmfit.parameter.Parameters" title="lmfit.parameter.Parameters"><code class="xref py py-class docutils literal"><span class="pre">Parameters</span></code></a> but does not
automaticaly give them initial values since it has no idea what the scale
should be.  You can set initial values for parameters with keyword
arguments to <code class="xref py py-meth docutils literal"><span class="pre">make_params()</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="n">gmod</span><span class="o">.</span><span class="n">make_params</span><span class="p">(</span><span class="n">cen</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">wid</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>or assign them (and other parameter properties) after the
<a class="reference internal" href="parameters.html#lmfit.parameter.Parameters" title="lmfit.parameter.Parameters"><code class="xref py py-class docutils literal"><span class="pre">Parameters</span></code></a> has been created.</p>
<p>A <a class="reference internal" href="#lmfit.model.Model" title="lmfit.model.Model"><code class="xref py py-class docutils literal"><span class="pre">Model</span></code></a> has several methods associated with it.  For example, one
can use the <code class="xref py py-meth docutils literal"><span class="pre">eval()</span></code> method to evaluate the model or the <code class="xref py py-meth docutils literal"><span class="pre">fit()</span></code>
method to fit data to this model with a <code class="xref py py-class docutils literal"><span class="pre">Parameter</span></code> object.  Both of
these methods can take explicit keyword arguments for the parameter values.
For example, one could use <code class="xref py py-meth docutils literal"><span class="pre">eval()</span></code> to calculate the predicted
function:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">201</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">gmod</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>or with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">gmod</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">cen</span><span class="o">=</span><span class="mf">6.5</span><span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">wid</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</pre></div>
</div>
<p>Admittedly, this a slightly long-winded way to calculate a Gaussian
function, given that you could have called your <code class="docutils literal"><span class="pre">gaussian</span></code> function
directly.  But now that the model is set up, we can use its
<code class="xref py py-meth docutils literal"><span class="pre">fit()</span></code> method to fit this model to data, as with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">gmod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
<p>or with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">gmod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">cen</span><span class="o">=</span><span class="mf">6.5</span><span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">wid</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</pre></div>
</div>
<p>Putting everything together,  (included in the
<code class="docutils literal"><span class="pre">examples</span></code> folder with the source code) is:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1">#&lt;examples/doc_model1.py&gt;</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">linspace</span><span class="p">,</span> <span class="n">loadtxt</span>
<span class="kn">from</span> <span class="nn">lmfit</span> <span class="k">import</span>  <span class="n">Model</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;model1d_gauss.dat&#39;</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">gaussian</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">amp</span><span class="p">,</span> <span class="n">cen</span><span class="p">,</span> <span class="n">wid</span><span class="p">):</span>
    <span class="s2">&quot;1-d gaussian: gaussian(x, amp, cen, wid)&quot;</span>
    <span class="k">return</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">cen</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span><span class="n">wid</span><span class="p">)</span>

<span class="n">gmodel</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">gaussian</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">gmodel</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">cen</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">wid</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">fit_report</span><span class="p">())</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>         <span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">init_fit</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">best_fit</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1">#&lt;end examples/doc_model1.py&gt;</span>
</pre></div>
</div>
<p>which is pretty compact and to the point.  The returned <code class="docutils literal"><span class="pre">result</span></code> will be
a <a class="reference internal" href="#lmfit.model.ModelResult" title="lmfit.model.ModelResult"><code class="xref py py-class docutils literal"><span class="pre">ModelResult</span></code></a> object.  As we will see below, this has many
components, including a <code class="xref py py-meth docutils literal"><span class="pre">fit_report()</span></code> method, which will show:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">Model</span><span class="p">]]</span>
    <span class="n">Model</span><span class="p">(</span><span class="n">gaussian</span><span class="p">)</span>
<span class="p">[[</span><span class="n">Fit</span> <span class="n">Statistics</span><span class="p">]]</span>
    <span class="c1"># function evals   = 31</span>
    <span class="c1"># data points      = 101</span>
    <span class="c1"># variables        = 3</span>
    <span class="n">chi</span><span class="o">-</span><span class="n">square</span>         <span class="o">=</span> <span class="mf">3.409</span>
    <span class="n">reduced</span> <span class="n">chi</span><span class="o">-</span><span class="n">square</span> <span class="o">=</span> <span class="mf">0.035</span>
    <span class="n">Akaike</span> <span class="n">info</span> <span class="n">crit</span>   <span class="o">=</span> <span class="o">-</span><span class="mf">336.264</span>
    <span class="n">Bayesian</span> <span class="n">info</span> <span class="n">crit</span> <span class="o">=</span> <span class="o">-</span><span class="mf">328.418</span>
<span class="p">[[</span><span class="n">Variables</span><span class="p">]]</span>
    <span class="n">amp</span><span class="p">:</span>   <span class="mf">5.07800631</span> <span class="o">+/-</span> <span class="mf">0.064957</span> <span class="p">(</span><span class="mf">1.28</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">cen</span><span class="p">:</span>   <span class="mf">5.65866112</span> <span class="o">+/-</span> <span class="mf">0.010304</span> <span class="p">(</span><span class="mf">0.18</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">wid</span><span class="p">:</span>   <span class="mf">0.97344373</span> <span class="o">+/-</span> <span class="mf">0.028756</span> <span class="p">(</span><span class="mf">2.95</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">[[</span><span class="n">Correlations</span><span class="p">]]</span> <span class="p">(</span><span class="n">unreported</span> <span class="n">correlations</span> <span class="n">are</span> <span class="o">&lt;</span>  <span class="mf">0.100</span><span class="p">)</span>
    <span class="n">C</span><span class="p">(</span><span class="n">amp</span><span class="p">,</span> <span class="n">wid</span><span class="p">)</span>                  <span class="o">=</span> <span class="o">-</span><span class="mf">0.577</span>
</pre></div>
</div>
<p>As the script shows, the result will also have <a class="reference internal" href="#lmfit.model.init_fit" title="lmfit.model.init_fit"><code class="xref py py-attr docutils literal"><span class="pre">init_fit</span></code></a> for the fit
with the initial parameter values and a <a class="reference internal" href="#lmfit.model.best_fit" title="lmfit.model.best_fit"><code class="xref py py-attr docutils literal"><span class="pre">best_fit</span></code></a> for the fit with
the best fit parameter values.  These can be used to generate the following
plot:</p>
<a class="reference external image-reference" href="_images/model_fit1.png"><img alt="_images/model_fit1.png" src="_images/model_fit1.png" style="width: 50%;" /></a>
<p>which shows the data in blue dots, the best fit as a solid red line, and
the initial fit as a dashed black line.</p>
<p>Note that the model fitting was really performed with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">gmodel</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">gaussian</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">gmodel</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">cen</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">wid</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>These lines clearly express that we want to turn the <code class="docutils literal"><span class="pre">gaussian</span></code> function
into a fitting model, and then fit the <span class="math">\(y(x)\)</span> data to this model,
starting with values of 5 for <code class="docutils literal"><span class="pre">amp</span></code>, 5 for <code class="docutils literal"><span class="pre">cen</span></code> and 1 for <code class="docutils literal"><span class="pre">wid</span></code>.  In
addition, all the other features of lmfit are included:
<a class="reference internal" href="parameters.html#lmfit.parameter.Parameters" title="lmfit.parameter.Parameters"><code class="xref py py-class docutils literal"><span class="pre">Parameters</span></code></a> can have bounds and constraints and
the result is a rich object that can be reused to explore the model fit in
detail.</p>
</div>
<div class="section" id="the-model-class">
<h2>The <a class="reference internal" href="#lmfit.model.Model" title="lmfit.model.Model"><code class="xref py py-class docutils literal"><span class="pre">Model</span></code></a> class<a class="headerlink" href="#the-model-class" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="#lmfit.model.Model" title="lmfit.model.Model"><code class="xref py py-class docutils literal"><span class="pre">Model</span></code></a> class provides a general way to wrap a pre-defined
function as a fitting model.</p>
<dl class="class">
<dt id="lmfit.model.Model">
<em class="property">class </em><code class="descname">Model</code><span class="sig-paren">(</span><em>func</em>, <em>independent_vars=None</em>, <em>param_names=None</em>, <em>missing='none'</em>, <em>prefix=''</em>, <em>name=None</em>, <em>**kws</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.model.Model" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a model from a user-supplied model function that returns an
array of data to model some data as for a curve-fitting problem.</p>
<p>The model function will normally take an independent variable (generally,
the first argument) and a series of arguments that are meant to be parameters
for the model.  Thus, a simple peak using a Gaussian defined as</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">gaussian</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">amp</span><span class="p">,</span> <span class="n">cen</span><span class="p">,</span> <span class="n">wid</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">cen</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">wid</span><span class="p">)</span>
</pre></div>
</div>
<p>can be turned into a Model with</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gmodel</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">gaussian</span><span class="p">)</span>
</pre></div>
</div>
<p>this will automatically discover the names of the independent variables and parameters:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">gmodel</span><span class="o">.</span><span class="n">param_names</span><span class="p">,</span> <span class="n">gmodel</span><span class="o">.</span><span class="n">independent_vars</span><span class="p">)</span>
<span class="go">[&#39;amp&#39;, &#39;cen&#39;, &#39;wid&#39;], [&#39;x&#39;]</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="#lmfit.model.Model.make_params" title="lmfit.model.Model.make_params"><code class="xref py py-meth docutils literal"><span class="pre">make_params()</span></code></a> method will create a Parameters object for this model, optionally
taking initial values:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="n">gmodel</span><span class="o">.</span><span class="n">make_params</span><span class="p">(</span><span class="n">amp</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cen</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">wid</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>You can also use <a class="reference internal" href="#lmfit.model.Model.set_param_hint" title="lmfit.model.Model.set_param_hint"><code class="xref py py-meth docutils literal"><span class="pre">set_param_hint()</span></code></a> to set default attributes for the parameters
created, so that doing</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gmodel</span><span class="o">.</span><span class="n">set_param_hint</span><span class="p">(</span><span class="s1">&#39;wid&#39;</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
</pre></div>
</div>
<p>would set a bound on the &#8216;wid&#8217; Parameter created by <a class="reference internal" href="#lmfit.model.Model.make_params" title="lmfit.model.Model.make_params"><code class="xref py py-meth docutils literal"><span class="pre">make_params()</span></code></a>.</p>
<p>A model and corresponding Parameters can be used to evaluate the model for a given
input array (or single value) of independent variables with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yinit</span> <span class="o">=</span> <span class="n">gmodel</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">xdata</span><span class="p">)</span>
</pre></div>
</div>
<p>and can be used to fit the Parameters to match an array of data:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">gmodel</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ydata</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">xdata</span><span class="p">)</span>
</pre></div>
</div>
<p>which will return a <cite>ModelResult</cite> object.</p>
<p>Models can be combined into a <cite>CompositeModel</cite> by adding (or
multiplying, subtracting, or dividing) two or models.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>func</strong> (<em>function to be wrapped</em>) &#8211; </li>
<li><strong>independent_vars</strong> (list of strings or <code class="docutils literal"><span class="pre">None</span></code> (default)) &#8211; arguments to func that are independent variables</li>
<li><strong>param_names</strong> (list of strings or <code class="docutils literal"><span class="pre">None</span></code> (default)) &#8211; names of arguments to func that are to be made into parameters</li>
<li><strong>missing</strong> (<code class="docutils literal"><span class="pre">None</span></code> or string) &#8211; <p>how to handle <cite>nan</cite> and missing values in data. One of:</p>
<ul>
<li>&#8216;none&#8217; or <code class="docutils literal"><span class="pre">None</span></code>: Do not check for null or missing values (default)</li>
<li>&#8216;drop&#8217;: Drop null or missing observations in data. if pandas is
installed, <cite>pandas.isnull</cite> is used, otherwise <cite>numpy.isnan</cite> is used.</li>
<li><dl class="first docutils">
<dt>&#8216;raise&#8217;: Raise a (more helpful) exception when data contains null</dt>
<dd>or missing values.</dd>
</dl>
</li>
</ul>
</li>
<li><strong>name</strong> (<code class="docutils literal"><span class="pre">None</span></code> or string) &#8211; name for the model. When <code class="docutils literal"><span class="pre">None</span></code> (default) the name is the same as
the model function (<cite>func</cite>).</li>
<li><strong>kws</strong> (<em>optional dict</em>) &#8211; additional keyword arguments to pass to model function.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>1. Parameter names are inferred from the function arguments,
and a residual function is automatically constructed.</p>
<p>2. The model function must return an array that will be the same
size as the data being modeled.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">decay</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">N</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="o">/</span><span class="n">tau</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">decay</span><span class="p">,</span> <span class="n">independent_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<div class="section" id="model-class-methods">
<h3><a class="reference internal" href="#lmfit.model.Model" title="lmfit.model.Model"><code class="xref py py-class docutils literal"><span class="pre">Model</span></code></a> class Methods<a class="headerlink" href="#model-class-methods" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="lmfit.model.Model.eval">
<code class="descclassname">Model.</code><code class="descname">eval</code><span class="sig-paren">(</span><em>params=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.model.Model.eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the model with the supplied parameters and keyword arguments</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>params</strong> (Parameters or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; parameters to use in Model</li>
<li><strong>kwargs</strong> (<em>optional</em>) &#8211; keyword arguments to pass to model function.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>val</strong> &#8211; value of model given the parameters and other arguments.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>1. if <cite>params</cite> is <code class="docutils literal"><span class="pre">None</span></code>, the values for all parameters are
expected to be provided as keyword arguments.  If <cite>params</cite> is
given, and a keyword argument for a parameter value is also given,
the keyword argument will be used.</p>
<p>2. all non-parameter arguments for the model function, <strong>including
all the independent variables</strong> will need to be passed in using
keyword arguments.</p>
</dd></dl>

<dl class="method">
<dt id="lmfit.model.Model.fit">
<code class="descclassname">Model.</code><code class="descname">fit</code><span class="sig-paren">(</span><em>data</em>, <em>params=None</em>, <em>weights=None</em>, <em>method='leastsq'</em>, <em>iter_cb=None</em>, <em>scale_covar=True</em>, <em>verbose=False</em>, <em>fit_kws=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.model.Model.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the model to the data using the supplied Parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>array-like</em>) &#8211; array of data to be fig.</li>
<li><strong>params</strong> (Parameters or <code class="docutils literal"><span class="pre">None</span></code> (default)) &#8211; parameters to use in fit.</li>
<li><strong>weights</strong> (array-like of same size as data or <code class="docutils literal"><span class="pre">None</span></code> (default)) &#8211; weights to use for the calculation of the fit residual.</li>
<li><strong>method</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a><em>  (</em><em>default = 'leastsq'</em><em>)</em><em></em>) &#8211; name of fitting method to use</li>
<li><strong>iter_cb</strong> (callable or <code class="docutils literal"><span class="pre">None</span></code> (default)) &#8211; callback function to call at each iteration.</li>
<li><strong>scale_covar</strong> (bool (default <code class="docutils literal"><span class="pre">True</span></code>)) &#8211; whether to automatically scale the covariance matrix when calculating
uncertainties. <cite>leastsq</cite> method only.</li>
<li><strong>verbose</strong> (bool (default <code class="docutils literal"><span class="pre">True</span></code>)) &#8211; whether to print a message when a new parameter is added because of a hint.</li>
<li><strong>fit_kws</strong> (dict or <code class="docutils literal"><span class="pre">None</span></code> (default)) &#8211; default fitting options, such as xtol and maxfev, for scipy optimizer</li>
<li><strong>kwargs</strong> (<em>optional</em>) &#8211; arguments to pass to the  model function, possibly overriding params</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">lmfit.ModelResult</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>Take t to be the independent variable and data to be the curve we will fit.
Use keyword arguments to set initial guesses:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
<p>Or, for more control, pass a Parameters object.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
<p>Keyword arguments override Parameters.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>1. if <cite>params</cite> is <code class="docutils literal"><span class="pre">None</span></code>, the values for all parameters are
expected to be provided as keyword arguments.  If <cite>params</cite> is
given, and a keyword argument for a parameter value is also given,
the keyword argument will be used.</p>
<p>2. all non-parameter arguments for the model function, <strong>including
all the independent variables</strong> will need to be passed in using
keyword arguments.</p>
<p>3. Parameters (however passed in), are copied on input, so the
original Parameter objects are unchanged, and the updated values
are in the returned <cite>ModelResult</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="lmfit.model.Model.guess">
<code class="descclassname">Model.</code><code class="descname">guess</code><span class="sig-paren">(</span><em>data</em>, <em>**kws</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.model.Model.guess" title="Permalink to this definition">¶</a></dt>
<dd><p>Guess starting values for the parameters of a model.
This is not implemented for all models, but is available
for many of the built-in models.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>array-like</em>) &#8211; array of data to use to guess parameter values.</li>
<li><strong>kws</strong> (<em>additional keyword arguments</em><em>, </em><em>passed to model function.</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>params</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="parameters.html#lmfit.parameter.Parameters" title="lmfit.parameter.Parameters">Parameters</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Should be implemented for each model subclass to run
self.make_params(), update starting values and return a
Parameters object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal"><span class="pre">NotImplementedError</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="lmfit.model.Model.make_params">
<code class="descclassname">Model.</code><code class="descname">make_params</code><span class="sig-paren">(</span><em>verbose=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.model.Model.make_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a Parameters object for a Model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kwargs</strong> (<em>optional initial values</em>) &#8211; parameter names and initial values</li>
<li><strong>verbose</strong> (bool (default <code class="docutils literal"><span class="pre">False</span></code>):) &#8211; whether to print out messages</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>params</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="parameters.html#lmfit.parameter.Parameters" title="lmfit.parameter.Parameters">Parameters</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>1. The parameters may or may not have decent initial values for each
parameter.
2. This applies any default values or parameter hints that may have been set.</p>
</dd></dl>

<dl class="method">
<dt id="lmfit.model.Model.set_param_hint">
<code class="descclassname">Model.</code><code class="descname">set_param_hint</code><span class="sig-paren">(</span><em>name</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.model.Model.set_param_hint" title="Permalink to this definition">¶</a></dt>
<dd><p>Set <em>hints</em> to use when creating parameters with <cite>make_params()</cite>
for the named parameter.  This is especially convenient for setting initial
values.  The <code class="docutils literal"><span class="pre">name</span></code> can include the models <code class="docutils literal"><span class="pre">prefix</span></code> or not.</p>
<p>The hint given can also include optional bounds and constraints
(value, vary, min, max, expr) which will be used by make_params()
when building default parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; Parameter name</li>
<li><strong>value</strong> (float or <code class="docutils literal"><span class="pre">None</span></code> (default)) &#8211; value for parameter.</li>
<li><strong>min</strong> (float or <code class="docutils literal"><span class="pre">-np.inf</span></code> (default)) &#8211; lower bound for parameter value.</li>
<li><strong>max</strong> (float or <code class="docutils literal"><span class="pre">np.inf</span></code> (default)) &#8211; upper bound for parameter value.</li>
<li><strong>vary</strong> (bool (default <code class="docutils literal"><span class="pre">True</span></code>)) &#8211; whether to vary of fix parameter value</li>
<li><strong>expr</strong> (string or <code class="docutils literal"><span class="pre">None</span></code> (default)) &#8211; expression to use to constrain parameter value.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">GaussianModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">set_param_hint</span><span class="p">(</span><span class="s1">&#39;sigma&#39;</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="#model-param-hints-section"><span class="std std-ref">Using parameter hints</span></a>.</p>
</dd></dl>

<dl class="method">
<dt id="lmfit.model.Model.print_param_hints">
<code class="descclassname">Model.</code><code class="descname">print_param_hints</code><span class="sig-paren">(</span><em>colwidth=8</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.model.Model.print_param_hints" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a nicely aligned text-table of parameters hints.</p>
<p>The argument <cite>colwidth</cite> is the width of each column, except for
first and last columns.</p>
</dd></dl>

</div>
<div class="section" id="model-class-attributes">
<h3><a class="reference internal" href="#lmfit.model.Model" title="lmfit.model.Model"><code class="xref py py-class docutils literal"><span class="pre">Model</span></code></a> class Attributes<a class="headerlink" href="#model-class-attributes" title="Permalink to this headline">¶</a></h3>
<dl class="attribute">
<dt id="lmfit.model.func">
<code class="descname">func</code><a class="headerlink" href="#lmfit.model.func" title="Permalink to this definition">¶</a></dt>
<dd><p>The model function used to calculate the model.</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.independent_vars">
<code class="descname">independent_vars</code><a class="headerlink" href="#lmfit.model.independent_vars" title="Permalink to this definition">¶</a></dt>
<dd><p>List of strings for names of the independent variables.</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.missing">
<code class="descname">missing</code><a class="headerlink" href="#lmfit.model.missing" title="Permalink to this definition">¶</a></dt>
<dd><p>Describes what to do for missing values.  The choices are:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">None</span></code>: Do not check for null or missing values (default).</li>
<li><code class="docutils literal"><span class="pre">'none'</span></code>: Do not check for null or missing values.</li>
<li><code class="docutils literal"><span class="pre">'drop'</span></code>: Drop null or missing observations in data.  If pandas is installed, <code class="docutils literal"><span class="pre">pandas.isnull</span></code> is used, otherwise <code class="xref py py-attr docutils literal"><span class="pre">numpy.isnan</span></code> is used.</li>
<li><code class="docutils literal"><span class="pre">'raise'</span></code>: Raise a (more helpful) exception when data contains null or missing values.</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.name">
<code class="descname">name</code><a class="headerlink" href="#lmfit.model.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the model, used only in the string representation of the
model. By default this will be taken from the model function.</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.opts">
<code class="descname">opts</code><a class="headerlink" href="#lmfit.model.opts" title="Permalink to this definition">¶</a></dt>
<dd><p>Extra keyword arguments to pass to model function.  Normally this will
be determined internally and should not be changed.</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.param_hints">
<code class="descname">param_hints</code><a class="headerlink" href="#lmfit.model.param_hints" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of parameter hints.  See <a class="reference internal" href="#model-param-hints-section"><span class="std std-ref">Using parameter hints</span></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.param_names">
<code class="descname">param_names</code><a class="headerlink" href="#lmfit.model.param_names" title="Permalink to this definition">¶</a></dt>
<dd><p>List of strings of parameter names.</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.prefix">
<code class="descname">prefix</code><a class="headerlink" href="#lmfit.model.prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Prefix used for name-mangling of parameter names.  The default is &#8216;&#8217;.
If a particular <a class="reference internal" href="#lmfit.model.Model" title="lmfit.model.Model"><code class="xref py py-class docutils literal"><span class="pre">Model</span></code></a> has arguments <code class="docutils literal"><span class="pre">amplitude</span></code>,
<code class="docutils literal"><span class="pre">center</span></code>, and <code class="docutils literal"><span class="pre">sigma</span></code>, these would become the parameter names.
Using a prefix of <code class="docutils literal"><span class="pre">g1_</span></code> would convert these parameter names to
<code class="docutils literal"><span class="pre">g1_amplitude</span></code>, <code class="docutils literal"><span class="pre">g1_center</span></code>, and <code class="docutils literal"><span class="pre">g1_sigma</span></code>.   This can be
essential to avoid name collision in composite models.</p>
</dd></dl>

</div>
<div class="section" id="determining-parameter-names-and-independent-variables-for-a-function">
<h3>Determining parameter names and independent variables for a function<a class="headerlink" href="#determining-parameter-names-and-independent-variables-for-a-function" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="#lmfit.model.Model" title="lmfit.model.Model"><code class="xref py py-class docutils literal"><span class="pre">Model</span></code></a> created from the supplied function <code class="docutils literal"><span class="pre">func</span></code> will create
a <a class="reference internal" href="parameters.html#lmfit.parameter.Parameters" title="lmfit.parameter.Parameters"><code class="xref py py-class docutils literal"><span class="pre">Parameters</span></code></a> object, and names are inferred from the function
arguments, and a residual function is automatically constructed.</p>
<p>By default, the independent variable is take as the first argument to the
function.  You can explicitly set this, of course, and will need to if the
independent variable is not first in the list, or if there are actually more
than one independent variables.</p>
<p>If not specified, Parameters are constructed from all positional arguments
and all keyword arguments that have a default value that is numerical, except
the independent variable, of course.   Importantly, the Parameters can be
modified after creation.  In fact, you&#8217;ll have to do this because none of the
parameters have valid initial values.  You can place bounds and constraints
on Parameters, or fix their values.</p>
</div>
<div class="section" id="explicitly-specifying-independent-vars">
<h3>Explicitly specifying <code class="docutils literal"><span class="pre">independent_vars</span></code><a class="headerlink" href="#explicitly-specifying-independent-vars" title="Permalink to this headline">¶</a></h3>
<p>As we saw for the Gaussian example above, creating a <a class="reference internal" href="#lmfit.model.Model" title="lmfit.model.Model"><code class="xref py py-class docutils literal"><span class="pre">Model</span></code></a> from a
function is fairly easy. Let&#8217;s try another:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">decay</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
<span class="gp">... </span>   <span class="k">return</span> <span class="n">N</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="o">/</span><span class="n">tau</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decay_model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">decay</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">decay_model</span><span class="o">.</span><span class="n">independent_vars</span>
<span class="go">[&#39;t&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">pname</span><span class="p">,</span> <span class="n">par</span> <span class="ow">in</span> <span class="n">decay_model</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">pname</span><span class="p">,</span> <span class="n">par</span>
<span class="gp">...</span>
<span class="go">tau &lt;Parameter &#39;tau&#39;, None, bounds=[None:None]&gt;</span>
<span class="go">N &lt;Parameter &#39;N&#39;, None, bounds=[None:None]&gt;</span>
</pre></div>
</div>
<p>Here, <code class="docutils literal"><span class="pre">t</span></code> is assumed to be the independent variable because it is the
first argument to the function.  The other function arguments are used to
create parameters for the model.</p>
<p>If you want <code class="docutils literal"><span class="pre">tau</span></code> to be the independent variable in the above example,
you can say so:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">decay_model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">decay</span><span class="p">,</span> <span class="n">independent_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tau&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">decay_model</span><span class="o">.</span><span class="n">independent_vars</span>
<span class="go">[&#39;tau&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">pname</span><span class="p">,</span> <span class="n">par</span> <span class="ow">in</span> <span class="n">decay_model</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">pname</span><span class="p">,</span> <span class="n">par</span>
<span class="gp">...</span>
<span class="go">t &lt;Parameter &#39;t&#39;, None, bounds=[None:None]&gt;</span>
<span class="go">N &lt;Parameter &#39;N&#39;, None, bounds=[None:None]&gt;</span>
</pre></div>
</div>
<p>You can also supply multiple values for multi-dimensional functions with
multiple independent variables.  In fact, the meaning of <em>independent
variable</em> here is simple, and based on how it treats arguments of the
function you are modeling:</p>
<dl class="docutils">
<dt>independent variable</dt>
<dd>a function argument that is not a parameter or otherwise part of the
model, and that will be required to be explicitly provided as a
keyword argument for each fit with <a class="reference internal" href="#lmfit.model.Model.fit" title="lmfit.model.Model.fit"><code class="xref py py-meth docutils literal"><span class="pre">Model.fit()</span></code></a> or evaluation
with <a class="reference internal" href="#lmfit.model.Model.eval" title="lmfit.model.Model.eval"><code class="xref py py-meth docutils literal"><span class="pre">Model.eval()</span></code></a>.</dd>
</dl>
<p>Note that independent variables are not required to be arrays, or even
floating point numbers.</p>
</div>
<div class="section" id="functions-with-keyword-arguments">
<h3>Functions with keyword arguments<a class="headerlink" href="#functions-with-keyword-arguments" title="Permalink to this headline">¶</a></h3>
<p>If the model function had keyword parameters, these would be turned into
Parameters if the supplied default value was a valid number (but not
<code class="docutils literal"><span class="pre">None</span></code>, <code class="docutils literal"><span class="pre">True</span></code>, or <code class="docutils literal"><span class="pre">False</span></code>).</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">decay2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">check_positive</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="gp">... </span>   <span class="k">if</span> <span class="n">check_small</span><span class="p">:</span>
<span class="gp">... </span>       <span class="n">arg</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="nb">max</span><span class="p">(</span><span class="mf">1.e-9</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">tau</span><span class="p">))</span>
<span class="gp">... </span>   <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>       <span class="n">arg</span> <span class="o">=</span> <span class="n">t</span><span class="o">/</span><span class="n">tau</span>
<span class="gp">... </span>   <span class="k">return</span> <span class="n">N</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">decay2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">pname</span><span class="p">,</span> <span class="n">par</span> <span class="ow">in</span> <span class="n">mod</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">pname</span><span class="p">,</span> <span class="n">par</span>
<span class="gp">...</span>
<span class="go">t &lt;Parameter &#39;t&#39;, None, bounds=[None:None]&gt;</span>
<span class="go">N &lt;Parameter &#39;N&#39;, 10, bounds=[None:None]&gt;</span>
</pre></div>
</div>
<p>Here, even though <code class="docutils literal"><span class="pre">N</span></code> is a keyword argument to the function, it is turned
into a parameter, with the default numerical value as its initial value.
By default, it is permitted to be varied in the fit &#8211; the 10 is taken as
an initial value, not a fixed value.  On the other hand, the
<code class="docutils literal"><span class="pre">check_positive</span></code> keyword argument, was not converted to a parameter
because it has a boolean default value.    In some sense,
<code class="docutils literal"><span class="pre">check_positive</span></code> becomes like an independent variable to the model.
However, because it has a default value it is not required to be given for
each model evaluation or fit, as independent variables are.</p>
</div>
<div class="section" id="defining-a-prefix-for-the-parameters">
<h3>Defining a <code class="docutils literal"><span class="pre">prefix</span></code> for the Parameters<a class="headerlink" href="#defining-a-prefix-for-the-parameters" title="Permalink to this headline">¶</a></h3>
<p>As we will see in the next chapter when combining models, it is sometimes
necessary to decorate the parameter names in the model, but still have them
be correctly used in the underlying model function.  This would be
necessary, for example, if two parameters in a composite model (see
<a class="reference internal" href="#composite-models-section"><span class="std std-ref">Composite Models : adding (or multiplying) Models</span></a> or examples in the next chapter) would have
the same name.  To avoid this, we can add a <code class="docutils literal"><span class="pre">prefix</span></code> to the
<a class="reference internal" href="#lmfit.model.Model" title="lmfit.model.Model"><code class="xref py py-class docutils literal"><span class="pre">Model</span></code></a> which will automatically do this mapping for us.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">myfunc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">amplitude</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">...</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">myfunc</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;f1_&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">pname</span><span class="p">,</span> <span class="n">par</span> <span class="ow">in</span> <span class="n">mod</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">pname</span><span class="p">,</span> <span class="n">par</span>
<span class="gp">...</span>
<span class="go">f1_amplitude &lt;Parameter &#39;f1_amplitude&#39;, None, bounds=[None:None]&gt;</span>
<span class="go">f1_center &lt;Parameter &#39;f1_center&#39;, None, bounds=[None:None]&gt;</span>
<span class="go">f1_sigma &lt;Parameter &#39;f1_sigma&#39;, None, bounds=[None:None]&gt;</span>
</pre></div>
</div>
<p>You would refer to these parameters as <code class="docutils literal"><span class="pre">f1_amplitude</span></code> and so forth, and
the model will know to map these to the <code class="docutils literal"><span class="pre">amplitude</span></code> argument of <code class="docutils literal"><span class="pre">myfunc</span></code>.</p>
</div>
<div class="section" id="initializing-model-parameters">
<h3>Initializing model parameters<a class="headerlink" href="#initializing-model-parameters" title="Permalink to this headline">¶</a></h3>
<p>As mentioned above, the parameters created by <a class="reference internal" href="#lmfit.model.Model.make_params" title="lmfit.model.Model.make_params"><code class="xref py py-meth docutils literal"><span class="pre">Model.make_params()</span></code></a> are
generally created with invalid initial values of <code class="docutils literal"><span class="pre">None</span></code>.  These values
<strong>must</strong> be initialized in order for the model to be evaluated or used in a
fit.  There are four different ways to do this initialization that can be
used in any combination:</p>
<blockquote>
<div><ol class="arabic simple">
<li>You can supply initial values in the definition of the model function.</li>
<li>You can initialize the parameters when creating parameters with <a class="reference internal" href="#lmfit.model.Model.make_params" title="lmfit.model.Model.make_params"><code class="xref py py-meth docutils literal"><span class="pre">Model.make_params()</span></code></a>.</li>
<li>You can give parameter hints with <a class="reference internal" href="#lmfit.model.Model.set_param_hint" title="lmfit.model.Model.set_param_hint"><code class="xref py py-meth docutils literal"><span class="pre">Model.set_param_hint()</span></code></a>.</li>
<li>You can supply initial values for the parameters when you use the
<a class="reference internal" href="#lmfit.model.Model.eval" title="lmfit.model.Model.eval"><code class="xref py py-meth docutils literal"><span class="pre">Model.eval()</span></code></a> or <a class="reference internal" href="#lmfit.model.Model.fit" title="lmfit.model.Model.fit"><code class="xref py py-meth docutils literal"><span class="pre">Model.fit()</span></code></a> methods.</li>
</ol>
</div></blockquote>
<p>Of course these methods can be mixed, allowing you to overwrite initial
values at any point in the process of defining and using the model.</p>
<div class="section" id="initializing-values-in-the-function-definition">
<h4>Initializing values in the function definition<a class="headerlink" href="#initializing-values-in-the-function-definition" title="Permalink to this headline">¶</a></h4>
<p>To supply initial values for parameters in the definition of the model
function, you can simply supply a default value:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">myfunc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">...</span>
</pre></div>
</div>
<p>instead of using:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">myfunc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">...</span>
</pre></div>
</div>
<p>This has the advantage of working at the function level &#8211; all parameters
with keywords can be treated as options.  It also means that some default
initial value will always be available for the parameter.</p>
</div>
<div class="section" id="initializing-values-with-model-make-params">
<h4>Initializing values with <a class="reference internal" href="#lmfit.model.Model.make_params" title="lmfit.model.Model.make_params"><code class="xref py py-meth docutils literal"><span class="pre">Model.make_params()</span></code></a><a class="headerlink" href="#initializing-values-with-model-make-params" title="Permalink to this headline">¶</a></h4>
<p>When creating parameters with <a class="reference internal" href="#lmfit.model.Model.make_params" title="lmfit.model.Model.make_params"><code class="xref py py-meth docutils literal"><span class="pre">Model.make_params()</span></code></a> you can specify initial
values.  To do this, use keyword arguments for the parameter names and
initial values:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">myfunc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pars</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">make_params</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="initializing-values-by-setting-parameter-hints">
<h4>Initializing values by setting parameter hints<a class="headerlink" href="#initializing-values-by-setting-parameter-hints" title="Permalink to this headline">¶</a></h4>
<p>After a model has been created, but prior to creating parameters with
<a class="reference internal" href="#lmfit.model.Model.make_params" title="lmfit.model.Model.make_params"><code class="xref py py-meth docutils literal"><span class="pre">Model.make_params()</span></code></a>, you can set parameter hints.  These allows you to set
not only a default initial value but also to set other parameter attributes
controlling bounds, whether it is varied in the fit, or a constraint
expression.  To set a parameter hint, you can use <a class="reference internal" href="#lmfit.model.Model.set_param_hint" title="lmfit.model.Model.set_param_hint"><code class="xref py py-meth docutils literal"><span class="pre">Model.set_param_hint()</span></code></a>,
as with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">myfunc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span><span class="o">.</span><span class="n">set_param_hint</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span><span class="o">.</span><span class="n">set_param_hint</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pars</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">make_params</span><span class="p">()</span>
</pre></div>
</div>
<p>Parameter hints are discussed in more detail in section
<a class="reference internal" href="#model-param-hints-section"><span class="std std-ref">Using parameter hints</span></a>.</p>
</div>
<div class="section" id="initializing-values-when-using-a-model">
<h4>Initializing values when using a model<a class="headerlink" href="#initializing-values-when-using-a-model" title="Permalink to this headline">¶</a></h4>
<p>Finally, you can explicitly supply initial values when using a model.  That
is, as with <a class="reference internal" href="#lmfit.model.Model.make_params" title="lmfit.model.Model.make_params"><code class="xref py py-meth docutils literal"><span class="pre">Model.make_params()</span></code></a>, you can include values
as keyword arguments to either the <a class="reference internal" href="#lmfit.model.Model.eval" title="lmfit.model.Model.eval"><code class="xref py py-meth docutils literal"><span class="pre">Model.eval()</span></code></a> or <a class="reference internal" href="#lmfit.model.Model.fit" title="lmfit.model.Model.fit"><code class="xref py py-meth docutils literal"><span class="pre">Model.fit()</span></code></a> methods:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y1</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">7.0</span><span class="p">,</span> <span class="n">b</span><span class="o">=-</span><span class="mf">2.0</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">pars</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">b</span><span class="o">=-</span><span class="mf">0.0</span><span class="p">)</span>
</pre></div>
</div>
<p>These approaches to initialization provide many opportunities for setting
initial values for parameters.  The methods can be combined, so that you
can set parameter hints but then change the initial value explicitly with
<a class="reference internal" href="#lmfit.model.Model.fit" title="lmfit.model.Model.fit"><code class="xref py py-meth docutils literal"><span class="pre">Model.fit()</span></code></a>.</p>
</div>
</div>
<div class="section" id="using-parameter-hints">
<span id="model-param-hints-section"></span><h3>Using parameter hints<a class="headerlink" href="#using-parameter-hints" title="Permalink to this headline">¶</a></h3>
<p>After a model has been created, you can give it hints for how to create
parameters with <a class="reference internal" href="#lmfit.model.Model.make_params" title="lmfit.model.Model.make_params"><code class="xref py py-meth docutils literal"><span class="pre">Model.make_params()</span></code></a>.  This allows you to set not only a
default initial value but also to set other parameter attributes
controlling bounds, whether it is varied in the fit, or a constraint</p>
<p>expression.   To set a parameter hint, you can use <a class="reference internal" href="#lmfit.model.Model.set_param_hint" title="lmfit.model.Model.set_param_hint"><code class="xref py py-meth docutils literal"><span class="pre">Model.set_param_hint()</span></code></a>,
as with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">myfunc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span><span class="o">.</span><span class="n">set_param_hint</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span><span class="o">.</span><span class="n">set_param_hint</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
<p>Parameter hints are stored in a model&#8217;s <a class="reference internal" href="#lmfit.model.param_hints" title="lmfit.model.param_hints"><code class="xref py py-attr docutils literal"><span class="pre">param_hints</span></code></a> attribute,
which is simply a nested dictionary:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">mod</span><span class="o">.</span><span class="n">param_hints</span>
<span class="go">{&#39;a&#39;: {&#39;value&#39;: 1}, &#39;b&#39;: {&#39;max&#39;: 1.0, &#39;value&#39;: 0.3, &#39;min&#39;: 0}}</span>
</pre></div>
</div>
<p>You can change this dictionary directly, or with the <a class="reference internal" href="#lmfit.model.Model.set_param_hint" title="lmfit.model.Model.set_param_hint"><code class="xref py py-meth docutils literal"><span class="pre">Model.set_param_hint()</span></code></a>
method.  Either way, these parameter hints are used by <a class="reference internal" href="#lmfit.model.Model.make_params" title="lmfit.model.Model.make_params"><code class="xref py py-meth docutils literal"><span class="pre">Model.make_params()</span></code></a>
when making parameters.</p>
<p>An important feature of parameter hints is that you can force the creation
of new parameters with parameter hints.  This can be useful to make derived
parameters with constraint expressions.  For example to get the full-width
at half maximum of a Gaussian model, one could use a parameter hint of:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">gaussian</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span><span class="o">.</span><span class="n">set_param_hint</span><span class="p">(</span><span class="s1">&#39;fwhm&#39;</span><span class="p">,</span> <span class="n">expr</span><span class="o">=</span><span class="s1">&#39;2.3548*sigma&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="the-modelresult-class">
<h2>The <a class="reference internal" href="#lmfit.model.ModelResult" title="lmfit.model.ModelResult"><code class="xref py py-class docutils literal"><span class="pre">ModelResult</span></code></a> class<a class="headerlink" href="#the-modelresult-class" title="Permalink to this headline">¶</a></h2>
<p>A <a class="reference internal" href="#lmfit.model.ModelResult" title="lmfit.model.ModelResult"><code class="xref py py-class docutils literal"><span class="pre">ModelResult</span></code></a> (which had been called <cite>ModelFit</cite> prior to version
0.9) is the object returned by <a class="reference internal" href="#lmfit.model.Model.fit" title="lmfit.model.Model.fit"><code class="xref py py-meth docutils literal"><span class="pre">Model.fit()</span></code></a>.  It is a subclass of
<a class="reference internal" href="fitting.html#lmfit.minimizer.Minimizer" title="lmfit.minimizer.Minimizer"><code class="xref py py-class docutils literal"><span class="pre">Minimizer</span></code></a>, and so contains many of the fit results.  Of course, it
knows the <a class="reference internal" href="#lmfit.model.Model" title="lmfit.model.Model"><code class="xref py py-class docutils literal"><span class="pre">Model</span></code></a> and the set of <a class="reference internal" href="parameters.html#lmfit.parameter.Parameters" title="lmfit.parameter.Parameters"><code class="xref py py-class docutils literal"><span class="pre">Parameters</span></code></a> used in the
fit, and it has methods to evaluate the model, to fit the data (or re-fit
the data with changes to the parameters, or fit with different or modified
data) and to print out a report for that fit.</p>
<p>While a <a class="reference internal" href="#lmfit.model.Model" title="lmfit.model.Model"><code class="xref py py-class docutils literal"><span class="pre">Model</span></code></a> encapsulates your model function, it is fairly
abstract and does not contain the parameters or data used in a particular
fit.  A <a class="reference internal" href="#lmfit.model.ModelResult" title="lmfit.model.ModelResult"><code class="xref py py-class docutils literal"><span class="pre">ModelResult</span></code></a> <em>does</em> contain parameters and data as well as
methods to alter and re-do fits.  Thus the <a class="reference internal" href="#lmfit.model.Model" title="lmfit.model.Model"><code class="xref py py-class docutils literal"><span class="pre">Model</span></code></a> is the idealized
model while the <a class="reference internal" href="#lmfit.model.ModelResult" title="lmfit.model.ModelResult"><code class="xref py py-class docutils literal"><span class="pre">ModelResult</span></code></a> is the messier, more complex (but perhaps
more useful) object that represents a fit with a set of parameters to data
with a model.</p>
<p>A <a class="reference internal" href="#lmfit.model.ModelResult" title="lmfit.model.ModelResult"><code class="xref py py-class docutils literal"><span class="pre">ModelResult</span></code></a> has several attributes holding values for fit
results, and several methods for working with fits.  These include
statistics inherited from <a class="reference internal" href="fitting.html#lmfit.minimizer.Minimizer" title="lmfit.minimizer.Minimizer"><code class="xref py py-class docutils literal"><span class="pre">Minimizer</span></code></a> useful for
comparing different models, including <cite>chisqr</cite>, <cite>redchi</cite>, <cite>aic</cite>, and <cite>bic</cite>.</p>
<dl class="class">
<dt id="lmfit.model.ModelResult">
<em class="property">class </em><code class="descname">ModelResult</code><span class="sig-paren">(</span><em>model</em>, <em>params</em>, <em>data=None</em>, <em>weights=None</em>, <em>method='leastsq'</em>, <em>fcn_args=None</em>, <em>fcn_kws=None</em>, <em>iter_cb=None</em>, <em>scale_covar=True</em>, <em>**fit_kws</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.model.ModelResult" title="Permalink to this definition">¶</a></dt>
<dd><p>Result from Model fit.
This has many attributes and methods for viewing and working with the
results of a fit using Model.  It inherits from Minimizer, so that it
can be used to modify and re-run the fit for the Model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>model</strong> (<em>Model instance</em>) &#8211; model to use.</li>
<li><strong>params</strong> (<em>Parameters instance</em>) &#8211; parameters with initial values for model.</li>
<li><strong>data</strong> (array-like or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; data to be modeled.</li>
<li><strong>weights</strong> (array-like or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; weights to multiply (data-model) for fit residual.</li>
<li><strong>method</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; name of minimization method to use</li>
<li><strong>fcn_args</strong> (sequence or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; positional arguments to send to model function</li>
<li><strong>fcn_dict</strong> (dict or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; keyword arguments to send to model function</li>
<li><strong>iter_cb</strong> (callable or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; function to call on each iteration of fit.</li>
<li><strong>scale_covar</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; whether to scale covariance matrix for uncertainty evaluation</li>
<li><strong>fit_kws</strong> (<em>optional</em>) &#8211; keyword arguments to send to minimization routine.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<div class="section" id="modelresult-methods">
<h3><a class="reference internal" href="#lmfit.model.ModelResult" title="lmfit.model.ModelResult"><code class="xref py py-class docutils literal"><span class="pre">ModelResult</span></code></a> methods<a class="headerlink" href="#modelresult-methods" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="lmfit.model.ModelResult.eval">
<code class="descclassname">ModelResult.</code><code class="descname">eval</code><span class="sig-paren">(</span><em>params=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.model.ModelResult.eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate model function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>params</strong> (Parameters or <code class="docutils literal"><span class="pre">None</span></code> (default)) &#8211; Parameters to use.</li>
<li><strong>kwargs</strong> (<em>optional</em>) &#8211; options to send Model.eval()</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>out</strong> &#8211; array for evaluated model</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="lmfit.model.ModelResult.eval_components">
<code class="descclassname">ModelResult.</code><code class="descname">eval_components</code><span class="sig-paren">(</span><em>params=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.model.ModelResult.eval_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate each component of a composite model function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>params</strong> (Parameters or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; parameters, defaults to ModelResult.params</li>
<li><strong>kwargs</strong> (<em>optional</em>) &#8211; keyword arguments to pass to model function.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>comps</strong> &#8211; keys are prefixes of component models, and values are
the estimated model value for each component of the model.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ordered dictionary</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="lmfit.model.ModelResult.fit">
<code class="descclassname">ModelResult.</code><code class="descname">fit</code><span class="sig-paren">(</span><em>data=None</em>, <em>params=None</em>, <em>weights=None</em>, <em>method=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.model.ModelResult.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Re-perform fit for a Model, given data and params.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data</strong> (array-like or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; data to be modeled.</li>
<li><strong>params</strong> (<em>Parameters instance</em>) &#8211; parameters with initial values for model.</li>
<li><strong>weights</strong> (array-like or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; weights to multiply (data-model) for fit residual.</li>
<li><strong>method</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; name of minimization method to use</li>
<li><strong>kwargs</strong> (<em>optional</em>) &#8211; keyword arguments to send to minimization routine.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="lmfit.model.ModelResult.fit_report">
<code class="descclassname">ModelResult.</code><code class="descname">fit_report</code><span class="sig-paren">(</span><em>modelpars=None</em>, <em>show_correl=True</em>, <em>min_correl=0.1</em>, <em>sort_pars=False</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.model.ModelResult.fit_report" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a printable fit report for the fit with fit statistics,
best-fit values with uncertainties and correlations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>inpars</strong> (<a class="reference internal" href="parameters.html#lmfit.parameter.Parameters" title="lmfit.parameter.Parameters"><em>Parameters</em></a>) &#8211; input Parameters from fit or MinimizerResult returned from a fit.</li>
<li><strong>modelpars</strong> (<em>optional</em>) &#8211; known Model Parameters</li>
<li><strong>show_correl</strong> (bool, default <code class="docutils literal"><span class="pre">True</span></code>) &#8211; whether to show list of sorted correlations</li>
<li><strong>min_correl</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em>, </em><em>default 0.1</em>) &#8211; smallest correlation absolute value to show.</li>
<li><strong>sort_pars</strong> (bool, default <code class="docutils literal"><span class="pre">False</span></code>, or callable) &#8211; whether to show parameter names sorted in alphanumerical order.  If
<code class="docutils literal"><span class="pre">False</span></code>, then the parameters will be listed in the order they were
added to the Parameters dictionary. If callable, then this (one
argument) function is used to extract a comparison key from each
list element.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>text</strong> &#8211; multi-line text of fit report</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)">string</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#lmfit.model.ModelResult.fit_report" title="lmfit.model.ModelResult.fit_report"><code class="xref py py-func docutils literal"><span class="pre">fit_report()</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="lmfit.model.ModelResult.conf_interval">
<code class="descclassname">ModelResult.</code><code class="descname">conf_interval</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.model.ModelResult.conf_interval" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the confidence intervals for the variable parameters
using <code class="xref py py-func docutils literal"><span class="pre">confidence.conf_interval()</span></code>.  keyword arguments are
passed to that function.  The result is stored in <a class="reference internal" href="#lmfit.model.ci_out" title="lmfit.model.ci_out"><code class="xref py py-attr docutils literal"><span class="pre">ci_out</span></code></a>,
and so can be accessed without recalculating them.</p>
</dd></dl>

<dl class="method">
<dt id="lmfit.model.ModelResult.ci_report">
<code class="descclassname">ModelResult.</code><code class="descname">ci_report</code><span class="sig-paren">(</span><em>with_offset=True</em>, <em>ndigits=5</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.model.ModelResult.ci_report" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a nicely formatted text report of the confidence
intervals, as from <a class="reference internal" href="#lmfit.model.ModelResult.ci_report" title="lmfit.model.ModelResult.ci_report"><code class="xref py py-func docutils literal"><span class="pre">ci_report()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>with_offset</strong> (bool (default <cite>True</cite>)) &#8211; Whether to subtract best value from all other values.</li>
<li><strong>ndigits</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em> (</em><em>default 5</em><em>)</em><em></em>) &#8211; Number of significant digits to show.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Text of formatted report on confidence intervals.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="lmfit.model.ModelResult.eval_uncertainty">
<code class="descclassname">ModelResult.</code><code class="descname">eval_uncertainty</code><span class="sig-paren">(</span><em>params=None</em>, <em>sigma=1</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.model.ModelResult.eval_uncertainty" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the uncertainty of the <em>model function</em> from the
uncertainties for the best-fit parameters.  This can be used
to give confidence bands for the model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>params</strong> (Parameters or <code class="docutils literal"><span class="pre">None</span></code>) &#8211; parameters, defaults to ModelResult .params</li>
<li><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; confidence level, i.e. how many sigma [default=1]</li>
<li><strong>kwargs</strong> (<em>optional</em>) &#8211; values of options, independent variables, etc</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>out</strong> &#8211; uncertainty at each value of the model.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dely</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">eval_confidence_band</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">out</span><span class="o">.</span><span class="n">best_fit</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">out</span><span class="o">.</span><span class="n">best_fit</span><span class="o">-</span><span class="n">dely</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">out</span><span class="o">.</span><span class="n">best_fit</span><span class="o">+</span><span class="n">dely</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#888888&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ol class="arabic simple">
<li>This is based on the excellent and clear example from
<a class="reference external" href="https://www.astro.rug.nl/software/kapteyn/kmpfittutorial.html#confidence-and-prediction-intervals">https://www.astro.rug.nl/software/kapteyn/kmpfittutorial.html#confidence-and-prediction-intervals</a> which references the original work of
J. Wolberg,Data Analysis Using the Method of Least Squares, 2006, Springer</li>
<li>the value of sigma is number of <cite>sigma</cite> values, and is converted to a
probability.  Values or 1, 2, or 3 give probalities of 0.6827, 0.9545,
and 0.9973, respectively. If the sigma value is &lt; 1, it is interpreted
as the probability itself.  That is, <cite>sigma=1</cite> and <cite>sigma=0.6827</cite> will
give the same results, within precision errors.</li>
</ol>
</dd></dl>

<dl class="method">
<dt id="lmfit.model.ModelResult.plot">
<code class="descclassname">ModelResult.</code><code class="descname">plot</code><span class="sig-paren">(</span><em>datafmt='o'</em>, <em>fitfmt='-'</em>, <em>initfmt='--'</em>, <em>xlabel=None</em>, <em>ylabel=None</em>, <em>yerr=None</em>, <em>numpoints=None</em>, <em>fig=None</em>, <em>data_kws=None</em>, <em>fit_kws=None</em>, <em>init_kws=None</em>, <em>ax_res_kws=None</em>, <em>ax_fit_kws=None</em>, <em>fig_kws=None</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.model.ModelResult.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the fit results and residuals using matplotlib, if available.
The method will produce a matplotlib figure with both results of the
fit and the residuals plotted. If the fit model included weights,
errorbars will also be plotted.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>datafmt</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a><em>, </em><em>optional</em>) &#8211; matplotlib format string for data points</li>
<li><strong>fitfmt</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a><em>, </em><em>optional</em>) &#8211; matplotlib format string for fitted curve</li>
<li><strong>initfmt</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a><em>, </em><em>optional</em>) &#8211; matplotlib format string for initial conditions for the fit</li>
<li><strong>xlabel</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a><em>, </em><em>optional</em>) &#8211; matplotlib format string for labeling the x-axis</li>
<li><strong>ylabel</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a><em>, </em><em>optional</em>) &#8211; matplotlib format string for labeling the y-axis</li>
<li><strong>yerr</strong> (<em>ndarray</em><em>, </em><em>optional</em>) &#8211; array of uncertainties for data array</li>
<li><strong>numpoints</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>, </em><em>optional</em>) &#8211; If provided, the final and initial fit curves are evaluated not
only at data points, but refined to contain <cite>numpoints</cite> points in
total.</li>
<li><strong>fig</strong> (<em>matplotlib.figure.Figure</em><em>, </em><em>optional</em>) &#8211; The figure to plot on. The default is None, which means use the
current pyplot figure or create one if there is none.</li>
<li><strong>data_kws</strong> (<em>dictionary</em><em>, </em><em>optional</em>) &#8211; keyword arguments passed on to the plot function for data points</li>
<li><strong>fit_kws</strong> (<em>dictionary</em><em>, </em><em>optional</em>) &#8211; keyword arguments passed on to the plot function for fitted curve</li>
<li><strong>init_kws</strong> (<em>dictionary</em><em>, </em><em>optional</em>) &#8211; keyword arguments passed on to the plot function for the initial
conditions of the fit</li>
<li><strong>ax_res_kws</strong> (<em>dictionary</em><em>, </em><em>optional</em>) &#8211; keyword arguments for the axes for the residuals plot</li>
<li><strong>ax_fit_kws</strong> (<em>dictionary</em><em>, </em><em>optional</em>) &#8211; keyword arguments for the axes for the fit plot</li>
<li><strong>fig_kws</strong> (<em>dictionary</em><em>, </em><em>optional</em>) &#8211; keyword arguments for a new figure, if there is one being created</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">A tuple with matplotlib&#8217;s Figure and GridSpec objects.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The method combines ModelResult.plot_fit and ModelResult.plot_residuals.</p>
<p>If yerr is specified or if the fit model included weights, then
matplotlib.axes.Axes.errorbar is used to plot the data.  If yerr is
not specified and the fit includes weights, yerr set to 1/self.weights</p>
<p>If <cite>fig</cite> is None then <cite>matplotlib.pyplot.figure(**fig_kws)</cite> is called,
otherwise <cite>fig_kws</cite> is ignored.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#lmfit.model.ModelResult.plot_fit" title="lmfit.model.ModelResult.plot_fit"><code class="xref py py-meth docutils literal"><span class="pre">ModelResult.plot_fit()</span></code></a></dt>
<dd>Plot the fit results using matplotlib.</dd>
<dt><a class="reference internal" href="#lmfit.model.ModelResult.plot_residuals" title="lmfit.model.ModelResult.plot_residuals"><code class="xref py py-meth docutils literal"><span class="pre">ModelResult.plot_residuals()</span></code></a></dt>
<dd>Plot the fit residuals using matplotlib.</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="lmfit.model.ModelResult.plot_fit">
<code class="descclassname">ModelResult.</code><code class="descname">plot_fit</code><span class="sig-paren">(</span><em>ax=None</em>, <em>datafmt='o'</em>, <em>fitfmt='-'</em>, <em>initfmt='--'</em>, <em>xlabel=None</em>, <em>ylabel=None</em>, <em>yerr=None</em>, <em>numpoints=None</em>, <em>data_kws=None</em>, <em>fit_kws=None</em>, <em>init_kws=None</em>, <em>ax_kws=None</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.model.ModelResult.plot_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the fit results using matplotlib, if available.
The plot will include the data points, the initial fit curve, and
the best-fit curve. If the fit  model included weights or if <code class="docutils literal"><span class="pre">yerr</span></code>
is specified, errorbars will also be plotted.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ax</strong> (<em>matplotlib.axes.Axes</em><em>, </em><em>optional</em>) &#8211; The axes to plot on. The default in None, which means use the
current pyplot axis or create one if there is none.</li>
<li><strong>datafmt</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a><em>, </em><em>optional</em>) &#8211; matplotlib format string for data points</li>
<li><strong>fitfmt</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a><em>, </em><em>optional</em>) &#8211; matplotlib format string for fitted curve</li>
<li><strong>initfmt</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a><em>, </em><em>optional</em>) &#8211; matplotlib format string for initial conditions for the fit</li>
<li><strong>xlabel</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a><em>, </em><em>optional</em>) &#8211; matplotlib format string for labeling the x-axis</li>
<li><strong>ylabel</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a><em>, </em><em>optional</em>) &#8211; matplotlib format string for labeling the y-axis</li>
<li><strong>yerr</strong> (<em>ndarray</em><em>, </em><em>optional</em>) &#8211; array of uncertainties for data array</li>
<li><strong>numpoints</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>, </em><em>optional</em>) &#8211; If provided, the final and initial fit curves are evaluated not
only at data points, but refined to contain <cite>numpoints</cite> points in
total.</li>
<li><strong>data_kws</strong> (<em>dictionary</em><em>, </em><em>optional</em>) &#8211; keyword arguments passed on to the plot function for data points</li>
<li><strong>fit_kws</strong> (<em>dictionary</em><em>, </em><em>optional</em>) &#8211; keyword arguments passed on to the plot function for fitted curve</li>
<li><strong>init_kws</strong> (<em>dictionary</em><em>, </em><em>optional</em>) &#8211; keyword arguments passed on to the plot function for the initial
conditions of the fit</li>
<li><strong>ax_kws</strong> (<em>dictionary</em><em>, </em><em>optional</em>) &#8211; keyword arguments for a new axis, if there is one being created</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">matplotlib.axes.Axes</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>For details about plot format strings and keyword arguments see
documentation of matplotlib.axes.Axes.plot.</p>
<p>If yerr is specified or if the fit model included weights, then
matplotlib.axes.Axes.errorbar is used to plot the data.  If yerr is
not specified and the fit includes weights, yerr set to 1/self.weights</p>
<p>If <cite>ax</cite> is None then <cite>matplotlib.pyplot.gca(**ax_kws)</cite> is called.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#lmfit.model.ModelResult.plot_residuals" title="lmfit.model.ModelResult.plot_residuals"><code class="xref py py-meth docutils literal"><span class="pre">ModelResult.plot_residuals()</span></code></a></dt>
<dd>Plot the fit residuals using matplotlib.</dd>
<dt><a class="reference internal" href="#lmfit.model.ModelResult.plot" title="lmfit.model.ModelResult.plot"><code class="xref py py-meth docutils literal"><span class="pre">ModelResult.plot()</span></code></a></dt>
<dd>Plot the fit results and residuals using matplotlib.</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="lmfit.model.ModelResult.plot_residuals">
<code class="descclassname">ModelResult.</code><code class="descname">plot_residuals</code><span class="sig-paren">(</span><em>ax=None</em>, <em>datafmt='o'</em>, <em>yerr=None</em>, <em>data_kws=None</em>, <em>fit_kws=None</em>, <em>ax_kws=None</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.model.ModelResult.plot_residuals" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the fit residuals using matplotlib, if available. If <code class="docutils literal"><span class="pre">yerr</span></code>
is supplied or if the model included weights, errorbars will also
be plotted.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ax</strong> (<em>matplotlib.axes.Axes</em><em>, </em><em>optional</em>) &#8211; The axes to plot on. The default in None, which means use the
current pyplot axis or create one if there is none.</li>
<li><strong>datafmt</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a><em>, </em><em>optional</em>) &#8211; matplotlib format string for data points</li>
<li><strong>yerr</strong> (<em>ndarray</em><em>, </em><em>optional</em>) &#8211; array of uncertainties for data array</li>
<li><strong>data_kws</strong> (<em>dictionary</em><em>, </em><em>optional</em>) &#8211; keyword arguments passed on to the plot function for data points</li>
<li><strong>fit_kws</strong> (<em>dictionary</em><em>, </em><em>optional</em>) &#8211; keyword arguments passed on to the plot function for fitted curve</li>
<li><strong>ax_kws</strong> (<em>dictionary</em><em>, </em><em>optional</em>) &#8211; keyword arguments for a new axis, if there is one being created</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">matplotlib.axes.Axes</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>For details about plot format strings and keyword arguments see
documentation of matplotlib.axes.Axes.plot.</p>
<p>If yerr is specified or if the fit model included weights, then
matplotlib.axes.Axes.errorbar is used to plot the data.  If yerr is
not specified and the fit includes weights, yerr set to 1/self.weights</p>
<p>If <cite>ax</cite> is None then <cite>matplotlib.pyplot.gca(**ax_kws)</cite> is called.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#lmfit.model.ModelResult.plot_fit" title="lmfit.model.ModelResult.plot_fit"><code class="xref py py-meth docutils literal"><span class="pre">ModelResult.plot_fit()</span></code></a></dt>
<dd>Plot the fit results using matplotlib.</dd>
<dt><a class="reference internal" href="#lmfit.model.ModelResult.plot" title="lmfit.model.ModelResult.plot"><code class="xref py py-meth docutils literal"><span class="pre">ModelResult.plot()</span></code></a></dt>
<dd>Plot the fit results and residuals using matplotlib.</dd>
</dl>
</div>
</dd></dl>

</div>
<div class="section" id="modelresult-attributes">
<h3><a class="reference internal" href="#lmfit.model.ModelResult" title="lmfit.model.ModelResult"><code class="xref py py-class docutils literal"><span class="pre">ModelResult</span></code></a> attributes<a class="headerlink" href="#modelresult-attributes" title="Permalink to this headline">¶</a></h3>
<dl class="attribute">
<dt id="lmfit.model.aic">
<code class="descname">aic</code><a class="headerlink" href="#lmfit.model.aic" title="Permalink to this definition">¶</a></dt>
<dd><p>Floating point best-fit Akaike Information Criterion statistic (see <a class="reference internal" href="fitting.html#fit-results-label"><span class="std std-ref">MinimizerResult &#8211; the optimization result</span></a>).</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.best_fit">
<code class="descname">best_fit</code><a class="headerlink" href="#lmfit.model.best_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>ndarray result of model function, evaluated at provided
independent variables and with best-fit parameters.</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.best_values">
<code class="descname">best_values</code><a class="headerlink" href="#lmfit.model.best_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary with parameter names as keys, and best-fit values as values.</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.bic">
<code class="descname">bic</code><a class="headerlink" href="#lmfit.model.bic" title="Permalink to this definition">¶</a></dt>
<dd><p>Floating point best-fit Bayesian Information Criterion statistic (see <a class="reference internal" href="fitting.html#fit-results-label"><span class="std std-ref">MinimizerResult &#8211; the optimization result</span></a>).</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.chisqr">
<code class="descname">chisqr</code><a class="headerlink" href="#lmfit.model.chisqr" title="Permalink to this definition">¶</a></dt>
<dd><p>Floating point best-fit chi-square statistic (see <a class="reference internal" href="fitting.html#fit-results-label"><span class="std std-ref">MinimizerResult &#8211; the optimization result</span></a>).</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.ci_out">
<code class="descname">ci_out</code><a class="headerlink" href="#lmfit.model.ci_out" title="Permalink to this definition">¶</a></dt>
<dd><p>Confidence interval data (see <a class="reference internal" href="confidence.html#confidence-chapter"><span class="std std-ref">Calculation of confidence intervals</span></a>) or <cite>None</cite>  if
the confidence intervals have not been calculated.</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.covar">
<code class="descname">covar</code><a class="headerlink" href="#lmfit.model.covar" title="Permalink to this definition">¶</a></dt>
<dd><p>ndarray (square) covariance matrix returned from fit.</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.data">
<code class="descname">data</code><a class="headerlink" href="#lmfit.model.data" title="Permalink to this definition">¶</a></dt>
<dd><p>ndarray of data to compare to model.</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.errorbars">
<code class="descname">errorbars</code><a class="headerlink" href="#lmfit.model.errorbars" title="Permalink to this definition">¶</a></dt>
<dd><p>Boolean for whether error bars were estimated by fit.</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.ier">
<code class="descname">ier</code><a class="headerlink" href="#lmfit.model.ier" title="Permalink to this definition">¶</a></dt>
<dd><p>Integer returned code from <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.leastsq.html">scipy.optimize.leastsq</a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.init_fit">
<code class="descname">init_fit</code><a class="headerlink" href="#lmfit.model.init_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Ndarray result of model function, evaluated at provided
independent variables and with initial parameters.</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.init_params">
<code class="descname">init_params</code><a class="headerlink" href="#lmfit.model.init_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Initial parameters.</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.init_values">
<code class="descname">init_values</code><a class="headerlink" href="#lmfit.model.init_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary with  parameter names as keys, and initial values as values.</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.iter_cb">
<code class="descname">iter_cb</code><a class="headerlink" href="#lmfit.model.iter_cb" title="Permalink to this definition">¶</a></dt>
<dd><p>Optional callable function, to be called at each fit iteration.  This
must take take arguments of <code class="docutils literal"><span class="pre">params,</span> <span class="pre">iter,</span> <span class="pre">resid,</span> <span class="pre">*args,</span> <span class="pre">**kws</span></code>, where
<code class="docutils literal"><span class="pre">params</span></code> will have the current parameter values, <code class="docutils literal"><span class="pre">iter</span></code> the
iteration, <code class="docutils literal"><span class="pre">resid</span></code> the current residual array, and <code class="docutils literal"><span class="pre">*args</span></code> and
<code class="docutils literal"><span class="pre">**kws</span></code> as passed to the objective function.  See <a class="reference internal" href="fitting.html#fit-itercb-label"><span class="std std-ref">Using a Iteration Callback Function</span></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.jacfcn">
<code class="descname">jacfcn</code><a class="headerlink" href="#lmfit.model.jacfcn" title="Permalink to this definition">¶</a></dt>
<dd><p>Optional callable function, to be called to calculate jacobian array.</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.lmdif_message">
<code class="descname">lmdif_message</code><a class="headerlink" href="#lmfit.model.lmdif_message" title="Permalink to this definition">¶</a></dt>
<dd><p>String message returned from <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.leastsq.html">scipy.optimize.leastsq</a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.message">
<code class="descname">message</code><a class="headerlink" href="#lmfit.model.message" title="Permalink to this definition">¶</a></dt>
<dd><p>String message returned from <a class="reference internal" href="fitting.html#lmfit.minimizer.minimize" title="lmfit.minimizer.minimize"><code class="xref py py-func docutils literal"><span class="pre">minimize()</span></code></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.method">
<code class="descname">method</code><a class="headerlink" href="#lmfit.model.method" title="Permalink to this definition">¶</a></dt>
<dd><p>String naming fitting method for <a class="reference internal" href="fitting.html#lmfit.minimizer.minimize" title="lmfit.minimizer.minimize"><code class="xref py py-func docutils literal"><span class="pre">minimize()</span></code></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.model">
<code class="descname">model</code><a class="headerlink" href="#lmfit.model.model" title="Permalink to this definition">¶</a></dt>
<dd><p>Instance of <a class="reference internal" href="#lmfit.model.Model" title="lmfit.model.Model"><code class="xref py py-class docutils literal"><span class="pre">Model</span></code></a> used for model.</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.ndata">
<code class="descname">ndata</code><a class="headerlink" href="#lmfit.model.ndata" title="Permalink to this definition">¶</a></dt>
<dd><p>Integer number of data points.</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.nfev">
<code class="descname">nfev</code><a class="headerlink" href="#lmfit.model.nfev" title="Permalink to this definition">¶</a></dt>
<dd><p>Integer number of function evaluations used for fit.</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.nfree">
<code class="descname">nfree</code><a class="headerlink" href="#lmfit.model.nfree" title="Permalink to this definition">¶</a></dt>
<dd><p>Integer number of free parameters in fit.</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.nvarys">
<code class="descname">nvarys</code><a class="headerlink" href="#lmfit.model.nvarys" title="Permalink to this definition">¶</a></dt>
<dd><p>Integer number of independent, freely varying variables in fit.</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.params">
<code class="descname">params</code><a class="headerlink" href="#lmfit.model.params" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters used in fit.  Will have best-fit values.</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.redchi">
<code class="descname">redchi</code><a class="headerlink" href="#lmfit.model.redchi" title="Permalink to this definition">¶</a></dt>
<dd><p>Floating point reduced chi-square statistic (see <a class="reference internal" href="fitting.html#fit-results-label"><span class="std std-ref">MinimizerResult &#8211; the optimization result</span></a>).</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.residual">
<code class="descname">residual</code><a class="headerlink" href="#lmfit.model.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>ndarray for residual.</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.scale_covar">
<code class="descname">scale_covar</code><a class="headerlink" href="#lmfit.model.scale_covar" title="Permalink to this definition">¶</a></dt>
<dd><p>Boolean flag for whether to automatically scale covariance matrix.</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.success">
<code class="descname">success</code><a class="headerlink" href="#lmfit.model.success" title="Permalink to this definition">¶</a></dt>
<dd><p>Boolean value of whether fit succeeded.</p>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.model.weights">
<code class="descname">weights</code><a class="headerlink" href="#lmfit.model.weights" title="Permalink to this definition">¶</a></dt>
<dd><p>ndarray (or <code class="docutils literal"><span class="pre">None</span></code>) of weighting values to be used in fit.  If not
<code class="docutils literal"><span class="pre">None</span></code>, it will be used as a multiplicative factor of the residual
array, so that <code class="docutils literal"><span class="pre">weights*(data</span> <span class="pre">-</span> <span class="pre">fit)</span></code> is minimized in the
least-squares sense.</p>
</dd></dl>

</div>
<div class="section" id="calculating-uncertainties-in-the-model-function">
<h3>Calculating uncertainties in the model function<a class="headerlink" href="#calculating-uncertainties-in-the-model-function" title="Permalink to this headline">¶</a></h3>
<p>We return to the first example above and ask not only for the
uncertainties in the fitted parameters but for the range of values that
those uncertainties mean for the model function itself.  We can use the
<a class="reference internal" href="#lmfit.model.ModelResult.eval_uncertainty" title="lmfit.model.ModelResult.eval_uncertainty"><code class="xref py py-meth docutils literal"><span class="pre">ModelResult.eval_uncertainty()</span></code></a> method of the model result object to
evaluate the uncertainty in the model with a specified level for
<span class="math">\(sigma\)</span>.</p>
<p>That is, adding:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">dely</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">eval_uncertainty</span><span class="p">(</span><span class="n">sigma</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">best_fit</span><span class="o">-</span><span class="n">dely</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">best_fit</span><span class="o">+</span><span class="n">dely</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#ABABAB&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>to the example fit to the Gaussian at the beginning of this chapter will
give <span class="math">\(3-sigma\)</span> bands for the best-fit Gaussian, and produce the
figure below.</p>
<blockquote id="figmodel4">
<div><a class="reference external image-reference" href="_images/model_fit4.png"><img alt="_images/model_fit4.png" src="_images/model_fit4.png" style="width: 50%;" /></a>
</div></blockquote>
</div>
</div>
<div class="section" id="composite-models-adding-or-multiplying-models">
<span id="composite-models-section"></span><span id="index-0"></span><h2>Composite Models : adding (or multiplying) Models<a class="headerlink" href="#composite-models-adding-or-multiplying-models" title="Permalink to this headline">¶</a></h2>
<p>One of the more interesting features of the <a class="reference internal" href="#lmfit.model.Model" title="lmfit.model.Model"><code class="xref py py-class docutils literal"><span class="pre">Model</span></code></a> class is that
Models can be added together or combined with basic algebraic operations
(add, subtract, multiply, and divide) to give a composite model.  The
composite model will have parameters from each of the component models,
with all parameters being available to influence the whole model.  This
ability to combine models will become even more useful in the next chapter,
when pre-built subclasses of <a class="reference internal" href="#lmfit.model.Model" title="lmfit.model.Model"><code class="xref py py-class docutils literal"><span class="pre">Model</span></code></a> are discussed.  For now, we&#8217;ll
consider a simple example, and build a model of a Gaussian plus a line, as
to model a peak with a background. For such a simple problem, we could just
build a model that included both components:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">gaussian_plus_line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">amp</span><span class="p">,</span> <span class="n">cen</span><span class="p">,</span> <span class="n">wid</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">):</span>
    <span class="s2">&quot;line + 1-d gaussian&quot;</span>

    <span class="n">gauss</span> <span class="o">=</span> <span class="p">(</span><span class="n">amp</span><span class="o">/</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">wid</span><span class="p">))</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">cen</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">wid</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">intercept</span>
    <span class="k">return</span> <span class="n">gauss</span> <span class="o">+</span> <span class="n">line</span>
</pre></div>
</div>
<p>and use that with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mod</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">gaussian_plus_line</span><span class="p">)</span>
</pre></div>
</div>
<p>But we already had a function for a gaussian function, and maybe we&#8217;ll
discover that a linear background isn&#8217;t sufficient which would mean the
model function would have to be changed.</p>
<p>Instead, lmfit allows models to be combined into a <a class="reference internal" href="#lmfit.model.CompositeModel" title="lmfit.model.CompositeModel"><code class="xref py py-class docutils literal"><span class="pre">CompositeModel</span></code></a>.
As an alternative to including a linear background in our model function,
we could define a linear function:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">):</span>
    <span class="s2">&quot;a line&quot;</span>
    <span class="k">return</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">intercept</span>
</pre></div>
</div>
<p>and build a composite model with just:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mod</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">gaussian</span><span class="p">)</span> <span class="o">+</span> <span class="n">Model</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</pre></div>
</div>
<p>This model has parameters for both component models, and can be used as:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1">#&lt;examples/model_doc2.py&gt;</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">loadtxt</span>
<span class="kn">from</span> <span class="nn">lmfit</span> <span class="k">import</span> <span class="n">Model</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;model1d_gauss.dat&#39;</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mf">1.0</span>

<span class="k">def</span> <span class="nf">gaussian</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">amp</span><span class="p">,</span> <span class="n">cen</span><span class="p">,</span> <span class="n">wid</span><span class="p">):</span>
    <span class="s2">&quot;1-d gaussian: gaussian(x, amp, cen, wid)&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">amp</span><span class="o">/</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">wid</span><span class="p">))</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">cen</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">wid</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">):</span>
    <span class="s2">&quot;line&quot;</span>
    <span class="k">return</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">intercept</span>

<span class="n">mod</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">gaussian</span><span class="p">)</span> <span class="o">+</span> <span class="n">Model</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="n">pars</span>  <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">make_params</span><span class="p">(</span> <span class="n">amp</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">cen</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">wid</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">slope</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">intercept</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">pars</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">fit_report</span><span class="p">())</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>         <span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">init_fit</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">best_fit</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1">#&lt;end examples/model_doc2.py&gt;</span>
</pre></div>
</div>
<p>which prints out the results:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">Model</span><span class="p">]]</span>
    <span class="p">(</span><span class="n">Model</span><span class="p">(</span><span class="n">gaussian</span><span class="p">)</span> <span class="o">+</span> <span class="n">Model</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>
<span class="p">[[</span><span class="n">Fit</span> <span class="n">Statistics</span><span class="p">]]</span>
    <span class="c1"># function evals   = 44</span>
    <span class="c1"># data points      = 101</span>
    <span class="c1"># variables        = 5</span>
    <span class="n">chi</span><span class="o">-</span><span class="n">square</span>         <span class="o">=</span> <span class="mf">2.579</span>
    <span class="n">reduced</span> <span class="n">chi</span><span class="o">-</span><span class="n">square</span> <span class="o">=</span> <span class="mf">0.027</span>
    <span class="n">Akaike</span> <span class="n">info</span> <span class="n">crit</span>   <span class="o">=</span> <span class="o">-</span><span class="mf">360.457</span>
    <span class="n">Bayesian</span> <span class="n">info</span> <span class="n">crit</span> <span class="o">=</span> <span class="o">-</span><span class="mf">347.381</span>
<span class="p">[[</span><span class="n">Variables</span><span class="p">]]</span>
    <span class="n">amp</span><span class="p">:</span>         <span class="mf">8.45931061</span> <span class="o">+/-</span> <span class="mf">0.124145</span> <span class="p">(</span><span class="mf">1.47</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">cen</span><span class="p">:</span>         <span class="mf">5.65547872</span> <span class="o">+/-</span> <span class="mf">0.009176</span> <span class="p">(</span><span class="mf">0.16</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">intercept</span><span class="p">:</span>  <span class="o">-</span><span class="mf">0.96860201</span> <span class="o">+/-</span> <span class="mf">0.033522</span> <span class="p">(</span><span class="mf">3.46</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">slope</span><span class="p">:</span>       <span class="mf">0.26484403</span> <span class="o">+/-</span> <span class="mf">0.005748</span> <span class="p">(</span><span class="mf">2.17</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">wid</span><span class="p">:</span>         <span class="mf">0.67545523</span> <span class="o">+/-</span> <span class="mf">0.009916</span> <span class="p">(</span><span class="mf">1.47</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">[[</span><span class="n">Correlations</span><span class="p">]]</span> <span class="p">(</span><span class="n">unreported</span> <span class="n">correlations</span> <span class="n">are</span> <span class="o">&lt;</span>  <span class="mf">0.100</span><span class="p">)</span>
    <span class="n">C</span><span class="p">(</span><span class="n">amp</span><span class="p">,</span> <span class="n">wid</span><span class="p">)</span>                  <span class="o">=</span>  <span class="mf">0.666</span>
    <span class="n">C</span><span class="p">(</span><span class="n">cen</span><span class="p">,</span> <span class="n">intercept</span><span class="p">)</span>            <span class="o">=</span>  <span class="mf">0.129</span>
</pre></div>
</div>
<p>and shows the plot on the left.</p>
<blockquote id="figmodel2">
<div><a class="reference external image-reference" href="_images/model_fit2.png"><img alt="_images/model_fit2.png" src="_images/model_fit2.png" style="width: 48%;" /></a>
<a class="reference external image-reference" href="_images/model_fit2a.png"><img alt="_images/model_fit2a.png" src="_images/model_fit2a.png" style="width: 48%;" /></a>
</div></blockquote>
<p>On the left, data is shown in blue dots, the total fit is shown in solid
red line, and the initial fit is shown as a black dashed line.  In the
figure on the right, the data is again shown in blue dots, and the Gaussian
component shown as a black dashed line, and the linear component shown as a
red dashed line.  These components were generated after the fit using the
Models <a class="reference internal" href="#lmfit.model.ModelResult.eval_components" title="lmfit.model.ModelResult.eval_components"><code class="xref py py-meth docutils literal"><span class="pre">ModelResult.eval_components()</span></code></a> method of the <cite>result</cite>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">comps</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">eval_components</span><span class="p">()</span>
</pre></div>
</div>
<p>which returns a dictionary of the components, using keys of the model name
(or <cite>prefix</cite> if that is set).  This will use the parameter values in
<code class="docutils literal"><span class="pre">result.params</span></code> and the independent variables (<code class="docutils literal"><span class="pre">x</span></code>) used during the
fit.  Note that while the <a class="reference internal" href="#lmfit.model.ModelResult" title="lmfit.model.ModelResult"><code class="xref py py-class docutils literal"><span class="pre">ModelResult</span></code></a> held in <cite>result</cite> does store the
best parameters and the best estimate of the model in <code class="docutils literal"><span class="pre">result.best_fit</span></code>,
the original model and parameters in <code class="docutils literal"><span class="pre">pars</span></code> are left unaltered.</p>
<p>You can apply this composite model to other data sets, or evaluate the
model at other values of <code class="docutils literal"><span class="pre">x</span></code>.  You may want to do this to give a finer or
coarser spacing of data point, or to extrapolate the model outside the
fitting range.  This can be done with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">xwide</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">3001</span><span class="p">)</span>
<span class="n">predicted</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xwide</span><span class="p">)</span>
</pre></div>
</div>
<p>In this example, the argument names for the model functions do not overlap.
If they had, the <code class="docutils literal"><span class="pre">prefix</span></code> argument to <a class="reference internal" href="#lmfit.model.Model" title="lmfit.model.Model"><code class="xref py py-class docutils literal"><span class="pre">Model</span></code></a> would have allowed
us to identify which parameter went with which component model.  As we will
see in the next chapter, using composite models with the built-in models
provides a simple way to build up complex models.</p>
<dl class="class">
<dt id="lmfit.model.CompositeModel">
<em class="property">class </em><code class="descname">CompositeModel</code><span class="sig-paren">(</span><em>left</em>, <em>right</em>, <em>op</em><span class="optional">[</span>, <em>**kws</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.model.CompositeModel" title="Permalink to this definition">¶</a></dt>
<dd><p>A composite model combines two models (<cite>left</cite> and <cite>right</cite>) with a
binary operator (<cite>op</cite>).</p>
<p>Normally, one does not have to explicitly create a <cite>CompositeModel</cite>,
but can use normal Python operators <cite>+</cite>, &#8216;-&#8216;, <cite>*</cite>, and <cite>/</cite> to combine
components as doing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">fcn1</span><span class="p">)</span> <span class="o">+</span> <span class="n">Model</span><span class="p">(</span><span class="n">fcn2</span><span class="p">)</span> <span class="o">*</span> <span class="n">Model</span><span class="p">(</span><span class="n">fcn3</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>left</strong> (<cite>Model</cite> instance) &#8211; left-hand model</li>
<li><strong>right</strong> (<cite>Model</cite> instance) &#8211; right-hand model</li>
<li><strong>op</strong> (<em>callable binary operator</em>) &#8211; operator to combine <cite>left</cite> and <cite>right</cite> models.</li>
<li><strong>kwargs</strong> (<em>optional</em>) &#8211; additional keywords are passed to <cite>Model</cite> when creating this
new model.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<ol class="arabic simple">
<li>The two models must use the same independent variable.</li>
</ol>
</dd></dl>

<p>Note that when using builtin Python binary operators, a
<a class="reference internal" href="#lmfit.model.CompositeModel" title="lmfit.model.CompositeModel"><code class="xref py py-class docutils literal"><span class="pre">CompositeModel</span></code></a> will automatically be constructed for you. That is,
doing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mod</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">fcn1</span><span class="p">)</span> <span class="o">+</span> <span class="n">Model</span><span class="p">(</span><span class="n">fcn2</span><span class="p">)</span> <span class="o">*</span> <span class="n">Model</span><span class="p">(</span><span class="n">fcn3</span><span class="p">)</span>
</pre></div>
</div>
<p>will create a <a class="reference internal" href="#lmfit.model.CompositeModel" title="lmfit.model.CompositeModel"><code class="xref py py-class docutils literal"><span class="pre">CompositeModel</span></code></a>.  Here, <cite>left</cite> will be <cite>Model(fcn1)</cite>,
<cite>op</cite> will be <code class="xref py py-meth docutils literal"><span class="pre">operator.add()</span></code>, and <cite>right</cite> will be another
CompositeModel that has a <cite>left</cite> attribute of <cite>Model(fcn2)</cite>, an <cite>op</cite> of
<code class="xref py py-meth docutils literal"><span class="pre">operator.mul()</span></code>, and a <cite>right</cite> of <cite>Model(fcn3)</cite>.</p>
<p>To use a binary operator other than &#8216;+&#8217;, &#8216;-&#8216;, &#8216;*&#8217;, or &#8216;/&#8217; you can
explicitly create a <a class="reference internal" href="#lmfit.model.CompositeModel" title="lmfit.model.CompositeModel"><code class="xref py py-class docutils literal"><span class="pre">CompositeModel</span></code></a> with the appropriate binary
operator.  For example, to convolve two models, you could define a simple
convolution function, perhaps as:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="k">def</span> <span class="nf">convolve</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span> <span class="n">kernel</span><span class="p">):</span>
    <span class="c1"># simple convolution</span>
    <span class="n">npts</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dat</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">kernel</span><span class="p">))</span>
    <span class="n">pad</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">npts</span><span class="p">)</span>
    <span class="n">tmp</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">pad</span><span class="o">*</span><span class="n">dat</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dat</span><span class="p">,</span> <span class="n">pad</span><span class="o">*</span><span class="n">dat</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">out</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="n">kernel</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;valid&#39;</span><span class="p">)</span>
    <span class="n">noff</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="o">-</span> <span class="n">npts</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="n">noff</span><span class="p">:])[:</span><span class="n">npts</span><span class="p">]</span>
</pre></div>
</div>
<p>which extends the data in both directions so that the convolving kernel
function gives a valid result over the data range.  Because this function
takes two array arguments and returns an array, it can be used as the
binary operator.  A full script using this technique is here:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1">#&lt;examples/model_doc3.py&gt;</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">lmfit</span> <span class="k">import</span> <span class="n">Model</span><span class="p">,</span> <span class="n">CompositeModel</span>
<span class="kn">from</span> <span class="nn">lmfit.lineshapes</span> <span class="k">import</span> <span class="n">step</span><span class="p">,</span> <span class="n">gaussian</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># create data from broadened step</span>
<span class="n">npts</span> <span class="o">=</span> <span class="mi">201</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">npts</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">step</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">amplitude</span><span class="o">=</span><span class="mf">12.5</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.88</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="s1">&#39;erf&#39;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">npts</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.35</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">jump</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mid</span><span class="p">):</span>
    <span class="s2">&quot;heaviside step function&quot;</span>
    <span class="n">o</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">imid</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">x</span><span class="o">&lt;=</span><span class="n">mid</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">o</span><span class="p">[</span><span class="n">imid</span><span class="p">:]</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="k">return</span> <span class="n">o</span>

<span class="k">def</span> <span class="nf">convolve</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">kernel</span><span class="p">):</span>
    <span class="c1"># simple convolution of two arrays</span>
    <span class="n">npts</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">kernel</span><span class="p">))</span>
    <span class="n">pad</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">npts</span><span class="p">)</span>
    <span class="n">tmp</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">pad</span><span class="o">*</span><span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">arr</span><span class="p">,</span> <span class="n">pad</span><span class="o">*</span><span class="n">arr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">out</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="n">kernel</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;valid&#39;</span><span class="p">)</span>
    <span class="n">noff</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="o">-</span> <span class="n">npts</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">out</span><span class="p">[</span><span class="n">noff</span><span class="p">:</span><span class="n">noff</span><span class="o">+</span><span class="n">npts</span><span class="p">]</span>
<span class="c1">#</span>
<span class="c1"># create Composite Model using the custom convolution operator</span>
<span class="n">mod</span>  <span class="o">=</span> <span class="n">CompositeModel</span><span class="p">(</span><span class="n">Model</span><span class="p">(</span><span class="n">jump</span><span class="p">),</span> <span class="n">Model</span><span class="p">(</span><span class="n">gaussian</span><span class="p">),</span> <span class="n">convolve</span><span class="p">)</span>

<span class="n">pars</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">make_params</span><span class="p">(</span><span class="n">amplitude</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">mid</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>

<span class="c1"># &#39;mid&#39; and &#39;center&#39; should be completely correlated, and &#39;mid&#39; is</span>
<span class="c1"># used as an integer index, so a very poor fit variable:</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;mid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">vary</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># fit this model to data array y</span>
<span class="n">result</span> <span class="o">=</span>  <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">pars</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">fit_report</span><span class="p">())</span>

<span class="n">plot_components</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># plot results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>         <span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">plot_components</span><span class="p">:</span>
    <span class="c1"># generate components</span>
    <span class="n">comps</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">eval_components</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="o">*</span><span class="n">comps</span><span class="p">[</span><span class="s1">&#39;jump&#39;</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="o">*</span><span class="n">comps</span><span class="p">[</span><span class="s1">&#39;gaussian&#39;</span><span class="p">],</span> <span class="s1">&#39;r-&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">init_fit</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">best_fit</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1"># #&lt;end examples/model_doc3.py&gt;</span>
</pre></div>
</div>
<p>which prints out the results:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">Model</span><span class="p">]]</span>
    <span class="p">(</span><span class="n">Model</span><span class="p">(</span><span class="n">jump</span><span class="p">)</span> <span class="o">&lt;</span><span class="n">function</span> <span class="n">convolve</span> <span class="n">at</span> <span class="mh">0x109ee4488</span><span class="o">&gt;</span> <span class="n">Model</span><span class="p">(</span><span class="n">gaussian</span><span class="p">))</span>
<span class="p">[[</span><span class="n">Fit</span> <span class="n">Statistics</span><span class="p">]]</span>
    <span class="c1"># function evals   = 27</span>
    <span class="c1"># data points      = 201</span>
    <span class="c1"># variables        = 3</span>
    <span class="n">chi</span><span class="o">-</span><span class="n">square</span>         <span class="o">=</span> <span class="mf">22.091</span>
    <span class="n">reduced</span> <span class="n">chi</span><span class="o">-</span><span class="n">square</span> <span class="o">=</span> <span class="mf">0.112</span>
    <span class="n">Akaike</span> <span class="n">info</span> <span class="n">crit</span>   <span class="o">=</span> <span class="o">-</span><span class="mf">437.837</span>
    <span class="n">Bayesian</span> <span class="n">info</span> <span class="n">crit</span> <span class="o">=</span> <span class="o">-</span><span class="mf">427.927</span>
<span class="p">[[</span><span class="n">Variables</span><span class="p">]]</span>
    <span class="n">mid</span><span class="p">:</span>         <span class="mi">5</span> <span class="p">(</span><span class="n">fixed</span><span class="p">)</span>
    <span class="n">sigma</span><span class="p">:</span>       <span class="mf">0.64118585</span> <span class="o">+/-</span> <span class="mf">0.013233</span> <span class="p">(</span><span class="mf">2.06</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mf">1.5</span><span class="p">)</span>
    <span class="n">center</span><span class="p">:</span>      <span class="mf">4.51633608</span> <span class="o">+/-</span> <span class="mf">0.009567</span> <span class="p">(</span><span class="mf">0.21</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mf">3.5</span><span class="p">)</span>
    <span class="n">amplitude</span><span class="p">:</span>   <span class="mf">0.62654849</span> <span class="o">+/-</span> <span class="mf">0.001813</span> <span class="p">(</span><span class="mf">0.29</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span><span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">[[</span><span class="n">Correlations</span><span class="p">]]</span> <span class="p">(</span><span class="n">unreported</span> <span class="n">correlations</span> <span class="n">are</span> <span class="o">&lt;</span>  <span class="mf">0.100</span><span class="p">)</span>
    <span class="n">C</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">amplitude</span><span class="p">)</span>         <span class="o">=</span>  <span class="mf">0.344</span>
    <span class="n">C</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">amplitude</span><span class="p">)</span>          <span class="o">=</span>  <span class="mf">0.280</span>
</pre></div>
</div>
<p>and shows the plots:</p>
<blockquote id="figmodel3">
<div><a class="reference external image-reference" href="_images/model_fit3a.png"><img alt="_images/model_fit3a.png" src="_images/model_fit3a.png" style="width: 48%;" /></a>
<a class="reference external image-reference" href="_images/model_fit3b.png"><img alt="_images/model_fit3b.png" src="_images/model_fit3b.png" style="width: 48%;" /></a>
</div></blockquote>
<p>Using composite models with built-in or custom operators allows you to
build complex models from testable sub-components.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="builtin_models.html" title="Built-in Fitting Models in the models module"
             >next</a> |</li>
        <li class="right" >
          <a href="fitting.html" title="Performing Fits, Analyzing Outputs"
             >previous</a> |</li>
   <li>[<a href="intro.html">intro</a>|</li>
   <li><a href="parameters.html">parameters</a>|</li>
   <li><a href="fitting.html"> minimize</a>|</li>
   <li><a href="#"> model</a>|</li>
   <li><a href="builtin_models.html"> builtin models</a>|</li>
   <li><a href="confidence.html">confidence intervals</a>|</li>
   <li><a href="bounds.html">bounds</a>|</li>
   <li><a href="constraints.html">constraints</a>]</li>
 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Matthew Newville, The University of Chicago, Till Stensitzki, Freie Universitat Berlin.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.1.
    </div>
  </body>
</html>