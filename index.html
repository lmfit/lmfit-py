

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Non-Linear Least-Square Minimization for Python &mdash; Least-Squares Minimization with Constraints for Python</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.7.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Least-Squares Minimization with Constraints for Python" href="#" />
    <link rel="next" title="Downloading and Installation" href="installation.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Downloading and Installation"
             accesskey="N">next</a> |</li>
        <li><a href="#">Least-Squares Minimization with Constraints for Python</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper"><h3>Downloads</h3>
<p>Current version: <b>0.7.2</b></p>
<p>Downloads:
<ul>
  <li>&nbsp; &nbsp; <a href="http://cars.uchicago.edu/software/python/lmfit/src/">cars.uchicago.edu</a>
  <li>&nbsp; &nbsp; <a href="http://pypi.python.org/pypi/lmfit/">PyPI (Python.org)</a> <p>
       try <tt>easy_install -U lmfit</tt>
</ul>
<p>

Development version: <br> &nbsp; &nbsp; <a href="https://github.com/newville/lmfit-py/">github.com</a> <br>

<h3>Documentation</h3>

 <a href="lmfit.pdf">  PDF Format</a>
<hr> 
<p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="non-linear-least-square-minimization-for-python">
<h1>Non-Linear Least-Square Minimization for Python<a class="headerlink" href="#non-linear-least-square-minimization-for-python" title="Permalink to this headline">Â¶</a></h1>
<p>The lmfit Python package provides a simple, flexible interface to
non-linear optimization or curve fitting problems.  The package extends the
optimization capabilities of <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/optimize.html">scipy.optimize</a> by replacing floating
pointing values for the variables to be optimized with Parameter objects.
These Parameters can be fixed or varied, have upper and/or lower bounds
placed on its value, or written as an algebraic expression of other
Parameters.</p>
<p>The principal advantage of using Parameters instead of simple variables is
that the objective function does not have to be rewritten to reflect every
change of what is varied in the fit, or what relationships or constraints
are placed on the Parameters.  This means a scientific programmer can write
a general model that encapsulates the phenomenon to be optimized, and then
allow user of that model to change what is varied and fixed, what range of
values is acceptable for Parameters, and what constraints are placed on the
model.  The ease with which the model can be changed also allows one to
easily test the significance of certain Parameters in a fitting model.</p>
<p>The lmfit package allows a choice of several optimization methods available
from <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/optimize.html">scipy.optimize</a>.  The default, and by far best tested optimization
method used is the <a class="reference external" href="http://en.wikipedia.org/wiki/Levenberg-Marquardt_algorithm">Levenberg-Marquardt</a> algorithm from
from <a class="reference external" href="http://en.wikipedia.org/wiki/MINPACK">MINPACK-1</a> as implemented in <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.leastsq.html">scipy.optimize.leastsq</a>.
This method is by far the most tested and best support method in lmfit, and
much of this document assumes this algorithm is used unless explicitly
stated. An important point for many scientific analysis is that this is
only method that automatically estimates uncertainties and correlations
between fitted variables from the covariance matrix calculated during the fit.</p>
<p>A few other optimization routines are also supported, including
<a class="reference external" href="http://en.wikipedia.org/wiki/Nelder-Mead_method">Nelder-Mead</a> simplex downhill, Powell's method, COBYLA, Sequential Least
Squares methods as implemented in <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.fmin.html">scipy.optimize.fmin</a>, and several
others from <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/optimize.html">scipy.optimize</a>. Some methods, including the <a class="reference external" href="http://en.wikipedia.org/wiki/Limited-memory_BFGS">L-BFGS</a>
(limited memory Broyden-Fletcher-Goldfarb-Shanno) algorithm as implemented
in <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.fmin_l_bfgs_b.html">scipy.optimize.l_bfgs_b</a> and the <a class="reference external" href="http://en.wikipedia.org/wiki/Simulated_annealing">simulated annealing</a> algorithm as
implemented in <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.anneal.html">scipy.optimize.anneal</a> are implemented, but appear to not
work very well.  In their native form, some of these methods setting upper
or lower bounds on parameters, or adding constraints on fitted variables.
By using Parameter objects, lmfit allows bounds and constraints for all of
these methods, and makes it easy to swap between methods.  These algorithms
generally perform worse for most data fitting problems, but they are
available and can be easily tried without changing the objective function
or set of Parameters.</p>
<p>Finally, because this approach of using the covariance matrix to determine
uncertainties is sometimes questioned (and sometimes rightly so), lmfit
supports methods to do a brute force search of the confidence intervals and
correlations for sets of parameters.</p>
<p>lmfit and this document are a work in progress.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Downloading and Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#downloads">Downloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#development-version">Development Version</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#acknowledgements">Acknowledgements</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#license">License</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="parameters.html">Getting started with Non-Linear Least-Squares Fitting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="parameters.html#using-parameters-instead-of-variables">Using <tt class="docutils literal"><span class="pre">Parameters</span></tt> instead of Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="parameters.html#the-parameter-class">The <tt class="docutils literal"><span class="pre">Parameter</span></tt> class</a></li>
<li class="toctree-l2"><a class="reference internal" href="parameters.html#the-parameters-class">The <tt class="docutils literal"><span class="pre">Parameters</span></tt> class</a></li>
<li class="toctree-l2"><a class="reference internal" href="parameters.html#simple-example">Simple Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fitting.html">Performing Fits, Analyzing Outputs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="fitting.html#the-minimize-function">The <tt class="docutils literal"><span class="pre">minimize()</span></tt> function</a></li>
<li class="toctree-l2"><a class="reference internal" href="fitting.html#writing-a-fitting-function">Writing a Fitting Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="fitting.html#choosing-different-fitting-methods">Choosing Different Fitting Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="fitting.html#goodness-of-fit-and-estimated-uncertainty-and-correlations">Goodness-of-Fit and estimated uncertainty and correlations</a></li>
<li class="toctree-l2"><a class="reference internal" href="fitting.html#using-the-minimizer-class">Using the <tt class="docutils literal"><span class="pre">Minimizer</span></tt> class</a></li>
<li class="toctree-l2"><a class="reference internal" href="fitting.html#getting-and-printing-fit-reports">Getting and Printing Fit Reports</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="confidence.html">Calculation of confidence intervals</a><ul>
<li class="toctree-l2"><a class="reference internal" href="confidence.html#method-used-for-calculating-confidence-intervals">Method used for calculating confidence intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="confidence.html#a-basic-example">A basic example</a></li>
<li class="toctree-l2"><a class="reference internal" href="confidence.html#an-advanced-example">An advanced example</a></li>
<li class="toctree-l2"><a class="reference internal" href="confidence.html#documentation-of-methods">Documentation of methods</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bounds.html">Bounds Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="constraints.html">Using Mathematical Constraints</a><ul>
<li class="toctree-l2"><a class="reference internal" href="constraints.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="constraints.html#supported-operators-functions-and-constants">Supported Operators, Functions, and Constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="constraints.html#using-inequality-constraints">Using Inequality Constraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="constraints.html#advanced-usage-of-expressions-in-lmfit">Advanced usage of Expressions in lmfit</a></li>
</ul>
</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Downloading and Installation"
             >next</a> |</li>
        <li><a href="#">Least-Squares Minimization with Constraints for Python</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Matthew Newville, The University of Chicago,  Till Stensitzki, Freie Universitat Berlin.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>